<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>masaak Dashboard</title>
    <link rel="stylesheet" href="/css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>

<body>
    <!-- Login Page -->
    <div id="login-page" class="page active">
        <div class="login-hero">
            <div class="login-card">
                <div class="login-brand">
                    <div class="brand-icon"><i class="fas fa-robot"></i></div>
                    <div class="brand-text">
                        <h1>WhatsApp Bot</h1>
                        <p>Dashboard Login</p>
                    </div>
                </div>
                <form id="login-form" class="login-form">
                    <div class="form-group">
                        <label for="username">Username</label>
                        <div class="input-with-icon">
                            <i class="fas fa-user"></i>
                            <input type="text" id="username" name="username" required placeholder="Enter username">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="password">Password</label>
                        <div class="input-with-icon">
                            <i class="fas fa-lock"></i>
                            <input type="password" id="password" name="password" required placeholder="Enter password">
                            <button type="button" id="toggle-password" class="input-action" title="Show/Hide password">
                                <i class="fas fa-eye"></i>
                            </button>
                        </div>
                    </div>
                    <div class="login-options">
                        <label class="remember-me"><input type="checkbox" id="remember-me"> Remember me</label>
                        <span class="forgot-hint">Forgot password?</span>
                    </div>
                    <button type="submit" class="btn btn-primary btn-block">Login</button>
                    <div id="login-error" class="error-message" style="margin-top:12px;"></div>
                </form>
                <div class="login-info">
                </div>
            </div>
        </div>
    </div>

    <!-- Dashboard Page -->
    <div id="dashboard-page" class="page">
        <!-- Sidebar -->
        <div id="sidebar" class="sidebar">
            <div class="sidebar-header">
                <h2><i class="fas fa-robot"></i> massak Bot</h2>
                <button id="close-sidebar" class="btn-close-sidebar">‚úï</button>
            </div>
            <nav class="sidebar-nav">
                <a href="#" class="nav-item active" data-view="home">
                    <span class="nav-icon"><i class="fas fa-home"></i></span>
                    <span class="nav-text">Home</span>
                </a>
                <a href="#" class="nav-item admin-only" data-view="whatsapp-messages" style="display: none;">
                    <span class="nav-icon"><i class="fas fa-comment-dots"></i></span>
                    <span class="nav-text">WhatsApp Messages</span>
                </a>
                <a href="#" class="nav-item" data-view="ads">
                    <span class="nav-icon"><i class="fas fa-ad"></i></span>
                    <span class="nav-text">Manage Ads</span>
                </a>
                <a href="#" class="nav-item" data-view="recycle-bin">
                    <span class="nav-icon"><i class="fas fa-trash-restore"></i></span>
                    <span class="nav-text">Recycle Bin</span>
                </a>
                <a href="#" class="nav-item admin-only" data-view="private-clients" style="display: none;">
                    <span class="nav-icon"><i class="fas fa-user-friends"></i></span>
                    <span class="nav-text">Private Clients</span>
                </a>
                <a href="#" class="nav-item" data-view="daily-summaries">
                    <span class="nav-icon"><i class="fas fa-chart-line"></i></span>
                    <span class="nav-text">Daily Summaries</span>
                </a>
                <a href="#" class="nav-item" data-view="settings">
                    <span class="nav-icon"><i class="fas fa-cog"></i></span>
                    <span class="nav-text">Settings</span>
                </a>
                <a href="#" class="nav-item admin-only" data-view="users" style="display: none;">
                    <span class="nav-icon"><i class="fas fa-users"></i></span>
                    <span class="nav-text">Manage Users</span>
                </a>
            </nav>
            <div class="sidebar-footer">
                <div class="user-profile">
                    <span id="sidebar-user-info"></span>
                </div>
                <!-- <button id="sidebar-logout-btn" class="btn btn-secondary btn-block">Logout</button> -->
            </div>
        </div>

        <!-- Sidebar Overlay -->
        <div id="sidebar-overlay" class="sidebar-overlay"></div>

        <!-- Top Navbar -->
        <nav class="topbar">
            <div class="topbar-left">
                <button id="menu-btn" class="btn-menu"><i class="fas fa-bars"></i></button>
                <div class="topbar-brand"><i class="fas fa-robot"></i> massak Bot</div>
            </div>
            <div class="topbar-right">
                <span id="user-info" class="user-badge"></span>
                <button id="logout-btn" class="btn btn-secondary btn-sm">Logout</button>
            </div>
        </nav>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Home View -->
            <div id="home-view" class="content-view active">
                <div class="page-header">
                    <h1>Dashboard</h1>
                    <p>Welcome to your massak Bot control panel</p>
                </div>
                <div class="card">
                    <div class="card-body">
                        <div
                            style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                            <div>
                                <p style="margin: 0; color: #666; font-size: 0.95rem;">
                                    Keep your groups list up-to-date. Click refresh if you've joined new groups.
                                </p>
                            </div>
                        </div>
                        <div style="display: flex; gap: 10px; align-items: center;">
                            <button id="refresh-groups-btn" class="btn btn-primary">
                                <i class="fas fa-sync-alt"></i> Refresh Groups
                            </button>
                            <span id="groups-last-update" style="color: #999; font-size: 0.85rem;"></span>
                        </div>
                        <div id="refresh-groups-message" class="info-message" style="display:none; margin-top: 10px;">
                        </div>
                    </div>
                </div>
                <!-- Main Statistics -->
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);"><i
                                class="fas fa-chart-bar"></i></div>
                        <div class="stat-info">
                            <div class="stat-label">Total Ads</div>
                            <div class="stat-value" id="stat-total-ads">0</div>
                            <div class="stat-sublabel" id="stat-new-ads">0 new</div>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);"><i
                                class="fas fa-check-circle"></i></div>
                        <div class="stat-info">
                            <div class="stat-label">Accepted</div>
                            <div class="stat-value" id="stat-accepted">0</div>
                            <div class="stat-sublabel" id="stat-acceptance-rate">0% rate</div>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon" style="background: linear-gradient(135deg, #30cfd0 0%, #330867 100%);"><i
                                class="fas fa-layer-group"></i></div>
                        <div class="stat-info">
                            <div class="stat-label">Categories</div>
                            <div class="stat-value" id="stat-categories">0</div>
                            <div class="stat-sublabel" id="stat-top-category">None</div>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h2><i class="fas fa-signal"></i> Connection Status</h2>
                    </div>
                    <div class="card-body">
                        <div class="status-indicator">
                            <span id="status-badge" class="badge badge-disconnected">Disconnected</span>
                            <button id="refresh-status-btn" class="btn btn-small">Refresh</button>
                        </div>

                        <!-- Queue Statistics -->
                        <div id="queue-stats" style="margin-top: 15px; display: none;">
                            <h3 style="font-size: 14px; margin-bottom: 10px;">üìä Message Queue Status</h3>
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; font-size: 13px;">
                                <div>
                                    <strong>In Queue:</strong>
                                    <span id="queue-current" class="badge" style="margin-left: 5px;">0</span>
                                </div>
                                <div>
                                    <strong>Processing:</strong>
                                    <span id="queue-active" class="badge" style="margin-left: 5px;">0</span>
                                </div>
                                <div>
                                    <strong>Total Processed:</strong>
                                    <span id="queue-processed" style="color: #27ae60;">0</span>
                                </div>
                                <div>
                                    <strong>Total Failed:</strong>
                                    <span id="queue-failed" style="color: #e74c3c;">0</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Analytics Charts Row -->
                <div
                    style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-bottom: 20px;">
                    <!-- Property Types Chart -->
                    <div class="card">
                        <div class="card-header">
                            <h2><i class="fas fa-home"></i> Property Types Distribution</h2>
                        </div>
                        <div class="card-body">
                            <div id="property-types-chart" style="max-height: 300px; overflow-y: auto;">
                                <p style="text-align: center; color: #999;">Loading data...</p>
                            </div>
                        </div>
                    </div>

                    <!-- Top Groups Chart -->
                    <div class="card">
                        <div class="card-header">
                            <h2><i class="fas fa-users"></i> Top 5 Active Groups</h2>
                        </div>
                        <div class="card-body">
                            <div id="top-groups-chart" style="max-height: 300px; overflow-y: auto;">
                                <p style="text-align: center; color: #999;">Loading data...</p>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="qr-card" class="card" style="display: none;">
                    <div class="card-header">
                        <h2><i class="fas fa-qrcode"></i> Scan QR Code</h2>
                    </div>
                    <div class="card-body">
                        <div class="qr-container">
                            <div id="qr-loading" class="loading">Generating QR Code...</div>
                            <img id="qr-code" alt="QR Code" style="display: none;">
                            <p class="qr-instruction">Open WhatsApp on your phone and scan this QR code</p>
                        </div>
                    </div>
                </div>

                <div id="admin-controls" class="card" style="display: none;">
                    <div class="card-header">
                        <h2><i class="fas fa-cogs"></i> Admin Controls</h2>
                    </div>
                    <div class="card-body">
                        <button id="disconnect-btn" class="btn btn-danger">Disconnect Bot</button>
                        <div id="admin-message" class="info-message"></div>
                    </div>
                </div>
            </div>

            <!-- Post Preview / Edit Modal -->
            <!-- Ad Details Modal -->
            <div id="ad-details-modal" class="modal" style="display:none;">
                <div class="modal-content" style="max-width: 800px;">
                    <div class="modal-header">
                        <h2>üìã Ad Details</h2>
                        <span class="close" id="close-ad-details-modal">&times;</span>
                    </div>
                    <div class="modal-body">
                        <div id="ad-details-content" style="display:flex;flex-direction:column;gap:1rem;">
                            <!-- Dynamic content populated by JS -->
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button id="ad-details-groups-only" class="btn btn-success admin-only" style="display: none;">üì§
                            Send to Groups Only</button>
                        <button id="ad-details-wp-only" class="btn btn-primary admin-only" style="display: none;">üåê
                            Post to WordPress Only</button>
                        <button id="ad-details-both" class="btn btn-warning">üöÄ Post & Send to Groups</button>
                        <button id="ad-details-cancel" class="btn btn-secondary">Cancel</button>
                    </div>
                </div>
            </div>

            <!-- Groups Preview Modal (for groups-only flow) -->
            <div id="groups-preview-modal" class="modal" style="display:none;">
                <div class="modal-content" style="max-width: 700px;">
                    <div class="modal-header">
                        <h2>üì± WhatsApp Message Preview</h2>
                        <span class="close" id="close-groups-preview-modal">&times;</span>
                    </div>
                    <div class="modal-body">
                        <div style="display:flex;flex-direction:column;gap:0.75rem;">
                            <label>üìù Message to send (with WhatsApp formatting)</label>
                            <textarea id="groups-preview-message" rows="12" class="form-control"
                                style="font-family: monospace; white-space: pre-wrap;"></textarea>
                            <small style="color: #666;">You can use *bold*, _italic_, ~strikethrough~ and emojis
                                üì±‚ú®</small>

                            <div id="groups-selection-area">
                                <div
                                    style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                                    <label style="font-weight: bold; font-size: 1.1em;">Select Collections &
                                        Groups:</label>
                                    <div style="display: flex; gap: 10px;" class="admin-only">
                                        <button type="button" id="refresh-groups-modal-btn"
                                            class="btn btn-primary btn-sm">
                                            <i class="fas fa-sync-alt"></i> Refresh
                                        </button>
                                        <button type="button" id="manage-collections-modal-btn"
                                            class="btn btn-secondary btn-sm">
                                            <i class="fas fa-cog"></i> Manage Collections
                                        </button>
                                    </div>
                                </div>
                                <div style="margin-bottom: 10px; padding: 10px; background: #e3f2fd; border-radius: 4px; border-left: 4px solid #2196F3;"
                                    class="admin-only">
                                    <small style="color: #1565c0;">
                                        <i class="fas fa-info-circle"></i> <strong>Tip:</strong> Check a collection to
                                        select all its groups at once!
                                    </small>
                                </div>
                                <div
                                    style="margin-bottom: 10px; padding: 10px; background: #fff3cd; border-radius: 4px; border-left: 4px solid #ffc107;">
                                    <strong>‚è±Ô∏è Sending Delay:</strong>
                                    <input type="number" id="send-delay" value="3" min="1" max="60"
                                        style="width: 60px; margin: 0 5px;" /> seconds between messages
                                    <small style="display: block; color: #856404; margin-top: 5px;">
                                        <i class="fas fa-info-circle"></i> Delays help prevent WhatsApp from blocking
                                        your account
                                    </small>
                                </div>
                                <div id="groups-preview-list"
                                    style="max-height: 400px; overflow-y: auto; border: 1px solid #ddd; border-radius: 4px; padding: 10px;">
                                </div>

                                <!-- Custom Phone Numbers Section -->
                                <div
                                    style="margin-top: 15px; padding: 15px; background: #f0f8ff; border-radius: 8px; border: 2px solid #4CAF50;">
                                    <label
                                        style="font-weight: bold; font-size: 1.1em; color: #2c3e50; margin-bottom: 10px; display: block;">
                                        <i class="fas fa-phone" style="color: #4CAF50;"></i> Send to Custom Phone
                                        Numbers:
                                    </label>
                                    <div style="display:flex;gap:10px;align-items:stretch;margin-bottom:12px;">
                                        <div style="flex:1;">
                                            <input type="text" id="groups-preview-custom-number-name"
                                                placeholder="Name (e.g., Ahmed)" class="form-control"
                                                style="height: 45px; font-size: 1rem;">
                                        </div>
                                        <div style="flex:1;">
                                            <input type="text" id="groups-preview-custom-number-phone"
                                                placeholder="Phone (e.g., 966501234567)" class="form-control"
                                                style="height: 45px; font-size: 1rem;">
                                        </div>
                                        <button id="groups-preview-add-custom-number-btn" class="btn btn-success"
                                            style="height: 45px; min-width: 120px; font-size: 1rem; font-weight: bold;">
                                            <i class="fas fa-plus"></i> Add
                                        </button>
                                    </div>
                                    <div id="groups-preview-custom-numbers-list"
                                        style="margin-top: 10px; padding: 10px; background: white; border-radius: 6px; min-height: 60px; border: 1px solid #ddd;">
                                        <!-- Custom numbers will be rendered here -->
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button id="groups-preview-send" class="btn btn-success">
                            <i class="fas fa-paper-plane"></i> Send Messages
                        </button>
                        <button id="groups-preview-cancel" class="btn btn-secondary">Cancel</button>
                    </div>
                </div>
            </div>

            <!-- WordPress Preview Modal (for wp-only and both flows) -->
            <div id="wp-preview-modal" class="modal" style="display:none;">
                <div class="modal-content" style="max-width: 800px;">
                    <div class="modal-header">
                        <h2>üåê WordPress Post Preview</h2>
                        <span class="close" id="close-wp-preview-modal">&times;</span>
                    </div>
                    <div class="modal-body" style="max-height: 70vh; overflow-y: auto;">
                        <div style="display:flex;flex-direction:column;gap:0.75rem;">
                            <h3 style="color: #2196F3; border-bottom: 2px solid #2196F3; padding-bottom: 0.5rem;">üìù
                                Basic Info</h3>

                            <div
                                style="background: #e3f2fd; padding: 10px; border-radius: 4px; border-left: 4px solid #2196F3;">
                                <label style="font-weight: bold; margin-bottom: 5px;">üåê Target Website</label>
                                <select id="wp-preview-target-website" class="form-control" style="background: white;">
                                    <option value="masaak">ŸÖÿ≥ÿπÿßŸÉ (Masaak) - Real Estate</option>
                                    <option value="hasak">ÿ≠ÿ≥ÿßŸÉ (Hasak) - Events & Marketplace</option>
                                </select>
                                <small style="color: #1565c0; display: block; margin-top: 5px;">
                                    <i class="fas fa-info-circle"></i> Choose where this ad should be posted
                                </small>
                            </div>

                            <label>WordPress Title</label>
                            <input id="wp-preview-title" class="form-control" />

                            <label>WordPress Content (HTML)</label>
                            <textarea id="wp-preview-content" rows="4" class="form-control"></textarea>

                            <h3
                                style="color: #4CAF50; border-bottom: 2px solid #4CAF50; padding-bottom: 0.5rem; margin-top: 1rem;">
                                üí∞ Price & Space</h3>

                            <div style="display:grid; grid-template-columns:1fr 1fr; gap:0.5rem;">
                                <div>
                                    <label>ÿßŸÑÿ≥ÿπÿ± (price - ŸÜÿµ ŸÉÿßŸÖŸÑ)</label>
                                    <input id="wp-preview-price" class="form-control" placeholder="ŸÖÿ´ÿßŸÑ: 500000 ÿ±ŸäÿßŸÑ" />
                                </div>
                                <div>
                                    <label>price_amount (ÿ±ŸÇŸÖ ŸÅŸÇÿ∑)</label>
                                    <input id="wp-preview-price-amount" class="form-control" placeholder="500000" />
                                </div>
                            </div>

                            <div style="display:grid; grid-template-columns:1fr 1fr; gap:0.5rem;">
                                <div>
                                    <label>price_method (ÿ∑ÿ±ŸäŸÇÿ© ÿßŸÑÿ≥ÿπÿ±)</label>
                                    <input id="wp-preview-price-method" class="form-control"
                                        placeholder="ÿµÿßŸÅŸä ÿßŸÑÿ≥ÿπÿ± / ÿπŸÑŸâ ÿßŸÑÿ≥ŸàŸÖ" />
                                </div>
                                <div>
                                    <label>arc_space (ÿßŸÑŸÖÿ≥ÿßÿ≠ÿ© - ŸÖÿ™ÿ±)</label>
                                    <input id="wp-preview-arc-space" class="form-control" placeholder="600" />
                                </div>
                            </div>

                            <label>order_space (ŸÖÿ≥ÿßÿ≠ÿ© ÿßŸÑÿ∑ŸÑÿ® - ÿ•ŸÜ Ÿàÿ¨ÿØ)</label>
                            <input id="wp-preview-order-space" class="form-control" />

                            <h3
                                style="color: #FF9800; border-bottom: 2px solid #FF9800; padding-bottom: 0.5rem; margin-top: 1rem;">
                                üìç Location Details</h3>

                            <label>location (ÿßŸÑŸÖŸàŸÇÿπ ÿßŸÑŸÉÿßŸÖŸÑ)</label>
                            <input id="wp-preview-location" class="form-control"
                                placeholder="ÿ≠Ÿä ÿßŸÑÿ±ÿßÿ®Ÿäÿ© - ÿßŸÑŸáŸÅŸàŸÅ - ÿßŸÑÿ£ÿ≠ÿ≥ÿßÿ°" />

                            <div style="display:grid; grid-template-columns:1fr 1fr 1fr; gap:0.5rem;">
                                <div>
                                    <label>before_City (ÿßŸÑŸÖÿ≠ÿßŸÅÿ∏ÿ©)</label>
                                    <input id="wp-preview-before-city" class="form-control" placeholder="ÿßŸÑÿ£ÿ≠ÿ≥ÿßÿ°" />
                                </div>
                                <div>
                                    <label>City (ÿßŸÑŸÖÿØŸäŸÜÿ©)</label>
                                    <input id="wp-preview-city" class="form-control" placeholder="ÿßŸÑŸáŸÅŸàŸÅ / ÿßŸÑŸÖÿ®ÿ±ÿ≤" />
                                </div>
                                <div>
                                    <label>google_location (ÿ±ÿßÿ®ÿ∑ ÿßŸÑÿÆÿ±Ÿäÿ∑ÿ©)</label>
                                    <input id="wp-preview-google-location" class="form-control"
                                        placeholder="https://maps.google.com/..." />
                                </div>
                            </div>

                            <h3
                                style="color: #9C27B0; border-bottom: 2px solid #9C27B0; padding-bottom: 0.5rem; margin-top: 1rem;">
                                üè∑Ô∏è Categories</h3>

                            <div style="display:grid; grid-template-columns:1fr 1fr; gap:0.5rem;">
                                <div>
                                    <label>parent_catt (ŸÅÿ¶ÿ© ÿ±ÿ¶Ÿäÿ≥Ÿäÿ©) *</label>
                                    <select id="wp-preview-parent-catt" class="form-control"
                                        onchange="updateWpSubcategories()">
                                        <option value="">ÿßÿÆÿ™ÿ± ŸÜŸàÿπ ÿßŸÑÿπŸÇÿßÿ±</option>
                                        <option value="ÿ£ÿ±ÿ∂">ÿ£ÿ±ÿ∂</option>
                                        <option value="ÿ®Ÿäÿ™">ÿ®Ÿäÿ™</option>
                                        <option value="ÿØÿ®ŸÑŸÉÿ≥">ÿØÿ®ŸÑŸÉÿ≥</option>
                                        <option value="ÿ¥ŸÇÿ© ÿØÿ®ŸÑŸÉÿ≥Ÿäÿ©">ÿ¥ŸÇÿ© ÿØÿ®ŸÑŸÉÿ≥Ÿäÿ©</option>
                                        <option value="ÿ¥ŸÇÿ©">ÿ¥ŸÇÿ©</option>
                                        <option value="ÿπŸÖÿßÿ±ÿ©">ÿπŸÖÿßÿ±ÿ©</option>
                                        <option value="ŸÅŸäŸÑÿß">ŸÅŸäŸÑÿß</option>
                                        <option value="ŸÖÿ≠ÿ∑ÿ© ÿ®ŸÜÿ≤ŸäŸÜ">ŸÖÿ≠ÿ∑ÿ© ÿ®ŸÜÿ≤ŸäŸÜ</option>
                                        <option value="ŸÖÿ≠ŸÑ ÿ™ÿ¨ÿßÿ±Ÿä">ŸÖÿ≠ŸÑ ÿ™ÿ¨ÿßÿ±Ÿä</option>
                                        <option value="ŸÖÿ≤ÿ±ÿπÿ©">ŸÖÿ≤ÿ±ÿπÿ©</option>
                                        <option value="ŸÖÿ≥ÿ™ŸàÿØÿπ">ŸÖÿ≥ÿ™ŸàÿØÿπ</option>
                                        <option value="ÿ¥ÿßŸÑŸäÿ©">ÿ¥ÿßŸÑŸäÿ©</option>
                                        <option value="ÿßÿ≥ÿ™ÿ±ÿßÿ≠ÿ©">ÿßÿ≥ÿ™ÿ±ÿßÿ≠ÿ©</option>
                                        <option value=" ŸÑŸÑÿ•Ÿäÿ¨ÿßÿ±"> ŸÑŸÑÿ•Ÿäÿ¨ÿßÿ±</option>
                                    </select>
                                </div>
                                <div>
                                    <label>sub_catt (ŸÅÿ¶ÿ© ŸÅÿ±ÿπŸäÿ©)</label>
                                    <select id="wp-preview-sub-catt" class="form-control">
                                        <option value="">ÿßÿÆÿ™ÿ± ŸÜŸàÿπ ÿßŸÑÿπŸÇÿßÿ± ÿ£ŸàŸÑÿßŸã</option>
                                    </select>
                                </div>
                            </div>

                            <div style="display:grid; grid-template-columns:1fr 1fr; gap:0.5rem;">
                                <div>
                                    <label>arc_category (ÿ™ÿµŸÜŸäŸÅ ÿßŸÑÿπŸÇÿßÿ±)</label>
                                    <input id="wp-preview-arc-category" class="form-control"
                                        style="background: #f0f0f0;" />
                                    <small style="color: #666; font-size: 0.75rem;">ŸäŸèŸÖŸÑÿ£ ÿ™ŸÑŸÇÿßÿ¶ŸäÿßŸã ŸÖŸÜ
                                        parent_catt</small>
                                </div>
                                <div>
                                    <label>arc_subcategory (ÿ™ÿµŸÜŸäŸÅ ŸÅÿ±ÿπŸä)</label>
                                    <input id="wp-preview-arc-subcategory" class="form-control"
                                        style="background: #f0f0f0;" />
                                    <small style="color: #666; font-size: 0.75rem;">ŸäŸèŸÖŸÑÿ£ ÿ™ŸÑŸÇÿßÿ¶ŸäÿßŸã ŸÖŸÜ sub_catt</small>
                                </div>
                            </div>

                            <h3
                                style="color: #E91E63; border-bottom: 2px solid #E91E63; padding-bottom: 0.5rem; margin-top: 1rem;">
                                üìû Contact & Owner</h3>

                            <div style="display:grid; grid-template-columns:1fr 1fr; gap:0.5rem;">
                                <div>
                                    <label>owner_name (ÿßÿ≥ŸÖ ÿßŸÑŸÖÿßŸÑŸÉ)</label>
                                    <input id="wp-preview-owner-name" class="form-control" />
                                </div>
                                <div>
                                    <label>phone_number (ÿ±ŸÇŸÖ ÿßŸÑÿ™ŸàÿßÿµŸÑ)</label>
                                    <input id="wp-preview-phone" class="form-control" />
                                </div>
                            </div>

                            <h3
                                style="color: #00BCD4; border-bottom: 2px solid #00BCD4; padding-bottom: 0.5rem; margin-top: 1rem;">
                                üîÑ Order Details (ÿ•ŸÜ ŸÉÿßŸÜ ÿ∑ŸÑÿ®)</h3>

                            <div style="display:grid; grid-template-columns:1fr 1fr 1fr; gap:0.5rem;">
                                <div>
                                    <label>order_status (ÿ≠ÿßŸÑÿ© ÿßŸÑÿ∑ŸÑÿ®)</label>
                                    <input id="wp-preview-order-status" class="form-control"
                                        placeholder="ŸÖŸÅÿ™Ÿàÿ≠ / ŸÖÿ∫ŸÑŸÇ" />
                                </div>
                                <div>
                                    <label>order_owner (ÿµÿßÿ≠ÿ® ÿßŸÑÿ∑ŸÑÿ®)</label>
                                    <input id="wp-preview-order-owner" class="form-control" />
                                </div>
                                <div>
                                    <label>order_type (ŸÜŸàÿπ ÿßŸÑÿ∑ŸÑÿ®) *</label>
                                    <select id="wp-preview-order-type" class="form-control">
                                        <option value="">ÿßÿÆÿ™ÿ± ŸÜŸàÿπ ÿßŸÑÿ∑ŸÑÿ®</option>
                                        <option value="ÿ®Ÿäÿπ">ÿ®Ÿäÿπ</option>
                                        <option value="ÿßŸäÿ¨ÿßÿ±">ÿßŸäÿ¨ÿßÿ±</option>
                                        <option value="ÿßÿ≥ÿ™ÿ´ŸÖÿßÿ±">ÿßÿ≥ÿ™ÿ´ŸÖÿßÿ±</option>
                                        <option value="ŸÑŸÑÿ™ŸÇÿ®ŸäŸÑ">ŸÑŸÑÿ™ŸÇÿ®ŸäŸÑ</option>
                                        <option value="ÿßÿπŸÑÿßŸÜ ÿ™ÿ¨ÿßÿ±Ÿä">ÿßÿπŸÑÿßŸÜ ÿ™ÿ¨ÿßÿ±Ÿä</option>
                                    </select>
                                </div>
                            </div>

                            <h3
                                style="color: #8BC34A; border-bottom: 2px solid #8BC34A; padding-bottom: 0.5rem; margin-top: 1rem;">
                                üíº Offer Details (ÿ•ŸÜ ŸÉÿßŸÜ ÿπÿ±ÿ∂)</h3>

                            <div style="display:grid; grid-template-columns:1fr 1fr 1fr; gap:0.5rem;">
                                <div>
                                    <label>offer_status (ÿ≠ÿßŸÑÿ© ÿßŸÑÿπÿ±ÿ∂)</label>
                                    <input id="wp-preview-offer-status" class="form-control" />
                                </div>
                                <div>
                                    <label>offer_owner (ÿµÿßÿ≠ÿ® ÿßŸÑÿπÿ±ÿ∂)</label>
                                    <input id="wp-preview-offer-owner" class="form-control" />
                                </div>
                                <div>
                                    <label>offer_type (ŸÜŸàÿπ ÿßŸÑÿπÿ±ÿ∂)</label>
                                    <input id="wp-preview-offer-type" class="form-control" />
                                </div>
                            </div>

                            <h3
                                style="color: #607D8B; border-bottom: 2px solid #607D8B; padding-bottom: 0.5rem; margin-top: 1rem;">
                                üéØ Additional Fields</h3>

                            <div style="display:grid; grid-template-columns:1fr 1fr; gap:0.5rem;">
                                <div>
                                    <label>main_ad (ÿßŸÑÿ•ÿπŸÑÿßŸÜ ÿßŸÑÿ£ÿµŸÑŸä)</label>
                                    <input id="wp-preview-main-ad" class="form-control" />
                                </div>
                                <div>
                                    <label>payment_method (ÿ∑ÿ±ŸäŸÇÿ© ÿßŸÑÿØŸÅÿπ)</label>
                                    <input id="wp-preview-payment-method" class="form-control"
                                        placeholder="ŸÉÿßÿ¥ / ÿ™ŸÇÿ≥Ÿäÿ∑ / ÿ®ŸÜŸÉŸä" />
                                </div>
                            </div>

                            <div style="display:grid; grid-template-columns:1fr 1fr; gap:0.5rem;">
                                <div>
                                    <label>youtube_link (ÿ±ÿßÿ®ÿ∑ ŸäŸàÿ™ŸäŸàÿ®)</label>
                                    <input id="wp-preview-youtube-link" class="form-control"
                                        placeholder="https://youtube.com/..." />
                                </div>
                                <div>
                                    <label>tags (ÿßŸÑŸàÿ≥ŸàŸÖ)</label>
                                    <input id="wp-preview-tags" class="form-control"
                                        placeholder="ÿπŸÇÿßÿ±ÿå ŸÑŸÑÿ®Ÿäÿπÿå ÿßŸÑÿ£ÿ≠ÿ≥ÿßÿ°" />
                                </div>
                            </div>

                            <h3
                                style="color: #F44336; border-bottom: 2px solid #F44336; padding-bottom: 0.5rem; margin-top: 1rem;">
                                üöÄ WordPress Output</h3>

                            <div id="wp-preview-link-section" style="display:none;">
                                <label>WordPress Link (will be sent to groups)</label>
                                <input id="wp-preview-link" class="form-control" readonly style="background:#f5f5f5;" />
                            </div>

                            <div id="wp-preview-message-section" style="display:none;">
                                <label>üì± WhatsApp Message (with link)</label>
                                <textarea id="wp-preview-message" rows="8" class="form-control"
                                    style="font-family: monospace; white-space: pre-wrap;"></textarea>

                                <div id="wp-groups-selection-area">
                                    <div
                                        style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                                        <label style="font-weight: bold; font-size: 1.1em;">Select Collections &
                                            Groups:</label>
                                        <div style="display: flex; gap: 10px;" class="admin-only">
                                            <button type="button" id="refresh-wp-groups-modal-btn"
                                                class="btn btn-primary btn-sm">
                                                <i class="fas fa-sync-alt"></i> Refresh
                                            </button>
                                        </div>
                                    </div>
                                    <div style="margin-bottom: 10px; padding: 10px; background: #e3f2fd; border-radius: 4px; border-left: 4px solid #2196F3;"
                                        class="admin-only">
                                        <small style="color: #1565c0;">
                                            <i class="fas fa-info-circle"></i> <strong>Tip:</strong> Check a collection
                                            to select all its groups at once!
                                        </small>
                                    </div>
                                    <div
                                        style="margin-bottom: 10px; padding: 10px; background: #fff3cd; border-radius: 4px; border-left: 4px solid #ffc107;">
                                        <strong>‚è±Ô∏è Sending Delay:</strong>
                                        <input type="number" id="wp-send-delay" value="3" min="1" max="60"
                                            style="width: 60px; margin: 0 5px;" /> seconds between messages
                                        <small style="display: block; color: #856404; margin-top: 5px;">
                                            <i class="fas fa-info-circle"></i> Delays help prevent WhatsApp from
                                            blocking your account
                                        </small>
                                    </div>
                                    <div id="wp-groups-preview-list"
                                        style="max-height: 400px; overflow-y: auto; border: 1px solid #ddd; border-radius: 4px; padding: 10px;">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <span id="wp-preview-save-status"
                            style="margin-right:auto;padding:4px 10px;border-radius:999px;background:#f1f3f5;color:#495057;font-size:0.85rem;">No
                            unsaved changes</span>
                        <button id="wp-preview-save-edits" class="btn btn-success">
                            <i class="fas fa-save"></i> Save Edits
                        </button>
                        <button id="wp-preview-post-only" class="btn btn-primary" style="display:none;">Post to
                            WordPress</button>
                        <button id="wp-preview-post-and-send" class="btn btn-warning" style="display:none;">Post & Send
                            to Groups</button>
                        <button id="wp-preview-cancel" class="btn btn-secondary">Cancel</button>
                    </div>
                </div>
            </div>

            <!-- WhatsApp Messages View -->
            <div id="whatsapp-messages-view" class="content-view">
                <div class="page-header">
                    <h1><i class="fas fa-comment-dots"></i> WhatsApp Messages</h1>
                    <p>Quick review and send WhatsApp messages to groups</p>
                </div>

                <div class="card">
                    <div class="card-body">
                        <!-- Search Bar -->
                        <div style="margin-bottom: 15px;">
                            <input type="text" id="whatsapp-search-input" class="form-control"
                                placeholder="üîç Search messages by category, group, text content..."
                                style="padding: 10px 15px; font-size: 1rem;" />
                        </div>

                        <div class="filter-bar"
                            style="display: flex; gap: 10px; flex-wrap: wrap; align-items: center; margin-bottom: 15px;">
                            <button id="refresh-whatsapp-messages-btn" class="btn btn-primary">
                                <span><i class="fas fa-sync-alt"></i></span> Refresh
                            </button>

                            <div style="flex: 1; display: flex; gap: 10px; flex-wrap: wrap;">
                                <select id="whatsapp-sort-by" class="form-control" style="max-width: 200px;">
                                    <option value="time-desc">‚è∞ Newest First</option>
                                    <option value="time-asc">‚è∞ Oldest First</option>
                                    <option value="confidence-desc">ü§ñ AI Confidence (High)</option>
                                    <option value="confidence-asc">ü§ñ AI Confidence (Low)</option>
                                </select>

                                <select id="whatsapp-filter-status" class="form-control" style="max-width: 180px;">
                                    <option value="pending">‚è≥ Pending Only</option>
                                    <option value="sent">‚úÖ Sent Only</option>
                                    <option value="all" selected>üìã All Status</option>
                                </select>

                                <select id="whatsapp-filter-website" class="form-control" style="max-width: 180px;">
                                    <option value="all">üåê All Websites</option>
                                    <option value="masaak">üè† ŸÖÿ≥ÿπÿßŸÉ Only</option>
                                    <option value="hasak">üìÖ ÿ≠ÿ≥ÿßŸÉ Only</option>
                                </select>

                                <select id="whatsapp-filter-category" class="form-control" style="max-width: 180px;">
                                    <option value="all">üìÅ All Categories</option>
                                </select>

                                <select id="whatsapp-filter-group" class="form-control" style="max-width: 200px;">
                                    <option value="all">üë• All Groups</option>
                                    <!-- Dynamic options populated by JS -->
                                </select>

                                <div
                                    style="display: flex; align-items: center; gap: 5px; padding: 0 10px; background: #f0f0f0; border-radius: 4px; font-size: 0.9rem; white-space: nowrap;">
                                    <i class="fas fa-filter"></i>
                                    <span id="whatsapp-messages-count">0 messages</span>
                                </div>
                            </div>
                        </div>
                        <div id="whatsapp-messages-info" class="info-message" style="display:none;"></div>
                        <div id="whatsapp-messages-list"
                            style="display: grid; grid-template-columns: repeat(auto-fill, minmax(350px, 1fr)); gap: 15px; margin-top: 20px;">
                        </div>
                    </div>
                </div>
            </div>

            <!-- Ads View -->
            <div id="ads-view" class="content-view">
                <div class="page-header">
                    <h1>Manage Ads</h1>
                    <p>Review and organize your fetched advertisements</p>
                </div>

                <div class="card">
                    <div class="card-body">
                        <!-- Search Bar -->
                        <div style="margin-bottom: 15px;">
                            <input type="text" id="ads-search-input" class="form-control"
                                placeholder="üîç Search by ID, title, category, location, price..."
                                style="padding: 10px 15px; font-size: 1rem;" />
                        </div>

                        <div id="ads-controls" class="filter-bar"
                            style="display: flex; gap: 10px; flex-wrap: wrap; align-items: center;">
                            <select id="ads-filter" class="form-control" style="max-width: 150px;">
                                <option value="all">üìã All Status</option>
                                <option value="new">üÜï New</option>
                                <option value="accepted">‚úÖ Accepted</option>
                                <option value="rejected">‚ùå Rejected</option>
                                <option value="posted">üì§ Posted</option>
                            </select>
                            <select id="category-filter" class="form-control" style="max-width: 150px;">
                                <option value="all">üìÅ All Categories</option>
                                <option value="uncategorized">‚ùì Uncategorized</option>
                            </select>
                            <select id="ads-website-filter" class="form-control" style="max-width: 150px;">
                                <option value="all">üåê All Websites</option>
                                <option value="masaak">üè† ŸÖÿ≥ÿπÿßŸÉ (Masaak)</option>
                                <option value="hasak">üìÖ ÿ≠ÿ≥ÿßŸÉ (Hasak)</option>
                            </select>
                            <select id="ads-group-filter" class="form-control" style="max-width: 200px;">
                                <option value="all">üë• All Groups</option>
                                <!-- Dynamic options populated by JS -->
                            </select>
                            <button id="refresh-ads-btn" class="btn btn-primary">
                                <span><i class="fas fa-sync-alt"></i></span> Refresh
                            </button>
                        </div>
                        <div id="ads-bulk-controls" class="filter-bar"
                            style="display:flex;gap:10px;flex-wrap:wrap;align-items:center;margin-top:12px;padding:10px;background:#f8f9ff;border:1px solid #dde3ff;border-radius:8px;">
                            <label style="display:flex;align-items:center;gap:6px;cursor:pointer;margin:0;">
                                <input id="ads-select-all-visible" type="checkbox">
                                <span>Select Visible Ads</span>
                            </label>
                            <span id="ads-selected-count"
                                style="padding:4px 10px;border-radius:999px;background:#eef2ff;color:#3f51b5;font-weight:600;">0
                                selected</span>
                            <label style="display:flex;align-items:center;gap:6px;">
                                Delay
                                <input id="ads-bulk-delay" type="number" min="0" max="120" value="2"
                                    class="form-control" style="width:80px;padding:6px;">
                                <span>sec</span>
                            </label>
                            <label style="display:flex;align-items:center;gap:6px;">
                                Retries
                                <input id="ads-bulk-retries" type="number" min="1" max="5" value="3"
                                    class="form-control" style="width:80px;padding:6px;">
                            </label>
                            <button id="ads-bulk-post-wp-btn" class="btn btn-warning" disabled>
                                <i class="fab fa-wordpress"></i> Post Selected to WordPress
                            </button>
                            <button id="ads-bulk-recycle-btn" class="btn btn-danger" disabled>
                                <i class="fas fa-trash"></i> Move Selected to Recycle Bin
                            </button>
                            <button id="ads-bulk-clear-btn" class="btn btn-secondary" disabled>
                                <i class="fas fa-times"></i> Clear Selection
                            </button>
                            <span id="ads-bulk-status" style="color:#555;font-size:0.9rem;"></span>
                        </div>
                        <div id="ads-info" class="info-message" style="display:none;"></div>
                        <div id="ads-list"></div>
                    </div>
                </div>
            </div>

            <!-- Collections View (Admin Only) -->
            <!-- <div id="collections-view" class="content-view admin-only" style="display: none;">
                <div class="page-header">
                    <h1>Group Collections</h1>
                    <p>Manage your saved group collections</p>
                </div>
                <div class="card">
                    <div class="card-body">
                        <button id="manage-collections-btn-view" class="btn btn-primary" style="margin-bottom: 20px;">
                            <span><i class="fas fa-folder"></i></span> Create New Collection
                        </button>
                        <div id="collections-view-list"></div>
                    </div>
                </div>
            </div> -->

            <!-- Categories View -->
            <div id="categories-view" class="content-view">
                <div class="page-header">
                    <h1>Manage Categories</h1>
                    <p>Create and organize ad categories</p>
                </div>
                <div class="card">
                    <div class="card-body">
                        <div class="form-group">
                            <label>Add New Category:</label>
                            <div class="category-form">
                                <input type="text" id="new-category-name-view" placeholder="Category name..."
                                    class="form-control">
                                <div style="display: flex; gap: 10px;">
                                    <input type="color" id="new-category-color-view" value="#9b59b6"
                                        class="color-input">
                                    <button id="add-category-btn-view" class="btn btn-primary" style="flex: 1;">
                                        <span><i class="fas fa-plus"></i></span> Add Category
                                    </button>
                                </div>
                            </div>
                        </div>
                        <div id="categories-view-list"></div>
                        <div id="categories-view-message" class="info-message" style="display:none;"></div>
                    </div>
                </div>
            </div>

            <!-- Users View (Admin Only) -->
            <div id="users-view" class="content-view">
                <div class="page-header">
                    <h1>Manage Users</h1>
                    <p>Add and manage system users</p>
                </div>
                <div class="card">
                    <div class="card-body">
                        <div class="form-group">
                            <label>Add New User:</label>
                            <div class="user-form">
                                <input type="text" id="new-user-username" placeholder="Username..."
                                    class="form-control">
                                <input type="password" id="new-user-password" placeholder="Password..."
                                    class="form-control">
                                <select id="new-user-role" class="form-control">
                                    <option value="author">Author</option>
                                    <option value="admin">Admin</option>
                                </select>
                                <button id="add-user-btn" class="btn btn-primary btn-block">
                                    <span><i class="fas fa-plus"></i></span> Add User
                                </button>
                            </div>
                        </div>
                        <div id="users-list"></div>
                        <div id="users-message" class="info-message" style="display:none;"></div>
                    </div>
                </div>
            </div>

            <!-- Private Clients View -->
            <div id="private-clients-view" class="content-view">
                <div class="page-header">
                    <h1><i class="fas fa-user-friends"></i> Private Clients</h1>
                    <p>Manage clients from private conversations</p>
                </div>

                <!-- Statistics Cards -->
                <div class="stats-grid" style="margin-bottom: 24px;">
                    <div class="stat-card">
                        <div class="stat-icon" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                            <i class="fas fa-users"></i>
                        </div>
                        <div class="stat-info">
                            <div class="stat-label">Total Clients</div>
                            <div class="stat-value" id="pc-stat-total">0</div>
                            <div class="stat-sublabel" id="pc-stat-active">0 active today</div>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);">
                            <i class="fas fa-search"></i>
                        </div>
                        <div class="stat-info">
                            <div class="stat-label">ÿ®ÿßÿ≠ÿ´</div>
                            <div class="stat-value" id="pc-stat-searcher">0</div>
                            <div class="stat-sublabel">Property Seekers</div>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);">
                            <i class="fas fa-home"></i>
                        </div>
                        <div class="stat-info">
                            <div class="stat-label">ŸÖÿßŸÑŸÉ</div>
                            <div class="stat-value" id="pc-stat-owner">0</div>
                            <div class="stat-sublabel">Property Owners</div>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon" style="background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);">
                            <i class="fas fa-chart-line"></i>
                        </div>
                        <div class="stat-info">
                            <div class="stat-label">ŸÖÿ≥ÿ™ÿ´ŸÖÿ± & Ÿàÿ≥Ÿäÿ∑</div>
                            <div class="stat-value" id="pc-stat-others">0</div>
                            <div class="stat-sublabel">Investors & Brokers</div>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-body">
                        <!-- Filters and Search -->
                        <div class="actions-bar"
                            style="display:flex;flex-direction:column;gap:12px;margin-bottom:20px;">
                            <div style="display:flex;gap:8px;flex-wrap:wrap;align-items:center;">
                                <div style="position:relative;flex:1;min-width:220px;">
                                    <i class="fas fa-search"
                                        style="position:absolute;left:12px;top:50%;transform:translateY(-50%);color:#888;"></i>
                                    <input id="pc-search-input" type="text" class="form-control"
                                        placeholder="Search by name or phone number..." style="padding-left:36px;">
                                </div>
                                <select id="pc-role-filter" class="form-control" style="min-width:180px;">
                                    <option value="all">All Roles</option>
                                    <option value="ÿ®ÿßÿ≠ÿ´">ÿ®ÿßÿ≠ÿ´ (Seeker)</option>
                                    <option value="ŸÖÿßŸÑŸÉ">ŸÖÿßŸÑŸÉ (Owner)</option>
                                    <option value="ŸÖÿ≥ÿ™ÿ´ŸÖÿ±">ŸÖÿ≥ÿ™ÿ´ŸÖÿ± (Investor)</option>
                                    <option value="Ÿàÿ≥Ÿäÿ∑">Ÿàÿ≥Ÿäÿ∑ (Broker)</option>
                                </select>
                                <select id="pc-sort-select" class="form-control" style="min-width:180px;">
                                    <option value="recent">Most Recent</option>
                                    <option value="oldest">Oldest First</option>
                                    <option value="name">By Name (A-Z)</option>
                                </select>
                                <button id="pc-refresh-btn" class="btn btn-primary" title="Refresh clients">
                                    <i class="fas fa-sync-alt"></i> Refresh
                                </button>
                            </div>
                        </div>

                        <!-- Clients List -->
                        <div id="private-clients-list">
                            <div class="loading" style="text-align: center; padding: 40px;">
                                <i class="fas fa-spinner fa-spin" style="font-size: 32px; color: #667eea;"></i>
                                <p style="margin-top: 12px; color: #666;">Loading clients...</p>
                            </div>
                        </div>

                        <div id="pc-message" class="info-message" style="display:none;"></div>
                    </div>
                </div>
            </div>

            <!-- Client Details Modal -->
            <div id="client-details-modal" class="modal" style="display: none;">
                <div class="modal-content" style="max-width: 800px; max-height: 90vh; overflow-y: auto;">
                    <div class="modal-header">
                        <h2><i class="fas fa-user-circle"></i> Client Details</h2>
                        <button id="close-client-modal" class="btn-close-modal">‚úï</button>
                    </div>
                    <div class="modal-body" id="client-details-content">
                        <!-- Content will be populated by JavaScript -->
                    </div>
                </div>
            </div>

            <!-- Recycle Bin View -->
            <div id="recycle-bin-view" class="content-view">
                <div class="page-header">
                    <h1><i class="fas fa-trash-restore"></i> Recycle Bin</h1>
                    <p>Messages rejected by AI - automatically deleted after <span id="recycle-days-display"></span>
                        days</p>
                </div>
                <div class="card">
                    <div class="card-body">
                        <div class="actions-bar"
                            style="display:flex;flex-direction:column;gap:12px;margin-bottom:12px;">
                            <div style="display:flex;gap:8px;flex-wrap:wrap;align-items:center;">
                                <div style="position:relative;flex:1;min-width:220px;">
                                    <i class="fas fa-search"
                                        style="position:absolute;left:12px;top:50%;transform:translateY(-50%);color:#888;"></i>
                                    <input id="recycle-search-input" type="text" class="form-control"
                                        placeholder="Search text, reason, or group" style="padding-left:36px;">
                                </div>
                                <select id="recycle-group-filter" class="form-control" style="min-width:180px;">
                                    <option value="all">All Groups</option>
                                </select>
                                <select id="recycle-conf-filter" class="form-control" style="min-width:180px;">
                                    <option value="all">All Confidence</option>
                                    <option value="high">High (&ge; 80%)</option>
                                    <option value="medium">Medium (50-79%)</option>
                                    <option value="low">Low (&lt; 50%)</option>
                                </select>
                                <select id="recycle-sort-select" class="form-control" style="min-width:180px;">
                                    <option value="recent">Newest first</option>
                                    <option value="oldest">Oldest first</option>
                                    <option value="confidence-desc">Confidence high ‚Üí low</option>
                                    <option value="confidence-asc">Confidence low ‚Üí high</option>
                                </select>
                                <button id="recycle-compact-toggle" class="btn btn-secondary"
                                    title="Toggle compact view">
                                    <i class="fas fa-compress"></i>
                                </button>
                                <div style="flex:1"></div>
                                <button id="refresh-recycle-btn" class="btn btn-primary">
                                    <i class="fas fa-sync-alt"></i> Refresh
                                </button>
                                <button id="empty-recycle-btn" class="btn btn-danger admin-only" style="display: none;">
                                    <i class="fas fa-trash"></i> Empty Recycle Bin
                                </button>
                            </div>
                            <div style="display:flex;gap:8px;flex-wrap:wrap;align-items:center;">
                                <label style="display:flex;align-items:center;gap:8px;margin:0;">
                                    <input id="recycle-select-all" type="checkbox"> Select all
                                </label>
                                <button id="recycle-bulk-restore" class="btn btn-success btn-sm" disabled>
                                    <i class="fas fa-undo"></i> Restore selected
                                </button>
                                <button id="recycle-bulk-delete" class="btn btn-danger btn-sm" disabled>
                                    <i class="fas fa-trash"></i> Delete selected
                                </button>
                                <span id="recycle-selected-count" style="color:#666;">0 selected</span>
                            </div>
                        </div>
                        <div id="recycle-bin-list"></div>
                        <div id="recycle-bin-message" class="info-message" style="display:none;"></div>
                    </div>
                </div>
            </div>

            <!-- Daily Summaries View -->
            <div id="daily-summaries-view" class="content-view">
                <div class="page-header">
                    <h1><i class="fas fa-chart-line"></i> Daily Summaries</h1>
                    <p>View automated daily ad summaries</p>
                </div>

                <!-- Scheduler Status Card -->
                <div class="card">
                    <div class="card-body">
                        <h3><i class="fas fa-clock"></i> Scheduler Status</h3>
                        <div id="scheduler-status-container" style="margin-top: 15px;">
                            <div
                                style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 15px;">
                                <div
                                    style="padding: 15px; background: #f8f9fa; border-radius: 8px; border-left: 4px solid #667eea;">
                                    <div style="font-size: 0.85rem; color: #666; margin-bottom: 5px;">Status</div>
                                    <div style="font-size: 1.1rem; font-weight: bold;" id="scheduler-running">-</div>
                                </div>
                                <div
                                    style="padding: 15px; background: #f8f9fa; border-radius: 8px; border-left: 4px solid #667eea;">
                                    <div style="font-size: 0.85rem; color: #666; margin-bottom: 5px;">Schedule</div>
                                    <div style="font-size: 1.1rem; font-weight: bold;" id="scheduler-schedule">-</div>
                                </div>
                                <div
                                    style="padding: 15px; background: #f8f9fa; border-radius: 8px; border-left: 4px solid #667eea;">
                                    <div style="font-size: 0.85rem; color: #666; margin-bottom: 5px;">KSA Time</div>
                                    <div style="font-size: 1.1rem; font-weight: bold;" id="scheduler-ksa-time">-</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Statistics Card -->
                <div class="card">
                    <div class="card-body">
                        <h3><i class="fas fa-chart-bar"></i> Statistics</h3>
                        <div
                            style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px; margin-top: 15px;">
                            <div class="stat-box-mini">
                                <div class="stat-label">Total Summaries</div>
                                <div class="stat-value" id="summary-total">0</div>
                            </div>
                            <div class="stat-box-mini">
                                <div class="stat-label">Today's Summaries</div>
                                <div class="stat-value" id="summary-today">0</div>
                            </div>
                            <div class="stat-box-mini">
                                <div class="stat-label">Today's Ads</div>
                                <div class="stat-value" id="summary-today-ads">0</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Actions Card -->
                <div class="card">
                    <div class="card-body">
                        <h3><i class="fas fa-play-circle"></i> Actions</h3>

                        <!-- Filters -->
                        <div
                            style="margin-top: 15px; margin-bottom: 15px; padding: 15px; background: #f8f9fa; border-radius: 8px;">
                            <h4 style="font-size: 14px; margin-bottom: 10px; color: #666;">
                                <i class="fas fa-filter"></i> Filter Options (Optional)
                            </h4>
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                                <div>
                                    <label for="filter-website"
                                        style="font-size: 12px; color: #888; display: block; margin-bottom: 5px;">Website:</label>
                                    <select id="filter-website" class="form-control" style="font-size: 14px;">
                                        <option value="">All Websites</option>
                                        <option value="masaak">üî∞ Masaak</option>
                                        <option value="hasak">üå¥ Hasak</option>
                                    </select>
                                </div>
                                <div>
                                    <label for="filter-category"
                                        style="font-size: 12px; color: #888; display: block; margin-bottom: 5px;">Category:</label>
                                    <select id="filter-category" class="form-control" style="font-size: 14px;">
                                        <option value="">All Categories</option>
                                        <optgroup label="Masaak Categories">
                                            <option value="ÿ£ÿ±ÿ∂">ÿßŸÑÿ£ÿ±ÿßÿ∂Ÿä ŸàÿßŸÑŸÖÿ≤ÿßÿ±ÿπ</option>
                                            <option value="ŸÅŸäŸÑÿß|ÿ®Ÿäÿ™">ÿßŸÑŸÅŸÑŸÑ ŸàÿßŸÑÿ®ŸäŸàÿ™</option>
                                            <option value="ÿ¥ŸÇÿ©">ÿßŸÑÿ¥ŸÇŸÇ ŸàÿßŸÑÿ¥ŸÇŸÇ ÿßŸÑÿØÿ®ŸÑŸÉÿ≥Ÿäÿ©</option>
                                            <option value="ÿØÿ®ŸÑŸÉÿ≥">ÿßŸÑÿØÿ®ŸÑŸÉÿ≥ÿßÿ™</option>
                                            <option value="ÿπŸÖÿßÿ±ÿ©">ÿßŸÑÿπŸÖÿßÿ±ÿßÿ™</option>
                                            <option value="ÿßÿ≥ÿ™ÿ±ÿßÿ≠ÿ©|ÿ¥ÿßŸÑŸäÿ©">ÿßŸÑÿßÿ≥ÿ™ÿ±ÿßÿ≠ÿßÿ™ ŸàÿßŸÑÿ¥ÿßŸÑŸäŸáÿßÿ™</option>
                                            <option value="ŸÖÿ≠ŸÑ ÿ™ÿ¨ÿßÿ±Ÿä|ŸÖÿ≠ŸÑ">ÿßŸÑŸÖÿ≠ŸÑÿßÿ™ ÿßŸÑÿ™ÿ¨ÿßÿ±Ÿäÿ©</option>
                                            <option value="ŸÖÿ≥ÿ™ŸàÿØÿπ">ÿßŸÑŸÖÿ≥ÿ™ŸàÿØÿπÿßÿ™</option>
                                            <option value="ÿ•Ÿäÿ¨ÿßÿ±">ÿπŸÇÿßÿ±ÿßÿ™ ŸÑŸÑÿ•Ÿäÿ¨ÿßÿ±</option>
                                            <option value="ÿßÿ≥ÿ™ÿ´ŸÖÿßÿ±">ÿßŸÑÿßÿ≥ÿ™ÿ´ŸÖÿßÿ± ŸàÿßŸÑÿ™ŸÇÿ®ŸäŸÑ</option>
                                        </optgroup>
                                        <optgroup label="Hasak Categories">
                                            <option value="ŸÅÿπÿßŸÑŸäÿ©">ŸÅÿπÿßŸÑŸäÿßÿ™ ÿßŸÑÿ£ÿ≠ÿ≥ÿßÿ°</option>
                                            <option value="ÿ≠ÿ±ÿßÿ¨ ÿßŸÑÿ≠ÿ≥ÿß">ÿßŸÑŸÖÿ≥ÿ™ÿπŸÖŸÑ</option>
                                        </optgroup>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <div style="display: flex; gap: 10px;">
                            <button id="trigger-summary-btn" class="btn btn-primary">
                                <i class="fas fa-play-circle"></i> Generate Summary Now
                            </button>
                            <button id="refresh-summaries-btn" class="btn btn-secondary">
                                <i class="fas fa-sync-alt"></i> Refresh
                            </button>
                        </div>
                        <div id="trigger-message" class="info-message" style="display:none; margin-top: 10px;"></div>
                    </div>
                </div>

                <!-- Summaries List Card -->
                <div class="card">
                    <div class="card-header">
                        <h2><i class="fas fa-list"></i> Recent Summaries</h2>
                    </div>
                    <div class="card-body">
                        <div id="summaries-list">
                            <div style="text-align: center; padding: 30px; color: #999;">
                                <i class="fas fa-spinner fa-spin" style="font-size: 2rem;"></i>
                                <p style="margin-top: 10px;">Loading summaries...</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Settings View -->
            <div id="settings-view" class="content-view">
                <div class="page-header">
                    <h1><i class="fas fa-cog"></i> Settings</h1>
                    <p>Configure system preferences</p>
                </div>

                <!-- API Keys Alert Banner -->
                <div id="api-keys-alert" class="alert-banner"
                    style="display: none; background: #fee; border: 2px solid #f44; padding: 1rem; border-radius: 8px; margin-bottom: 1rem;">
                    <div style="display: flex; align-items: center; gap: 1rem;">
                        <i class="fas fa-exclamation-triangle" style="font-size: 2rem; color: #f44;"></i>
                        <div style="flex: 1;">
                            <h3 style="margin: 0 0 0.5rem 0; color: #c00;">‚ö†Ô∏è API Key Limit Reached!</h3>
                            <p id="api-keys-alert-message" style="margin: 0; color: #333;">
                                All API keys have reached their quota limits. Please add new API keys to continue
                                processing messages.
                            </p>
                            <div id="api-keys-status-details"
                                style="margin-top: 0.5rem; font-size: 0.9rem; color: #666;">
                            </div>
                        </div>
                        <button id="dismiss-api-alert" class="btn btn-secondary" style="white-space: nowrap;">
                            <i class="fas fa-times"></i> Dismiss
                        </button>
                    </div>
                </div>

                <!-- Recycle Bin Settings -->
                <div class="card">
                    <div class="card-body">
                        <h3><i class="fas fa-trash-restore"></i> Recycle Bin Settings</h3>
                        <div class="form-group">
                            <label for="recycle-bin-days-input">Auto-Delete After (Days):</label>
                            <p style="color: #666; font-size: 0.9rem; margin-bottom: 0.5rem;">
                                Messages in recycle bin will be automatically deleted after this many days
                            </p>
                            <div style="display: flex; gap: 1rem; align-items: center;">
                                <input type="number" id="recycle-bin-days-input" class="form-control" min="1" max="365"
                                    style="max-width: 150px;" placeholder="7">
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Excluded Groups Settings -->
                <div class="card admin-only" style="display: none; margin-top: 1rem;">
                    <div class="card-body">
                        <h3><i class="fas fa-eye-slash"></i> Excluded Groups</h3>
                        <p style="color: #666; font-size: 0.9rem; margin-bottom: 1rem;">
                            Select groups to exclude from message processing. The bot will not scan or process messages
                            from these groups.
                        </p>

                        <button id="load-excluded-groups-btn" class="btn btn-primary" style="margin-bottom: 1rem;">
                            <i class="fas fa-sync-alt"></i> Load Groups
                        </button>

                        <div id="excluded-groups-container" style="display: none;">
                            <div style="margin-bottom: 1rem;">
                                <input type="text" id="excluded-groups-search" class="form-control"
                                    placeholder="üîç Search groups..." style="margin-bottom: 0.5rem;">
                                <div style="display: flex; gap: 0.5rem; margin-bottom: 0.5rem;">
                                    <button id="select-all-groups-btn" class="btn btn-sm btn-secondary">
                                        <i class="fas fa-check-square"></i> Select All
                                    </button>
                                    <button id="deselect-all-groups-btn" class="btn btn-sm btn-secondary">
                                        <i class="fas fa-square"></i> Deselect All
                                    </button>
                                </div>
                            </div>

                            <div id="excluded-groups-list"
                                style="max-height: 400px; overflow-y: auto; border: 1px solid #ddd; padding: 10px; border-radius: 4px; background: white;">
                                <!-- Groups checkboxes will be rendered here -->
                            </div>

                            <div id="excluded-groups-count" style="margin-top: 0.5rem; color: #666; font-size: 0.9rem;">
                                <!-- Count will be shown here -->
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Group Collections Management (Admin Only) -->
                <div class="card admin-only" style="display: none; margin-top: 1rem;">
                    <div class="card-body">
                        <h3><i class="fas fa-folder"></i> Group Collections</h3>
                        <p style="color: #666; font-size: 0.9rem; margin-bottom: 1rem;">
                            Create collections/folders to organize your WhatsApp groups for easier bulk messaging.
                        </p>

                        <div id="collections-list" style="margin-bottom: 1rem;">
                            <!-- Collections will be rendered here -->
                        </div>

                        <button id="add-collection-btn" class="btn btn-success">
                            <i class="fas fa-plus"></i> Create New Collection
                        </button>

                        <div id="collection-form"
                            style="display: none; background: #f5f5f5; padding: 1rem; border-radius: 8px; margin-top: 1rem;">
                            <h4 id="collection-form-title">Create New Collection</h4>
                            <div class="form-group">
                                <label for="collection-name-input">Collection Name:</label>
                                <input type="text" id="collection-name-input" class="form-control"
                                    placeholder="e.g., Real Estate Groups">
                            </div>
                            <div class="form-group">
                                <label>Select Groups:</label>
                                <div id="collection-groups-list"
                                    style="max-height: 300px; overflow-y: auto; border: 1px solid #ddd; padding: 10px; border-radius: 4px; background: white;">
                                    <!-- Groups checkboxes will be rendered here -->
                                </div>
                            </div>
                            <div style="display: flex; gap: 0.5rem; margin-top: 1rem;">
                                <button id="settings-save-collection-btn" class="btn btn-primary">
                                    <i class="fas fa-save"></i> Save Collection
                                </button>
                                <button id="cancel-collection-btn" class="btn btn-secondary">
                                    <i class="fas fa-times"></i> Cancel
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Categories Management -->
                <div class="card" style="margin-top: 1rem;">
                    <div class="card-body">
                        <h3><i class="fas fa-tags"></i> Manage Categories</h3>
                        <p style="color: #666; font-size: 0.9rem; margin-bottom: 1rem;">
                            Customize categories for organizing ads. These categories are used for filtering and
                            sorting.
                        </p>

                        <div id="categories-list" style="margin-bottom: 1rem;">
                            <!-- Categories will be rendered here -->
                        </div>

                        <button id="add-category-btn" class="btn btn-success">
                            <i class="fas fa-plus"></i> Add Category
                        </button>

                        <div id="category-form"
                            style="display: none; background: #f5f5f5; padding: 1rem; border-radius: 8px; margin-top: 1rem;">
                            <h4 id="category-form-title">Add New Category</h4>
                            <div class="form-group">
                                <label for="category-name-input">Category Name:</label>
                                <input type="text" id="category-name-input" class="form-control"
                                    placeholder="e.g., ÿπŸÇÿßÿ±ÿßÿ™">
                            </div>
                            <div class="form-group">
                                <label for="category-color-input">Category Color:</label>
                                <input type="color" id="category-color-input" class="form-control" value="#3498db"
                                    style="max-width: 100px; height: 50px;">
                            </div>
                            <div style="display: flex; gap: 0.5rem; margin-top: 1rem;">
                                <button id="save-category-btn" class="btn btn-primary">
                                    <i class="fas fa-save"></i> Save Category
                                </button>
                                <button id="cancel-category-btn" class="btn btn-secondary">
                                    <i class="fas fa-times"></i> Cancel
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- WordPress Settings -->
                <div class="card admin-only" style="display: none; margin-top: 1rem;">
                    <div class="card-body">
                        <h3><i class="fab fa-wordpress"></i> WordPress Integration</h3>
                        <p style="color: #666; font-size: 0.9rem; margin-bottom: 1rem;">
                            Configure WordPress credentials to automatically post ads to your website.
                        </p>

                        <!-- Auto-Approve Toggle -->
                        <div class="form-group"
                            style="background: #f8f9fa; padding: 1rem; border-radius: 8px; margin-bottom: 1rem; border: 2px solid #667eea;">
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <div>
                                    <label style="margin: 0; font-weight: bold; color: #333;">
                                        <i class="fas fa-magic"></i> Auto-Approve & Post to WordPress
                                    </label>
                                    <small style="color: #666; display: block; margin-top: 0.5rem;">
                                        When enabled, approved ads will automatically post to WordPress. When disabled,
                                        you'll need to manually post each ad.
                                    </small>
                                </div>
                                <label class="switch" style="margin: 0;">
                                    <input type="checkbox" id="auto-approve-wp-toggle">
                                    <span class="slider round"></span>
                                </label>
                            </div>
                        </div>

                        <!-- Auto-Post Group Selection -->
                        <div class="form-group"
                            style="background: #f8f9fa; padding: 1rem; border-radius: 8px; margin-bottom: 1rem; border: 1px solid #d8dbe2;">
                            <label style="margin: 0; font-weight: bold; color: #333;">
                                <i class="fas fa-layer-group"></i> Auto-Post Groups (Fixed Category [131])
                            </label>
                            <small style="color: #666; display: block; margin-top: 0.5rem; margin-bottom: 0.75rem;">
                                Only ads from selected groups will auto-post to WordPress. Automatic posts use
                                category <strong>131</strong>.
                            </small>

                            <button id="load-auto-post-groups-btn" class="btn btn-secondary" type="button"
                                style="margin-bottom: 0.75rem;">
                                <i class="fas fa-sync-alt"></i> Load Groups
                            </button>

                            <div id="auto-post-groups-container" style="display: none;">
                                <input type="text" id="auto-post-groups-search" class="form-control"
                                    placeholder="üîç Search groups..." style="margin-bottom: 0.5rem;">
                                <div style="display: flex; gap: 0.5rem; margin-bottom: 0.5rem;">
                                    <button id="select-all-auto-post-groups-btn" class="btn btn-sm btn-secondary"
                                        type="button">
                                        <i class="fas fa-check-square"></i> Select All
                                    </button>
                                    <button id="deselect-all-auto-post-groups-btn" class="btn btn-sm btn-secondary"
                                        type="button">
                                        <i class="fas fa-square"></i> Deselect All
                                    </button>
                                </div>
                                <div id="auto-post-groups-list"
                                    style="max-height: 280px; overflow-y: auto; border: 1px solid #ddd; padding: 10px; border-radius: 4px; background: white;">
                                </div>
                                <div id="auto-post-groups-count"
                                    style="margin-top: 0.5rem; color: #666; font-size: 0.9rem;"></div>
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="wp-url">WordPress Site URL:</label>
                            <input type="text" id="wp-url" class="form-control" placeholder="https://masaak.com"
                                value="">
                        </div>

                        <div class="form-group">
                            <label for="wp-username">WordPress Username:</label>
                            <input type="text" id="wp-username" class="form-control" placeholder="admin" value="">
                        </div>

                        <div class="form-group">
                            <label for="wp-password">WordPress Application Password:</label>
                            <input type="password" id="wp-password" class="form-control"
                                placeholder="xxxx xxxx xxxx xxxx xxxx xxxx" value="">
                            <small style="color: #666; display: block; margin-top: 0.5rem;">
                                Generate an application password in WordPress: Users ‚Üí Profile ‚Üí Application Passwords
                            </small>
                        </div>

                        <button id="test-wp-connection-btn" class="btn btn-secondary">
                            <i class="fas fa-vial"></i> Test Connection
                        </button>
                    </div>
                </div>

                <!-- Category Limits Settings -->
                <div class="card admin-only" style="display: none; margin-top: 1rem;">
                    <div class="card-body">
                        <h3><i class="fas fa-ban"></i> Category Limits (Per Day)</h3>
                        <p style="color: #666; font-size: 0.9rem; margin-bottom: 1rem;">
                            Set maximum number of ads allowed per category <strong>per day</strong>. When a category
                            reaches its daily limit, new ads
                            will be automatically blocked until the next day (resets at 00:00).
                        </p>

                        <div id="category-limits-list" style="margin-bottom: 1rem;">
                            <!-- Category limits will be loaded here -->
                        </div>

                        <button id="add-category-limit-btn" class="btn btn-secondary">
                            <i class="fas fa-plus"></i> Add Category Limit
                        </button>
                    </div>
                </div>

                <!-- API Keys Settings -->
                <div class="card admin-only" style="display: none; margin-top: 1rem;">
                    <div class="card-body">
                        <h3><i class="fas fa-key"></i> AI API Keys Management</h3>
                        <p style="color: #666; font-size: 0.9rem; margin-bottom: 1rem;">
                            Manage API keys for multiple AI providers (GPT & Gemini). The system automatically routes
                            requests to the correct provider and handles failover between keys. Drag to reorder priority
                            within each provider.
                        </p>

                        <!-- Provider Tabs -->
                        <div class="api-provider-tabs"
                            style="display: flex; gap: 0.5rem; margin-bottom: 1rem; border-bottom: 2px solid #e0e0e0; padding-bottom: 0.5rem;">
                            <button id="gemini-tab-btn" class="btn btn-provider-tab active"
                                style="background: #4285f4; color: white; border: none; padding: 0.5rem 1rem; border-radius: 8px 8px 0 0; cursor: pointer;">
                                <i class="fas fa-gem"></i> Gemini Keys
                            </button>
                            <button id="gpt-tab-btn" class="btn btn-provider-tab"
                                style="background: #e0e0e0; color: #333; border: none; padding: 0.5rem 1rem; border-radius: 8px 8px 0 0; cursor: pointer;">
                                <i class="fas fa-brain"></i> GPT Keys
                            </button>
                        </div>

                        <!-- API Keys Status Summary -->
                        <div id="api-keys-summary"
                            style="background: #f8f9fa; padding: 0.75rem; border-radius: 8px; margin-bottom: 1rem; display: flex; gap: 1rem; flex-wrap: wrap;">
                            <div style="flex: 1; min-width: 150px;">
                                <strong style="color: #4285f4;"><i class="fas fa-gem"></i> Gemini:</strong>
                                <span id="gemini-keys-status">Loading...</span>
                            </div>
                            <div style="flex: 1; min-width: 150px;">
                                <strong style="color: #10a37f;"><i class="fas fa-brain"></i> GPT:</strong>
                                <span id="gpt-keys-status">Loading...</span>
                            </div>
                        </div>

                        <!-- Gemini Keys List -->
                        <div id="gemini-keys-section">
                            <div id="gemini-keys-list" style="margin-bottom: 1rem;"></div>
                        </div>

                        <!-- GPT Keys List -->
                        <div id="gpt-keys-section" style="display: none;">
                            <div id="gpt-keys-list" style="margin-bottom: 1rem;"></div>
                        </div>

                        <button id="add-api-key-btn" class="btn btn-success" style="margin-bottom: 1rem;">
                            <i class="fas fa-plus"></i> Add New API Key
                        </button>

                        <div id="api-key-form"
                            style="display: none; background: #f5f5f5; padding: 1rem; border-radius: 8px; margin-bottom: 1rem;">
                            <h4>Add New API Key</h4>
                            <div class="form-group">
                                <label for="api-key-provider">Provider:</label>
                                <select id="api-key-provider" class="form-control">
                                    <option value="gemini">Gemini (Google AI)</option>
                                    <option value="gpt">GPT (OpenAI)</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="api-key-name">Key Name:</label>
                                <input type="text" id="api-key-name" class="form-control"
                                    placeholder="e.g., Primary Key">
                            </div>
                            <div class="form-group">
                                <label for="api-key-value">API Key:</label>
                                <input type="text" id="api-key-value" class="form-control" placeholder="Enter API key">
                                <small id="api-key-hint" style="color: #666; display: block; margin-top: 0.25rem;">
                                    Gemini keys start with "AIzaSy...", GPT keys start with "sk-..."
                                </small>
                            </div>
                            <div style="display: flex; gap: 0.5rem;">
                                <button id="save-api-key-btn" class="btn btn-primary">
                                    <i class="fas fa-save"></i> Save Key
                                </button>
                                <button id="cancel-api-key-btn" class="btn btn-secondary">
                                    <i class="fas fa-times"></i> Cancel
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <div style="display: flex; justify-content: flex-end; margin-top: 1rem;">
                    <button id="save-all-settings-btn" class="btn btn-primary admin-only" style="display: none;">
                        <i class="fas fa-save"></i> Save All Settings
                    </button>
                </div>

                <div id="settings-message" class="info-message" style="display:none;"></div>
            </div>
        </div>
    </div>

    <!-- Resend Modal -->
    <div id="resend-modal" class="modal" style="display:none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-share-square"></i> Resend Ad to Groups</h3>
                <button id="close-modal" class="btn-close">&times;</button>
            </div>
            <div class="modal-body">
                <!-- Group Collections -->
                <div class="form-group">
                    <label><i class="fas fa-folder"></i> Saved Collections:</label>
                    <div style="display:flex;gap:8px;flex-wrap:wrap;margin-bottom:12px;">
                        <select id="collection-select" class="form-group" style="flex:1;min-width:200px;">
                            <option value="">-- Select Collection --</option>
                        </select>
                        <button id="load-collection-btn" class="btn btn-small">Load</button>
                        <button id="manage-collections-btn" class="btn btn-small">Manage</button>
                    </div>
                </div>

                <!-- Available Groups -->
                <div class="form-group">
                    <label><i class="fas fa-mobile-alt"></i> Select Groups:</label>
                    <div id="groups-list" class="groups-list">
                        <div class="loading">Loading groups...</div>
                    </div>
                </div>

                <!-- Custom Phone Numbers -->
                <div class="form-group" style="border-top:1px solid #ddd;padding-top:12px;margin-top:12px;">
                    <label><i class="fas fa-phone"></i> Custom Phone Numbers:</label>
                    <div id="custom-numbers-list" class="groups-list" style="margin-bottom:12px;">
                        <!-- Custom numbers will be rendered here -->
                    </div>
                    <div style="display:flex;gap:8px;align-items:center;margin-bottom:8px;">
                        <input type="text" id="custom-number-name" placeholder="Name (e.g., Ahmed)" style="flex:1;">
                        <input type="text" id="custom-number-phone" placeholder="Phone (e.g., 966501234567)"
                            style="flex:1;">
                        <button id="add-custom-number-btn" class="btn btn-small btn-success">
                            <i class="fas fa-plus"></i> Add
                        </button>
                    </div>
                    <div style="display:flex;gap:8px;">
                        <select id="saved-numbers-select" class="form-control" style="flex:1;">
                            <option value="">-- Select Saved Number --</option>
                        </select>
                        <button id="manage-custom-numbers-btn" class="btn btn-small btn-secondary">
                            <i class="fas fa-cog"></i> Manage
                        </button>
                    </div>
                </div>

                <!-- Save Collection -->
                <div class="form-group" style="border-top:1px solid #ddd;padding-top:12px;margin-top:12px;">
                    <label><i class="fas fa-save"></i> Save Selection as Collection:</label>
                    <div style="display:flex;gap:8px;">
                        <input type="text" id="collection-name" placeholder="Enter collection name..." style="flex:1;">
                        <button id="save-collection-btn" class="btn btn-small">Save</button>
                    </div>
                </div>

                <div id="modal-message" class="info-message" style="display:none;margin-top:12px;"></div>
            </div>
            <div class="modal-footer">
                <button id="cancel-resend-btn" class="btn btn-secondary">Cancel</button>
                <button id="confirm-resend-btn" class="btn btn-primary">Resend to Selected Groups</button>
            </div>
        </div>
    </div>

    <!-- Manage Collections Modal -->
    <div id="collections-modal" class="modal" style="display:none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-folder"></i> Manage Group Collections</h3>
                <button id="close-collections-modal" class="btn-close">&times;</button>
            </div>
            <div class="modal-body">
                <div id="collections-modal-list"></div>
            </div>
            <div class="modal-footer">
                <button id="close-collections-btn" class="btn btn-secondary">Close</button>
            </div>
        </div>
    </div>

    <!-- Manage Categories Modal -->
    <div id="categories-modal" class="modal" style="display:none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-tags"></i> Manage Categories</h3>
                <button id="close-categories-modal" class="btn-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group" style="margin-bottom:20px;">
                    <label>Add New Category:</label>
                    <div style="display:flex;gap:8px;align-items:center;">
                        <input type="text" id="new-category-name" placeholder="Category name..." style="flex:1;">
                        <input type="color" id="new-category-color" value="#9b59b6"
                            style="width:50px;height:38px;border:1px solid #ddd;border-radius:5px;">
                        <button id="add-category-btn" class="btn btn-small">Add</button>
                    </div>
                </div>
                <div id="categories-list"></div>
                <div id="categories-message" class="info-message" style="display:none;margin-top:12px;"></div>
            </div>
            <div class="modal-footer">
                <button id="close-categories-btn" class="btn btn-secondary">Close</button>
            </div>
        </div>
    </div>

    <!-- Manage Custom Numbers Modal -->
    <div id="custom-numbers-modal" class="modal" style="display:none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-phone"></i> Manage Custom Phone Numbers</h3>
                <button id="close-custom-numbers-modal" class="btn-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group" style="margin-bottom:20px;">
                    <label>Add New Custom Number:</label>
                    <div style="display:flex;gap:8px;align-items:center;">
                        <input type="text" id="manage-custom-number-name" placeholder="Name (e.g., Ahmed)"
                            style="flex:1;">
                        <input type="text" id="manage-custom-number-phone" placeholder="Phone (966501234567)"
                            style="flex:1;">
                        <button id="save-custom-number-btn" class="btn btn-small btn-success">
                            <i class="fas fa-save"></i> Save
                        </button>
                    </div>
                </div>
                <div id="saved-custom-numbers-list"></div>
                <div id="custom-numbers-message" class="info-message" style="display:none;margin-top:12px;"></div>
            </div>
            <div class="modal-footer">
                <button id="close-manage-custom-numbers-btn" class="btn btn-secondary">Close</button>
            </div>
        </div>
    </div>

    <!-- Edit Ad Modal -->
    <!-- Edit Ad Modal -->
    <div id="edit-ad-modal" class="modal" style="display:none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-edit"></i> Edit Ad Text</h3>
                <button id="close-edit-ad-modal" class="btn-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="edit-ad-textarea">Ad Content:</label>
                    <textarea id="edit-ad-textarea" class="form-control" rows="12" placeholder="Enter ad text..."
                        style="white-space: pre-wrap; font-family: inherit; line-height: 1.6;"></textarea>
                    <small style="color:#666;margin-top:6px;display:block;">Edit the ad content as needed. Line breaks
                        will be preserved.</small>
                </div>
                <div id="edit-ad-message" class="info-message" style="display:none;margin-top:12px;"></div>
            </div>
            <div class="modal-footer">
                <button id="cancel-edit-ad-btn" class="btn btn-secondary">Cancel</button>
                <button id="save-edit-ad-btn" class="btn btn-primary">Save Changes</button>
            </div>
        </div>
    </div>

    <!-- Rejection Reason Modal -->
    <div id="reject-reason-modal" class="modal" style="display:none;">
        <div class="modal-content" style="max-width: 500px;">
            <div class="modal-header"
                style="background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%); color: white;">
                <h3><i class="fas fa-times-circle"></i> Reject Ad - Enter Reason</h3>
                <button id="close-reject-modal" class="btn-close" style="color: white;">&times;</button>
            </div>
            <div class="modal-body">
                <p style="margin-bottom:15px;color:#666;">Please provide a reason for rejecting this ad:</p>

                <!-- Quick Reason Buttons -->
                <div style="display: flex; flex-wrap: wrap; gap: 8px; margin-bottom: 15px;">
                    <button type="button" class="btn btn-sm btn-outline-secondary quick-reject-reason"
                        data-reason="ŸÑŸäÿ≥ ÿ•ÿπŸÑÿßŸÜ ÿπŸÇÿßÿ±Ÿä">ŸÑŸäÿ≥ ÿ•ÿπŸÑÿßŸÜ ÿπŸÇÿßÿ±Ÿä</button>
                    <button type="button" class="btn btn-sm btn-outline-secondary quick-reject-reason"
                        data-reason="ÿ•ÿπŸÑÿßŸÜ ŸÖŸÉÿ±ÿ±">ÿ•ÿπŸÑÿßŸÜ ŸÖŸÉÿ±ÿ±</button>
                    <button type="button" class="btn btn-sm btn-outline-secondary quick-reject-reason"
                        data-reason="ŸÖÿπŸÑŸàŸÖÿßÿ™ ÿ∫Ÿäÿ± ŸÉÿßŸÅŸäÿ©">ŸÖÿπŸÑŸàŸÖÿßÿ™ ÿ∫Ÿäÿ± ŸÉÿßŸÅŸäÿ©</button>
                    <button type="button" class="btn btn-sm btn-outline-secondary quick-reject-reason"
                        data-reason="ÿ•ÿπŸÑÿßŸÜ ÿ≥ÿ®ÿßŸÖ">ÿ•ÿπŸÑÿßŸÜ ÿ≥ÿ®ÿßŸÖ</button>
                    <button type="button" class="btn btn-sm btn-outline-secondary quick-reject-reason"
                        data-reason="ŸÖÿ≠ÿ™ŸàŸâ ÿ∫Ÿäÿ± ŸÖŸÜÿßÿ≥ÿ®">ŸÖÿ≠ÿ™ŸàŸâ ÿ∫Ÿäÿ± ŸÖŸÜÿßÿ≥ÿ®</button>
                    <button type="button" class="btn btn-sm btn-outline-secondary quick-reject-reason"
                        data-reason="ÿÆÿßÿ±ÿ¨ ŸÜÿ∑ÿßŸÇ ÿßŸÑÿÆÿØŸÖÿ©">ÿÆÿßÿ±ÿ¨ ŸÜÿ∑ÿßŸÇ ÿßŸÑÿÆÿØŸÖÿ©</button>
                </div>

                <div class="form-group">
                    <label for="reject-reason-textarea">Rejection Reason / ÿ≥ÿ®ÿ® ÿßŸÑÿ±ŸÅÿ∂:</label>
                    <textarea id="reject-reason-textarea" class="form-control" rows="4"
                        placeholder="ÿ£ÿØÿÆŸÑ ÿ≥ÿ®ÿ® ÿ±ŸÅÿ∂ Ÿáÿ∞ÿß ÿßŸÑÿ•ÿπŸÑÿßŸÜ..." style="font-size: 1rem; direction: rtl;"></textarea>
                </div>
                <div id="reject-reason-message" class="info-message" style="display:none;margin-top:12px;"></div>
            </div>
            <div class="modal-footer">
                <button id="cancel-reject-btn" class="btn btn-secondary">ÿ•ŸÑÿ∫ÿßÿ° / Cancel</button>
                <button id="confirm-reject-btn" class="btn btn-danger">
                    <i class="fas fa-trash"></i> ÿ±ŸÅÿ∂ ÿßŸÑÿ•ÿπŸÑÿßŸÜ / Reject
                </button>
            </div>
        </div>
    </div>

    <!-- Accept Options Modal -->
    <div id="accept-options-modal" class="modal" style="display:none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-check-circle"></i> Accept Ad - Choose Destination</h3>
                <button id="close-accept-modal" class="btn-close">&times;</button>
            </div>
            <div class="modal-body">
                <p style="margin-bottom:20px;color:#666;">Where would you like to send this ad?</p>
                <div class="accept-options">
                    <button id="accept-groups-only" class="accept-option-btn">
                        <i class="fas fa-users"></i>
                        <span>WhatsApp Groups Only</span>
                        <small>Send to selected WhatsApp groups</small>
                    </button>
                    <button id="accept-wp-only" class="accept-option-btn">
                        <i class="fab fa-wordpress"></i>
                        <span>WordPress Only</span>
                        <small>Post directly to WordPress</small>
                    </button>
                    <button id="accept-both" class="accept-option-btn">
                        <i class="fas fa-share-alt"></i>
                        <span>Both Platforms</span>
                        <small>Send to groups and post to WordPress</small>
                    </button>
                </div>
                <div id="accept-options-message" class="info-message" style="display:none;margin-top:12px;"></div>
            </div>
            <div class="modal-footer">
                <button id="cancel-accept-btn" class="btn btn-secondary">Cancel</button>
            </div>
        </div>
    </div>

    <script>
        // WordPress Category Subcategory Mapping (matches backend)
        const wpSubcategoryMap = {
            "ÿ£ÿ±ÿ∂": ["ÿ≥ŸÉŸÜŸäÿ©", "ÿ™ÿ¨ÿßÿ±Ÿäÿ©", "ÿ≤ÿ±ÿßÿπŸäÿ©"],
            "ÿ®Ÿäÿ™": ["ÿØŸàÿ±", "ÿØŸàÿ± Ÿàÿ¥ŸÇŸÇ", "ÿØŸàÿ± ŸàŸÖŸÑÿ≠ŸÇ", "ÿØŸàÿ±ŸäŸÜ", "ÿπÿ±ÿ®Ÿä"],
            "ÿØÿ®ŸÑŸÉÿ≥": ["ÿ®ÿ∑ŸÜ", "ÿ≤ÿßŸàŸäÿ©"],
            "ÿ¥ŸÇÿ© ÿØÿ®ŸÑŸÉÿ≥Ÿäÿ©": ["ÿØŸàÿ± ÿ£ÿ±ÿ∂Ÿä", "ÿØŸàÿ± ÿ£ŸàŸÑ", "ÿØŸàÿ± ÿ´ÿßŸÜŸä", "ÿØŸàÿ± ÿ´ÿßŸÑÿ´"],
            "ÿ¥ŸÇÿ©": ["ÿØŸàÿ± ÿ£ÿ±ÿ∂Ÿä", "ÿØŸàÿ± ÿ£ŸàŸÑ", "ÿØŸàÿ± ÿ´ÿßŸÜŸä", "ÿØŸàÿ± ÿ´ÿßŸÑÿ´"],
            "ÿπŸÖÿßÿ±ÿ©": ["ÿ≥ŸÉŸÜŸäÿ©", "ÿ™ÿ¨ÿßÿ±Ÿäÿ©", "ÿ≥ŸÉŸÜŸäÿ© ÿ™ÿ¨ÿßÿ±Ÿäÿ©"],
            "ŸÅŸäŸÑÿß": ["ÿØŸàÿ±", "ÿØŸàÿ± Ÿàÿ¥ŸÇŸÇ", "ÿØŸàÿ±ŸäŸÜ"],
            "ŸÖÿ≠ÿ∑ÿ© ÿ®ŸÜÿ≤ŸäŸÜ": ["ÿ®ÿØŸàŸÜ ŸÖÿ≠ŸÑÿßÿ™", "ŸÖÿπ ŸÖÿ≠ŸÑÿßÿ™"],
            "ŸÖÿ≠ŸÑ ÿ™ÿ¨ÿßÿ±Ÿä": [
                "ÿ≠ŸÑÿßŸÇ", "ŸÖÿ∫ÿ≥ŸÑÿ© ÿ≥Ÿäÿßÿ±ÿßÿ™", "ŸÖÿ∫ÿ≥ŸÑÿ© ŸÖŸÑÿßÿ®ÿ≥", "ÿ®ŸÇÿßŸÑÿ©", "ÿ≥Ÿàÿ®ÿ± ŸÖÿßÿ±ŸÉÿ™",
                "ŸÖÿ≠ŸÑ ÿ≥ÿ®ÿßŸÉÿ©", "ŸÖÿ≠ŸÑ ÿ≤ŸäŸÜÿ©", "ŸÖÿ∑ÿπŸÖ", "ÿ®ŸàŸÅŸäÿ©", "ŸÉŸàŸÅŸä", "ŸÖÿ¥ÿ∫ŸÑ ŸÜÿ≥ÿßÿ¶Ÿä",
                "ÿ≠ŸÑŸàŸäÿßÿ™", "ŸÖÿ≠ŸÑ ŸÉŸáÿ±ÿ®ÿßÿ°", "ÿ£ÿØŸàÿßÿ™ ÿµÿ≠Ÿäÿ©", "ÿµŸäÿØŸÑŸäÿ©", "ŸÖÿ≠ŸÑ ŸÖŸÑÿßÿ®ÿ≥",
                "ŸÇÿ∑ÿπ ÿ≥Ÿäÿßÿ±ÿßÿ™", "ŸÖÿ≠ŸÑ ÿ£ÿ´ÿßÿ´", "ŸÖÿ≠ŸÑ ŸÉŸÖÿßŸÑŸäÿßÿ™", "ŸÖÿ≠ŸÑ ÿπÿµÿßŸäÿ±", "ŸÖÿ≠ŸÑ ŸÅŸàÿßŸÉŸá",
                "ÿ¨ŸàÿßŸÑÿßÿ™", "ŸÅŸàÿØ ÿ™ÿ±ŸÉ", "ŸÖÿ≠ŸÑ ÿ™ÿ¨ÿßÿ±Ÿä"
            ],
            "ŸÖÿ≤ÿ±ÿπÿ©": ["ÿµŸÉ", "ÿπÿ±ŸÇ", "ŸÖÿ¥ÿßÿπ", "ŸàŸÇŸÅ"],
            "ÿßÿ≥ÿ™ÿ±ÿßÿ≠ÿ©": ["ÿµŸÉ", "ÿπÿ±ŸÇ", "ŸÖÿ¥ÿßÿπ", "ŸàŸÇŸÅ"],
            "ÿ¥ÿßŸÑŸäÿ©": ["ÿµŸÉ", "ÿπÿ±ŸÇ", "ŸÖÿ¥ÿßÿπ", "ŸàŸÇŸÅ"],
            "ŸÖÿ≥ÿ™ŸàÿØÿπ": ["ŸÉÿ®Ÿäÿ±", "ÿµÿ∫Ÿäÿ±"],
            " ŸÑŸÑÿ•Ÿäÿ¨ÿßÿ±": ["ÿ¥ŸÇÿ©", "ÿØÿ®ŸÑŸÉÿ≥", "ŸÅŸäŸÑÿß", "ÿ®Ÿäÿ™", "ÿ¥ŸÇÿ© ÿØÿ®ŸÑŸÉÿ≥Ÿäÿ©", "ÿπŸÖÿßÿ±ÿ©", "ÿßÿ≥ÿ™ÿ±ÿßÿ≠ÿ©", "ÿ¥ÿßŸÑŸäÿ©", "ŸÖÿ≠ŸÑ ÿ™ÿ¨ÿßÿ±Ÿä", "ŸÖÿ≤ÿ±ÿπÿ©", "ŸÖÿ≥ÿ™ŸàÿØÿπ"]
        };

        // Function to update subcategories based on parent selection
        function updateWpSubcategories() {
            const parentSelect = document.getElementById('wp-preview-parent-catt');
            const subSelect = document.getElementById('wp-preview-sub-catt');
            const arcCategoryInput = document.getElementById('wp-preview-arc-category');
            const arcSubcategoryInput = document.getElementById('wp-preview-arc-subcategory');

            const parentValue = parentSelect.value;

            // Update arc_category to match parent_catt
            if (arcCategoryInput) {
                arcCategoryInput.value = parentValue;
            }

            // Clear subcategory
            subSelect.innerHTML = '<option value="">ÿßÿÆÿ™ÿ± ÿßŸÑŸÜŸàÿπ ÿßŸÑŸÅÿ±ÿπŸä</option>';
            if (arcSubcategoryInput) {
                arcSubcategoryInput.value = '';
            }

            // Populate subcategories if parent is selected
            if (parentValue && wpSubcategoryMap[parentValue]) {
                wpSubcategoryMap[parentValue].forEach(function (sub) {
                    const option = document.createElement('option');
                    option.value = sub;
                    option.textContent = sub;
                    subSelect.appendChild(option);
                });
                subSelect.disabled = false;
            } else {
                subSelect.disabled = true;
            }
        }

        // Sync sub_catt with arc_subcategory when changed
        document.addEventListener('DOMContentLoaded', function () {
            const subSelect = document.getElementById('wp-preview-sub-catt');
            const arcSubcategoryInput = document.getElementById('wp-preview-arc-subcategory');

            if (subSelect && arcSubcategoryInput) {
                subSelect.addEventListener('change', function () {
                    arcSubcategoryInput.value = this.value;
                });
            }
        });
    </script>

    <script src="/js/app.js"></script>
    <script src="/js/ad-details-flow.js"></script>
</body>

</html>
