<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>masaak Dashboard</title>
    <link rel="stylesheet" href="/css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>

<body>
    <!-- Login Page -->
    <div id="login-page" class="page active">
        <div class="login-hero">
            <div class="login-card">
                <div class="login-brand">
                    <div class="brand-icon"><i class="fas fa-robot"></i></div>
                    <div class="brand-text">
                        <h1>WhatsApp Bot</h1>
                        <p>Dashboard Login</p>
                    </div>
                </div>
                <form id="login-form" class="login-form">
                    <div class="form-group">
                        <label for="username">Username</label>
                        <div class="input-with-icon">
                            <i class="fas fa-user"></i>
                            <input type="text" id="username" name="username" required placeholder="Enter username">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="password">Password</label>
                        <div class="input-with-icon">
                            <i class="fas fa-lock"></i>
                            <input type="password" id="password" name="password" required placeholder="Enter password">
                            <button type="button" id="toggle-password" class="input-action" title="Show/Hide password">
                                <i class="fas fa-eye"></i>
                            </button>
                        </div>
                    </div>
                    <div class="login-options">
                        <label class="remember-me"><input type="checkbox" id="remember-me"> Remember me</label>
                        <span class="forgot-hint">Forgot password?</span>
                    </div>
                    <button type="submit" class="btn btn-primary btn-block">Login</button>
                    <div id="login-error" class="error-message" style="margin-top:12px;"></div>
                </form>
                <div class="login-info">
                </div>
            </div>
        </div>
    </div>

    <!-- Dashboard Page -->
    <div id="dashboard-page" class="page">
        <!-- Sidebar -->
        <div id="sidebar" class="sidebar">
            <div class="sidebar-header">
                <h2><i class="fas fa-robot"></i> massak Bot</h2>
                <button id="close-sidebar" class="btn-close-sidebar">âœ•</button>
            </div>
            <nav class="sidebar-nav">
                <a href="#" class="nav-item active" data-view="home">
                    <span class="nav-icon"><i class="fas fa-home"></i></span>
                    <span class="nav-text">Home</span>
                </a>
                <a href="#" class="nav-item admin-only" data-view="whatsapp-messages" style="display: none;">
                    <span class="nav-icon"><i class="fas fa-comment-dots"></i></span>
                    <span class="nav-text">WhatsApp Messages</span>
                </a>
                <a href="#" class="nav-item" data-view="ads">
                    <span class="nav-icon"><i class="fas fa-ad"></i></span>
                    <span class="nav-text">Manage Ads</span>
                </a>
                <a href="#" class="nav-item" data-view="recycle-bin">
                    <span class="nav-icon"><i class="fas fa-trash-restore"></i></span>
                    <span class="nav-text">Recycle Bin</span>
                </a>
                <a href="#" class="nav-item admin-only" data-view="private-clients" style="display: none;">
                    <span class="nav-icon"><i class="fas fa-user-friends"></i></span>
                    <span class="nav-text">Private Clients</span>
                </a>
                <a href="#" class="nav-item" data-view="daily-summaries">
                    <span class="nav-icon"><i class="fas fa-chart-line"></i></span>
                    <span class="nav-text">Daily Summaries</span>
                </a>
                <a href="#" class="nav-item admin-only" data-view="reminders" style="display: none;">
                    <span class="nav-icon"><i class="fas fa-bell"></i></span>
                    <span class="nav-text">Reminder System</span>
                </a>
                <a href="#" class="nav-item admin-author" data-view="custom-messages" style="display: none;">
                    <span class="nav-icon"><i class="fas fa-envelope"></i></span>
                    <span class="nav-text">custom messages</span>
                </a>
                <a href="#" class="nav-item admin-only" data-view="users" style="display: none;">
                    <span class="nav-icon"><i class="fas fa-users"></i></span>
                    <span class="nav-text">Manage Users</span>
                </a>
                <a href="#" class="nav-item" data-view="settings">
                    <span class="nav-icon"><i class="fas fa-cog"></i></span>
                    <span class="nav-text">Settings</span>
                </a>
            </nav>
            <div class="sidebar-footer">
                <div class="user-profile">
                    <span id="sidebar-user-info"></span>
                </div>
                <!-- <button id="sidebar-logout-btn" class="btn btn-secondary btn-block">Logout</button> -->
            </div>
        </div>

        <!-- Sidebar Overlay -->
        <div id="sidebar-overlay" class="sidebar-overlay"></div>

        <!-- Top Navbar -->
        <nav class="topbar">
            <div class="topbar-left">
                <button id="menu-btn" class="btn-menu"><i class="fas fa-bars"></i></button>
                <div class="topbar-brand"><i class="fas fa-robot"></i> massak Bot</div>
            </div>
            <div class="topbar-right">
                <span id="user-info" class="user-badge"></span>
                <button id="logout-btn" class="btn btn-secondary btn-sm">Logout</button>
            </div>
        </nav>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Home View -->
            <div id="home-view" class="content-view active">
                <div class="page-header">
                    <h1>Dashboard</h1>
                    <p>Welcome to your massak Bot control panel</p>
                </div>
                <div class="card">
                    <div class="card-body">
                        <div
                            style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                            <div>
                                <p style="margin: 0; color: #666; font-size: 0.95rem;">
                                    Keep your groups list up-to-date. Click refresh if you've joined new groups.
                                </p>
                            </div>
                        </div>
                        <div style="display: flex; gap: 10px; align-items: center;">
                            <button id="refresh-groups-btn" class="btn btn-primary">
                                <i class="fas fa-sync-alt"></i> Refresh Groups
                            </button>
                            <span id="groups-last-update" style="color: #999; font-size: 0.85rem;"></span>
                        </div>
                        <div id="refresh-groups-message" class="info-message" style="display:none; margin-top: 10px;">
                        </div>
                    </div>
                </div>
                <!-- Main Statistics -->
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);"><i
                                class="fas fa-chart-bar"></i></div>
                        <div class="stat-info">
                            <div class="stat-label">Total Ads</div>
                            <div class="stat-value" id="stat-total-ads">0</div>
                            <div class="stat-sublabel" id="stat-new-ads">0 new</div>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);"><i
                                class="fas fa-check-circle"></i></div>
                        <div class="stat-info">
                            <div class="stat-label">Accepted</div>
                            <div class="stat-value" id="stat-accepted">0</div>
                            <div class="stat-sublabel" id="stat-acceptance-rate">0% rate</div>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon" style="background: linear-gradient(135deg, #30cfd0 0%, #330867 100%);"><i
                                class="fas fa-layer-group"></i></div>
                        <div class="stat-info">
                            <div class="stat-label">Categories</div>
                            <div class="stat-value" id="stat-categories">0</div>
                            <div class="stat-sublabel" id="stat-top-category">None</div>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h2><i class="fas fa-signal"></i> Connection Status</h2>
                    </div>
                    <div class="card-body">
                        <div class="status-indicator">
                            <span id="status-badge" class="badge badge-disconnected">Disconnected</span>
                            <button id="refresh-status-btn" class="btn btn-small">Refresh</button>
                        </div>

                        <!-- Queue Statistics -->
                        <div id="queue-stats" style="margin-top: 15px; display: none;">
                            <h3 style="font-size: 14px; margin-bottom: 10px;">ğŸ“Š Message Queue Status</h3>
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; font-size: 13px;">
                                <div>
                                    <strong>In Queue:</strong>
                                    <span id="queue-current" class="badge" style="margin-left: 5px;">0</span>
                                </div>
                                <div>
                                    <strong>Processing:</strong>
                                    <span id="queue-active" class="badge" style="margin-left: 5px;">0</span>
                                </div>
                                <div>
                                    <strong>Total Processed:</strong>
                                    <span id="queue-processed" style="color: #27ae60;">0</span>
                                </div>
                                <div>
                                    <strong>Total Failed:</strong>
                                    <span id="queue-failed" style="color: #e74c3c;">0</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Analytics Charts Row -->
                <div
                    style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-bottom: 20px;">
                    <!-- Property Types Chart -->
                    <div class="card">
                        <div class="card-header">
                            <h2><i class="fas fa-home"></i> Property Types Distribution</h2>
                        </div>
                        <div class="card-body">
                            <div id="property-types-chart" style="max-height: 300px; overflow-y: auto;">
                                <p style="text-align: center; color: #999;">Loading data...</p>
                            </div>
                        </div>
                    </div>

                    <!-- Top Groups Chart -->
                    <div class="card">
                        <div class="card-header">
                            <h2><i class="fas fa-users"></i> Top 5 Active Groups</h2>
                        </div>
                        <div class="card-body">
                            <div id="top-groups-chart" style="max-height: 300px; overflow-y: auto;">
                                <p style="text-align: center; color: #999;">Loading data...</p>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="qr-card" class="card" style="display: none;">
                    <div class="card-header">
                        <h2><i class="fas fa-qrcode"></i> Scan QR Code</h2>
                    </div>
                    <div class="card-body">
                        <div class="qr-container">
                            <div id="qr-loading" class="loading">Generating QR Code...</div>
                            <img id="qr-code" alt="QR Code" style="display: none;">
                            <p class="qr-instruction">Open WhatsApp on your phone and scan this QR code</p>
                        </div>
                    </div>
                </div>

                <div id="admin-controls" class="card" style="display: none;">
                    <div class="card-header">
                        <h2><i class="fas fa-cogs"></i> Admin Controls</h2>
                    </div>
                    <div class="card-body">
                        <button id="disconnect-btn" class="btn btn-danger">Disconnect Bot</button>
                        <div id="admin-message" class="info-message"></div>
                    </div>
                </div>
            </div>

            <!-- Post Preview / Edit Modal -->
            <!-- Ad Details Modal -->
            <div id="ad-details-modal" class="modal" style="display:none;">
                <div class="modal-content" style="max-width: 800px;">
                    <div class="modal-header">
                        <h2>ğŸ“‹ Ad Details</h2>
                        <span class="close" id="close-ad-details-modal">&times;</span>
                    </div>
                    <div class="modal-body">
                        <div id="ad-details-content" style="display:flex;flex-direction:column;gap:1rem;">
                            <!-- Dynamic content populated by JS -->
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button id="ad-details-groups-only" class="btn btn-success admin-only" style="display: none;">ğŸ“¤
                            Send to Groups Only</button>
                        <button id="ad-details-wp-only" class="btn btn-primary admin-only" style="display: none;">ğŸŒ
                            Post to WordPress Only</button>
                        <button id="ad-details-both" class="btn btn-warning">ğŸš€ Post & Send to Groups</button>
                        <button id="ad-details-cancel" class="btn btn-secondary">Cancel</button>
                    </div>
                </div>
            </div>

            <!-- Groups Preview Modal (for groups-only flow) -->
            <div id="groups-preview-modal" class="modal" style="display:none;">
                <div class="modal-content" style="max-width: 700px;">
                    <div class="modal-header">
                        <h2>ğŸ“± WhatsApp Message Preview</h2>
                        <span class="close" id="close-groups-preview-modal">&times;</span>
                    </div>
                    <div class="modal-body">
                        <div style="display:flex;flex-direction:column;gap:0.75rem;">
                            <label>ğŸ“ Message to send (with WhatsApp formatting)</label>
                            <textarea id="groups-preview-message" rows="12" class="form-control"
                                style="font-family: monospace; white-space: pre-wrap;"></textarea>
                            <small style="color: #666;">You can use *bold*, _italic_, ~strikethrough~ and emojis
                                ğŸ“±âœ¨</small>
                            <small style="color: #1b5e20; background: #e8f5e9; padding: 8px 10px; border-radius: 6px; border-left: 4px solid #25d366;">
                                <i class="fab fa-whatsapp"></i> Safer option: use <strong>Open in WhatsApp</strong>,
                                then choose the group/contact in WhatsApp and send manually.
                            </small>

                            <div id="groups-selection-area">
                                <div
                                    style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                                    <label style="font-weight: bold; font-size: 1.1em;">Select Collections &
                                        Groups:</label>
                                    <div style="display: flex; gap: 10px;" class="admin-only">
                                        <button type="button" id="refresh-groups-modal-btn"
                                            class="btn btn-primary btn-sm">
                                            <i class="fas fa-sync-alt"></i> Refresh
                                        </button>
                                        <button type="button" id="manage-collections-modal-btn"
                                            class="btn btn-secondary btn-sm">
                                            <i class="fas fa-cog"></i> Manage Collections
                                        </button>
                                    </div>
                                </div>
                                <div style="margin-bottom: 10px; padding: 10px; background: #e3f2fd; border-radius: 4px; border-left: 4px solid #2196F3;"
                                    class="admin-only">
                                    <small style="color: #1565c0;">
                                        <i class="fas fa-info-circle"></i> <strong>Tip:</strong> Check a collection to
                                        select all its groups at once!
                                    </small>
                                </div>
                                <div
                                    style="margin-bottom: 10px; padding: 10px; background: #fff3cd; border-radius: 4px; border-left: 4px solid #ffc107;">
                                    <strong>â±ï¸ Sending Delay:</strong>
                                    <input type="number" id="send-delay" value="60" min="20" max="6000"
                                        style="width: 60px; margin: 0 5px;" /> seconds between messages
                                    <small style="display: block; color: #856404; margin-top: 5px;">
                                        <i class="fas fa-info-circle"></i> Delays help prevent WhatsApp from blocking
                                        your account
                                    </small>
                                </div>
                                <div id="groups-preview-list"
                                    style="max-height: 400px; overflow-y: auto; border: 1px solid #ddd; border-radius: 4px; padding: 10px;">
                                </div>

                                <!-- Custom Phone Numbers Section -->
                                <div
                                    style="margin-top: 15px; padding: 15px; background: #f0f8ff; border-radius: 8px; border: 2px solid #4CAF50;">
                                    <label
                                        style="font-weight: bold; font-size: 1.1em; color: #2c3e50; margin-bottom: 10px; display: block;">
                                        <i class="fas fa-phone" style="color: #4CAF50;"></i> Send to Custom Phone
                                        Numbers:
                                    </label>
                                    <div style="display:flex;gap:10px;align-items:stretch;margin-bottom:12px;">
                                        <div style="flex:1;">
                                            <input type="text" id="groups-preview-custom-number-name"
                                                placeholder="Name (e.g., Ahmed)" class="form-control"
                                                style="height: 45px; font-size: 1rem;">
                                        </div>
                                        <div style="flex:1;">
                                            <input type="text" id="groups-preview-custom-number-phone"
                                                placeholder="Phone (e.g., 966501234567)" class="form-control"
                                                style="height: 45px; font-size: 1rem;">
                                        </div>
                                        <button id="groups-preview-add-custom-number-btn" class="btn btn-success"
                                            style="height: 45px; min-width: 120px; font-size: 1rem; font-weight: bold;">
                                            <i class="fas fa-plus"></i> Add
                                        </button>
                                    </div>
                                    <div id="groups-preview-custom-numbers-list"
                                        style="margin-top: 10px; padding: 10px; background: white; border-radius: 6px; min-height: 60px; border: 1px solid #ddd;">
                                        <!-- Custom numbers will be rendered here -->
                                    </div>
                                </div>

                                <!-- Private Clients Section -->
                                <div
                                    style="margin-top: 15px; padding: 15px; background: linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 100%); border-radius: 8px; border: 2px solid #66bb6a;">
                                    <div style="display: flex; justify-content: space-between; align-items: center; cursor: pointer;"
                                        onclick="togglePrivateClientsSection()">
                                        <label
                                            style="font-weight: bold; font-size: 1.1em; color: #2e7d32; margin-bottom: 0; cursor: pointer;">
                                            <i class="fas fa-user-friends" style="color: #43a047;"></i> ğŸ“± Private
                                            Clients
                                            <span id="private-clients-preview-count"
                                                style="background: #43a047; color: white; padding: 2px 8px; border-radius: 12px; font-size: 12px; margin-left: 8px;">0</span>
                                        </label>
                                        <i class="fas fa-chevron-down" id="private-clients-toggle-icon"
                                            style="color: #43a047; transition: transform 0.3s;"></i>
                                    </div>
                                    <div id="private-clients-preview-container"
                                        style="display: none; margin-top: 12px;">
                                        <div id="private-clients-preview-list"
                                            style="max-height: 250px; overflow-y: auto; background: white; border-radius: 6px; padding: 10px; border: 1px solid #a5d6a7;">
                                            <p style="text-align: center; color: #666; padding: 15px;">â³ Loading
                                                clients...</p>
                                        </div>
                                    </div>
                                </div>

                                <!-- Interest Groups Section -->
                                <div
                                    style="margin-top: 15px; padding: 15px; background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%); border-radius: 8px; border: 2px solid #42a5f5;">
                                    <div style="display: flex; justify-content: space-between; align-items: center; cursor: pointer;"
                                        onclick="toggleInterestGroupsPreviewSection()">
                                        <label
                                            style="font-weight: bold; font-size: 1.1em; color: #1565c0; margin-bottom: 0; cursor: pointer;">
                                            <i class="fas fa-users-cog" style="color: #1e88e5;"></i> ğŸ‘¥ Interest Groups
                                            <span id="interest-groups-preview-count"
                                                style="background: #1e88e5; color: white; padding: 2px 8px; border-radius: 12px; font-size: 12px; margin-left: 8px;">0</span>
                                        </label>
                                        <i class="fas fa-chevron-down" id="interest-groups-preview-toggle-icon"
                                            style="color: #1e88e5; transition: transform 0.3s;"></i>
                                    </div>
                                    <small style="color: #1976d2; display: block; margin-top: 6px;">
                                        <i class="fas fa-info-circle"></i> Selecting a group sends to ALL members in
                                        that group
                                    </small>
                                    <div id="interest-groups-preview-container"
                                        style="display: none; margin-top: 12px;">
                                        <div id="interest-groups-preview-list"
                                            style="max-height: 250px; overflow-y: auto; background: white; border-radius: 6px; padding: 10px; border: 1px solid #90caf9;">
                                            <p style="text-align: center; color: #666; padding: 15px;">â³ Loading
                                                groups...</p>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Schedule Message Section -->
                            <div id="schedule-message-section"
                                style="margin-top: 15px; padding: 15px; background: linear-gradient(135deg, #fff3e0 0%, #ffe0b2 100%); border-radius: 8px; border: 2px solid #ff9800;">
                                <div style="display: flex; justify-content: space-between; align-items: center;">
                                    <label
                                        style="font-weight: bold; font-size: 1.1em; color: #e65100; margin-bottom: 0; display: flex; align-items: center; gap: 8px;">
                                        <i class="fas fa-calendar-alt" style="color: #ff9800;"></i>
                                        ğŸ“… Schedule for Later
                                    </label>
                                    <label class="switch"
                                        style="position: relative; display: inline-block; width: 50px; height: 26px;">
                                        <input type="checkbox" id="schedule-toggle" onchange="toggleScheduleOptions()">
                                        <span class="slider round"
                                            style="position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #ccc; transition: .4s; border-radius: 26px;"></span>
                                    </label>
                                </div>
                                <small style="color: #e65100; display: block; margin-top: 6px;">
                                    <i class="fas fa-info-circle"></i> Toggle to schedule this message for a specific
                                    date and time instead of sending now
                                </small>
                                <div id="schedule-options-container" style="display: none; margin-top: 15px;">
                                    <div style="display: flex; gap: 15px; flex-wrap: wrap; align-items: flex-end;">
                                        <div style="flex: 1; min-width: 200px;">
                                            <label
                                                style="font-weight: 600; color: #e65100; display: block; margin-bottom: 5px;">
                                                <i class="fas fa-calendar"></i> Date & Time (KSA)
                                            </label>
                                            <input type="datetime-local" id="schedule-datetime" class="form-control"
                                                style="height: 45px; font-size: 1rem; border: 2px solid #ff9800; border-radius: 8px;">
                                        </div>
                                    </div>
                                    <div
                                        style="margin-top: 10px; padding: 10px; background: #fff8e1; border-radius: 6px; border-left: 4px solid #ff9800;">
                                        <small style="color: #f57c00;">
                                            <i class="fas fa-clock"></i> <strong>Note:</strong> The message will be sent
                                            automatically at the scheduled time.
                                            You will receive a WhatsApp notification when it's sent.
                                        </small>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer" style="display: flex; gap: 10px; flex-wrap: wrap;">
                        <button id="groups-preview-open-whatsapp" class="btn btn-success"
                            style="flex: 1; min-width: 180px; background: #25D366; border-color: #25D366;">
                            <i class="fab fa-whatsapp"></i> Open in WhatsApp
                        </button>
                        <button id="groups-preview-send" class="btn btn-success" style="flex: 1; min-width: 150px;">
                            <i class="fas fa-paper-plane"></i> Send Now
                        </button>
                        <button id="groups-preview-schedule" class="btn btn-warning"
                            style="flex: 1; min-width: 150px; display: none;">
                            <i class="fas fa-calendar-check"></i> Schedule Message
                        </button>
                        <button id="groups-preview-cancel" class="btn btn-secondary">Cancel</button>
                    </div>
                </div>
            </div>

            <!-- WordPress Preview Modal (for wp-only and both flows) -->
            <div id="wp-preview-modal" class="modal" style="display:none;">
                <div class="modal-content" style="max-width: 800px;">
                    <div class="modal-header">
                        <h2>ğŸŒ WordPress Post Preview</h2>
                        <span class="close" id="close-wp-preview-modal">&times;</span>
                    </div>
                    <div class="modal-body" style="max-height: 70vh; overflow-y: auto;">
                        <div style="display:flex;flex-direction:column;gap:0.75rem;">
                            <h3 style="color: #2196F3; border-bottom: 2px solid #2196F3; padding-bottom: 0.5rem;">ğŸ“
                                Basic Info</h3>

                            <div
                                style="background: #e3f2fd; padding: 10px; border-radius: 4px; border-left: 4px solid #2196F3;">
                                <label style="font-weight: bold; margin-bottom: 5px;">ğŸŒ Target Website</label>
                                <select id="wp-preview-target-website" class="form-control" style="background: white;">
                                    <option value="masaak">Ù…Ø³Ø¹Ø§Ùƒ (Masaak) - Real Estate</option>
                                    <option value="hasak">Ø­Ø³Ø§Ùƒ (Hasak) - Events & Marketplace</option>
                                </select>
                                <small style="color: #1565c0; display: block; margin-top: 5px;">
                                    <i class="fas fa-info-circle"></i> Choose where this ad should be posted
                                </small>
                            </div>

                            <label>WordPress Title</label>
                            <input id="wp-preview-title" class="form-control" />

                            <label>WordPress Content (HTML)</label>
                            <textarea id="wp-preview-content" rows="4" class="form-control"></textarea>

                            <h3
                                style="color: #4CAF50; border-bottom: 2px solid #4CAF50; padding-bottom: 0.5rem; margin-top: 1rem;">
                                ğŸ’° Price & Space</h3>

                            <div style="display:grid; grid-template-columns:1fr 1fr; gap:0.5rem;">
                                <div>
                                    <label>Ø§Ù„Ø³Ø¹Ø± (price - Ù†Øµ ÙƒØ§Ù…Ù„)</label>
                                    <input id="wp-preview-price" class="form-control" placeholder="Ù…Ø«Ø§Ù„: 500000 Ø±ÙŠØ§Ù„" />
                                </div>
                                <div>
                                    <label>price_amount (Ø±Ù‚Ù… ÙÙ‚Ø·)</label>
                                    <input id="wp-preview-price-amount" class="form-control" placeholder="500000" />
                                </div>
                            </div>

                            <div style="display:grid; grid-template-columns:1fr 1fr; gap:0.5rem;">
                                <div>
                                    <label>price_method (Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø³Ø¹Ø±)</label>
                                    <input id="wp-preview-price-method" class="form-control"
                                        placeholder="ØµØ§ÙÙŠ Ø§Ù„Ø³Ø¹Ø± / Ø¹Ù„Ù‰ Ø§Ù„Ø³ÙˆÙ…" />
                                </div>
                                <div>
                                    <label>arc_space (Ø§Ù„Ù…Ø³Ø§Ø­Ø© - Ù…ØªØ±)</label>
                                    <input id="wp-preview-arc-space" class="form-control" placeholder="600" />
                                </div>
                            </div>

                            <label>order_space (Ù…Ø³Ø§Ø­Ø© Ø§Ù„Ø·Ù„Ø¨ - Ø¥Ù† ÙˆØ¬Ø¯)</label>
                            <input id="wp-preview-order-space" class="form-control" />

                            <h3
                                style="color: #FF9800; border-bottom: 2px solid #FF9800; padding-bottom: 0.5rem; margin-top: 1rem;">
                                ğŸ“ Location Details</h3>

                            <label>location (Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„ÙƒØ§Ù…Ù„)</label>
                            <input id="wp-preview-location" class="form-control"
                                placeholder="Ø­ÙŠ Ø§Ù„Ø±Ø§Ø¨ÙŠØ© - Ø§Ù„Ù‡ÙÙˆÙ - Ø§Ù„Ø£Ø­Ø³Ø§Ø¡" />

                            <div style="display:grid; grid-template-columns:1fr 1fr 1fr; gap:0.5rem;">
                                <div>
                                    <label>before_City (Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø©)</label>
                                    <input id="wp-preview-before-city" class="form-control" placeholder="Ø§Ù„Ø£Ø­Ø³Ø§Ø¡" />
                                </div>
                                <div>
                                    <label>City (Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©)</label>
                                    <input id="wp-preview-city" class="form-control" placeholder="Ø§Ù„Ù‡ÙÙˆÙ / Ø§Ù„Ù…Ø¨Ø±Ø²" />
                                </div>
                                <div>
                                    <label>google_location (Ø±Ø§Ø¨Ø· Ø§Ù„Ø®Ø±ÙŠØ·Ø©)</label>
                                    <input id="wp-preview-google-location" class="form-control"
                                        placeholder="https://maps.google.com/..." />
                                </div>
                            </div>

                            <h3
                                style="color: #9C27B0; border-bottom: 2px solid #9C27B0; padding-bottom: 0.5rem; margin-top: 1rem;">
                                ğŸ·ï¸ Categories</h3>

                            <!-- Commercial Ad Checkbox -->
                            <div id="commercial-ad-toggle-container"
                                style="margin-bottom: 15px; padding: 12px; background: linear-gradient(135deg, #fff3cd 0%, #ffeeba 100%); border: 2px solid #f0ad4e; border-radius: 8px;">
                                <label
                                    style="display: flex; align-items: center; gap: 10px; cursor: pointer; font-weight: bold; color: #856404;">
                                    <input type="checkbox" id="wp-preview-is-commercial"
                                        onchange="toggleCommercialAdCategory()"
                                        style="width: 22px; height: 22px; cursor: pointer;">
                                    <span>
                                        ğŸ’° Ø¥Ø¹Ù„Ø§Ù† ØªØ¬Ø§Ø±ÙŠ Ø±Ø¨Ø­ÙŠ Ù…Ù…ÙŠØ²
                                        <small
                                            style="font-weight: normal; display: block; margin-top: 3px; color: #856404;">
                                            Ø¹Ù†Ø¯ Ø§Ù„ØªÙØ¹ÙŠÙ„ØŒ Ø³ÙŠØªÙ… ØªØºÙŠÙŠØ± Ø§Ù„ØªØµÙ†ÙŠÙ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ø¥Ù„Ù‰ "Ø¥Ø¹Ù„Ø§Ù† ØªØ¬Ø§Ø±ÙŠ Ù…Ù…ÙŠØ²"
                                        </small>
                                    </span>
                                </label>
                            </div>

                            <div id="category-selectors-container"
                                style="display:grid; grid-template-columns:1fr 1fr; gap:0.5rem;">
                                <div>
                                    <label>parent_catt (ÙØ¦Ø© Ø±Ø¦ÙŠØ³ÙŠØ©) *</label>
                                    <select id="wp-preview-parent-catt" class="form-control"
                                        onchange="updateWpSubcategories()">
                                        <option value="">Ø§Ø®ØªØ± Ù†ÙˆØ¹ Ø§Ù„Ø¹Ù‚Ø§Ø±</option>
                                        <optgroup label="ğŸ“¢ Ø¥Ø¹Ù„Ø§Ù†Ø§Øª Ù…Ù…ÙŠØ²Ø©">
                                            <option value="Ø§Ø¹Ù„Ø§Ù†Ø§Øª Ù…Ø³Ø¹Ø§Ùƒ Ø§Ù„Ù…Ù…ÙŠØ²Ø©">ğŸ’° Ø§Ø¹Ù„Ø§Ù†Ø§Øª Ù…Ø³Ø¹Ø§Ùƒ Ø§Ù„Ù…Ù…ÙŠØ²Ø©</option>
                                            <option value="Ø¥Ø¹Ù„Ø§Ù† ØªØ¬Ø§Ø±ÙŠ Ø±Ø¨Ø­ÙŠ Ù…Ù…ÙŠØ²">ğŸ’° Ø¥Ø¹Ù„Ø§Ù† ØªØ¬Ø§Ø±ÙŠ Ø±Ø¨Ø­ÙŠ Ù…Ù…ÙŠØ² (Ø­Ø³Ø§Ùƒ)
                                            </option>
                                        </optgroup>
                                        <optgroup label="ğŸ  Ø§Ù„Ø¹Ù‚Ø§Ø±Ø§Øª">
                                            <option value="Ø£Ø±Ø¶">Ø£Ø±Ø¶</option>
                                            <option value="Ø¨ÙŠØª">Ø¨ÙŠØª</option>
                                            <option value="Ø¯Ø¨Ù„ÙƒØ³">Ø¯Ø¨Ù„ÙƒØ³</option>
                                            <option value="Ø´Ù‚Ø© Ø¯Ø¨Ù„ÙƒØ³ÙŠØ©">Ø´Ù‚Ø© Ø¯Ø¨Ù„ÙƒØ³ÙŠØ©</option>
                                            <option value="Ø´Ù‚Ø©">Ø´Ù‚Ø©</option>
                                            <option value="Ø¹Ù…Ø§Ø±Ø©">Ø¹Ù…Ø§Ø±Ø©</option>
                                            <option value="ÙÙŠÙ„Ø§">ÙÙŠÙ„Ø§</option>
                                            <option value="Ù…Ø­Ø·Ø© Ø¨Ù†Ø²ÙŠÙ†">Ù…Ø­Ø·Ø© Ø¨Ù†Ø²ÙŠÙ†</option>
                                            <option value="Ù…Ø­Ù„ ØªØ¬Ø§Ø±ÙŠ">Ù…Ø­Ù„ ØªØ¬Ø§Ø±ÙŠ</option>
                                            <option value="Ù…Ø²Ø±Ø¹Ø©">Ù…Ø²Ø±Ø¹Ø©</option>
                                            <option value="Ù…Ø³ØªÙˆØ¯Ø¹">Ù…Ø³ØªÙˆØ¯Ø¹</option>
                                            <option value="Ø´Ø§Ù„ÙŠØ©">Ø´Ø§Ù„ÙŠØ©</option>
                                            <option value="Ø§Ø³ØªØ±Ø§Ø­Ø©">Ø§Ø³ØªØ±Ø§Ø­Ø©</option>
                                            <option value=" Ù„Ù„Ø¥ÙŠØ¬Ø§Ø±"> Ù„Ù„Ø¥ÙŠØ¬Ø§Ø±</option>
                                        </optgroup>
                                    </select>
                                </div>
                                <div>
                                    <label>sub_catt (ÙØ¦Ø© ÙØ±Ø¹ÙŠØ©)</label>
                                    <select id="wp-preview-sub-catt" class="form-control">
                                        <option value="">Ø§Ø®ØªØ± Ù†ÙˆØ¹ Ø§Ù„Ø¹Ù‚Ø§Ø± Ø£ÙˆÙ„Ø§Ù‹</option>
                                    </select>
                                </div>
                            </div>

                            <!-- Hasak Categories Container (shown when hasak is selected) -->
                            <div id="hasak-category-container" style="display:none; margin-bottom: 0.5rem;">
                                <div style="display:grid; grid-template-columns:1fr 1fr; gap:0.5rem;">
                                    <div>
                                        <label>arc_category (ØªØµÙ†ÙŠÙ Ø­Ø³Ø§Ùƒ) *</label>
                                        <select id="wp-preview-hasak-category" class="form-control"
                                            onchange="updateHasakArcFields()">
                                            <option value="">Ø§Ø®ØªØ± Ø§Ù„ØªØµÙ†ÙŠÙ</option>
                                            <option value="Ø£Ø³Ø± Ù…Ù†ØªØ¬Ø©" data-id="10">ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ Ø£Ø³Ø± Ù…Ù†ØªØ¬Ø©</option>
                                            <option value="Ø¥Ø¹Ù„Ø§Ù† ØªØ¬Ø§Ø±ÙŠ Ø±Ø¨Ø­ÙŠ Ù…Ù…ÙŠØ²" data-id="24">ğŸ’° Ø¥Ø¹Ù„Ø§Ù† ØªØ¬Ø§Ø±ÙŠ Ø±Ø¨Ø­ÙŠ Ù…Ù…ÙŠØ²
                                            </option>
                                            <option value="Ø§Ù„ÙØ¹Ø§Ù„ÙŠØ§Øª ÙˆØ§Ù„Ø§Ù†Ø´Ø·Ø©" data-id="19">ğŸ‰ Ø§Ù„ÙØ¹Ø§Ù„ÙŠØ§Øª ÙˆØ§Ù„Ø§Ù†Ø´Ø·Ø©
                                            </option>
                                            <option value="Ø¨Ø±Ø§Ù…Ø¬ ÙˆÙˆØ¸Ø§Ø¦Ù" data-id="30">ğŸ’¼ Ø¨Ø±Ø§Ù…Ø¬ ÙˆÙˆØ¸Ø§Ø¦Ù</option>
                                            <option value="ØªÙˆØµÙŠÙ„ Ø³ÙŠØ§Ø±Ø§Øª" data-id="25">ğŸš— ØªÙˆØµÙŠÙ„ Ø³ÙŠØ§Ø±Ø§Øª</option>
                                            <option value="Ø­Ø±Ø§Ø¬ Ø§Ù„Ø­Ø³Ø§" data-id="18">ğŸ›’ Ø­Ø±Ø§Ø¬ Ø§Ù„Ø­Ø³Ø§</option>
                                            <option value="ÙØ¹Ø§Ù„ÙŠØ© Ù…Ø¬Ø§Ù†ÙŠØ© Ù…Ù…ÙŠØ²Ø©" data-id="17">ğŸ ÙØ¹Ø§Ù„ÙŠØ© Ù…Ø¬Ø§Ù†ÙŠØ© Ù…Ù…ÙŠØ²Ø©
                                            </option>
                                            <option value="ÙƒÙˆÙÙŠÙ‡Ø§Øª Ø£Ùˆ Ù…Ø·Ø§Ø¹Ù…" data-id="21">â˜• ÙƒÙˆÙÙŠÙ‡Ø§Øª Ø£Ùˆ Ù…Ø·Ø§Ø¹Ù…</option>
                                            <option value="Ù…Ø­Ù„Ø§Øª ØªØ¬Ø§Ø±ÙŠØ©" data-id="23">ğŸª Ù…Ø­Ù„Ø§Øª ØªØ¬Ø§Ø±ÙŠØ©</option>
                                            <option value="Ù…Ø±ÙƒØ² ØªØ±ÙÙŠÙ‡ÙŠ" data-id="20">ğŸ¢ Ù…Ø±ÙƒØ² ØªØ±ÙÙŠÙ‡ÙŠ</option>
                                            <option value="Ù…Ù†ØªØ¬Ø¹Ø§Øª ÙˆØ¥Ø³ØªØ±Ø§Ø­Ø§Øª" data-id="22">ğŸ–ï¸ Ù…Ù†ØªØ¬Ø¹Ø§Øª ÙˆØ¥Ø³ØªØ±Ø§Ø­Ø§Øª
                                            </option>
                                        </select>
                                        <small style="color: #1565c0; font-size: 0.75rem;">Ø§Ø®ØªØ± ØªØµÙ†ÙŠÙ Ø­Ø³Ø§Ùƒ
                                            Ø§Ù„Ù…Ù†Ø§Ø³Ø¨</small>
                                    </div>
                                    <div>
                                        <label>arc_subcategory (ØªØµÙ†ÙŠÙ ÙØ±Ø¹ÙŠ)</label>
                                        <input id="wp-preview-hasak-subcategory" class="form-control"
                                            placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„ØªØµÙ†ÙŠÙ Ø§Ù„ÙØ±Ø¹ÙŠ" />
                                        <small style="color: #666; font-size: 0.75rem;">Ø§Ø®ØªÙŠØ§Ø±ÙŠ - Ø§Ù„ØªØµÙ†ÙŠÙ Ø§Ù„ÙØ±Ø¹ÙŠ</small>
                                    </div>
                                </div>
                            </div>

                            <!-- Masaak Categories Container (shown when masaak is selected) -->
                            <div id="masaak-category-container"
                                style="display:grid; grid-template-columns:1fr 1fr; gap:0.5rem;">
                                <div>
                                    <label>arc_category (ØªØµÙ†ÙŠÙ Ø§Ù„Ø¹Ù‚Ø§Ø±)</label>
                                    <input id="wp-preview-arc-category" class="form-control"
                                        style="background: #f0f0f0;" />
                                    <small style="color: #666; font-size: 0.75rem;">ÙŠÙÙ…Ù„Ø£ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ù…Ù†
                                        parent_catt</small>
                                </div>
                                <div>
                                    <label>arc_subcategory (ØªØµÙ†ÙŠÙ ÙØ±Ø¹ÙŠ)</label>
                                    <input id="wp-preview-arc-subcategory" class="form-control"
                                        style="background: #f0f0f0;" />
                                    <small style="color: #666; font-size: 0.75rem;">ÙŠÙÙ…Ù„Ø£ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ù…Ù† sub_catt</small>
                                </div>
                            </div>

                            <h3
                                style="color: #E91E63; border-bottom: 2px solid #E91E63; padding-bottom: 0.5rem; margin-top: 1rem;">
                                ğŸ“ Contact & Owner</h3>

                            <div style="display:grid; grid-template-columns:1fr 1fr; gap:0.5rem;">
                                <div>
                                    <label>owner_name (Ø§Ø³Ù… Ø§Ù„Ù…Ø§Ù„Ùƒ)</label>
                                    <input id="wp-preview-owner-name" class="form-control" />
                                </div>
                                <div>
                                    <label>phone_number (Ø±Ù‚Ù… Ø§Ù„ØªÙˆØ§ØµÙ„)</label>
                                    <input id="wp-preview-phone" class="form-control" />
                                </div>
                            </div>

                            <h3
                                style="color: #00BCD4; border-bottom: 2px solid #00BCD4; padding-bottom: 0.5rem; margin-top: 1rem;">
                                ğŸ”„ Order Details (Ø¥Ù† ÙƒØ§Ù† Ø·Ù„Ø¨)</h3>

                            <div style="display:grid; grid-template-columns:1fr 1fr 1fr; gap:0.5rem;">
                                <div>
                                    <label>order_status (Ø­Ø§Ù„Ø© Ø§Ù„Ø·Ù„Ø¨)</label>
                                    <input id="wp-preview-order-status" class="form-control"
                                        placeholder="Ù…ÙØªÙˆØ­ / Ù…ØºÙ„Ù‚" />
                                </div>
                                <div>
                                    <label>order_owner (ØµØ§Ø­Ø¨ Ø§Ù„Ø·Ù„Ø¨)</label>
                                    <input id="wp-preview-order-owner" class="form-control" />
                                </div>
                                <div>
                                    <label>order_type (Ù†ÙˆØ¹ Ø§Ù„Ø·Ù„Ø¨) *</label>
                                    <select id="wp-preview-order-type" class="form-control">
                                        <option value="">Ø§Ø®ØªØ± Ù†ÙˆØ¹ Ø§Ù„Ø·Ù„Ø¨</option>
                                        <option value="Ø¨ÙŠØ¹">Ø¨ÙŠØ¹</option>
                                        <option value="Ø§ÙŠØ¬Ø§Ø±">Ø§ÙŠØ¬Ø§Ø±</option>
                                        <option value="Ø§Ø³ØªØ«Ù…Ø§Ø±">Ø§Ø³ØªØ«Ù…Ø§Ø±</option>
                                        <option value="Ù„Ù„ØªÙ‚Ø¨ÙŠÙ„">Ù„Ù„ØªÙ‚Ø¨ÙŠÙ„</option>
                                        <option value="Ø§Ø¹Ù„Ø§Ù† ØªØ¬Ø§Ø±ÙŠ">Ø§Ø¹Ù„Ø§Ù† ØªØ¬Ø§Ø±ÙŠ</option>
                                    </select>
                                </div>
                            </div>

                            <h3
                                style="color: #8BC34A; border-bottom: 2px solid #8BC34A; padding-bottom: 0.5rem; margin-top: 1rem;">
                                ğŸ’¼ Offer Details (Ø¥Ù† ÙƒØ§Ù† Ø¹Ø±Ø¶)</h3>

                            <div style="display:grid; grid-template-columns:1fr 1fr 1fr; gap:0.5rem;">
                                <div>
                                    <label>offer_status (Ø­Ø§Ù„Ø© Ø§Ù„Ø¹Ø±Ø¶)</label>
                                    <input id="wp-preview-offer-status" class="form-control" />
                                </div>
                                <div>
                                    <label>offer_owner (ØµØ§Ø­Ø¨ Ø§Ù„Ø¹Ø±Ø¶)</label>
                                    <input id="wp-preview-offer-owner" class="form-control" />
                                </div>
                                <div>
                                    <label>offer_type (Ù†ÙˆØ¹ Ø§Ù„Ø¹Ø±Ø¶)</label>
                                    <input id="wp-preview-offer-type" class="form-control" />
                                </div>
                            </div>

                            <h3
                                style="color: #607D8B; border-bottom: 2px solid #607D8B; padding-bottom: 0.5rem; margin-top: 1rem;">
                                ğŸ¯ Additional Fields</h3>

                            <div style="display:grid; grid-template-columns:1fr 1fr; gap:0.5rem;">
                                <div>
                                    <label>main_ad (Ø§Ù„Ø¥Ø¹Ù„Ø§Ù† Ø§Ù„Ø£ØµÙ„ÙŠ)</label>
                                    <input id="wp-preview-main-ad" class="form-control" />
                                </div>
                                <div>
                                    <label>payment_method (Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¯ÙØ¹)</label>
                                    <input id="wp-preview-payment-method" class="form-control"
                                        placeholder="ÙƒØ§Ø´ / ØªÙ‚Ø³ÙŠØ· / Ø¨Ù†ÙƒÙŠ" />
                                </div>
                            </div>

                            <div style="display:grid; grid-template-columns:1fr 1fr; gap:0.5rem;">
                                <div>
                                    <label>youtube_link (Ø±Ø§Ø¨Ø· ÙŠÙˆØªÙŠÙˆØ¨)</label>
                                    <input id="wp-preview-youtube-link" class="form-control"
                                        placeholder="https://youtube.com/..." />
                                </div>
                                <div>
                                    <label>tags (Ø§Ù„ÙˆØ³ÙˆÙ…)</label>
                                    <input id="wp-preview-tags" class="form-control"
                                        placeholder="Ø¹Ù‚Ø§Ø±ØŒ Ù„Ù„Ø¨ÙŠØ¹ØŒ Ø§Ù„Ø£Ø­Ø³Ø§Ø¡" />
                                </div>
                            </div>

                            <h3
                                style="color: #F44336; border-bottom: 2px solid #F44336; padding-bottom: 0.5rem; margin-top: 1rem;">
                                ğŸš€ WordPress Output</h3>

                            <div id="wp-preview-link-section" style="display:none;">
                                <label>WordPress Link (will be sent to groups)</label>
                                <input id="wp-preview-link" class="form-control" readonly style="background:#f5f5f5;" />
                            </div>

                            <div id="wp-preview-message-section" style="display:none;">
                                <label>ğŸ“± WhatsApp Message (with link)</label>
                                <textarea id="wp-preview-message" rows="8" class="form-control"
                                    style="font-family: monospace; white-space: pre-wrap;"></textarea>

                                <div id="wp-groups-selection-area">
                                    <div
                                        style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                                        <label style="font-weight: bold; font-size: 1.1em;">Select Collections &
                                            Groups:</label>
                                        <div style="display: flex; gap: 10px;" class="admin-only">
                                            <button type="button" id="refresh-wp-groups-modal-btn"
                                                class="btn btn-primary btn-sm">
                                                <i class="fas fa-sync-alt"></i> Refresh
                                            </button>
                                        </div>
                                    </div>
                                    <div style="margin-bottom: 10px; padding: 10px; background: #e3f2fd; border-radius: 4px; border-left: 4px solid #2196F3;"
                                        class="admin-only">
                                        <small style="color: #1565c0;">
                                            <i class="fas fa-info-circle"></i> <strong>Tip:</strong> Check a collection
                                            to select all its groups at once!
                                        </small>
                                    </div>
                                    <div
                                        style="margin-bottom: 10px; padding: 10px; background: #fff3cd; border-radius: 4px; border-left: 4px solid #ffc107;">
                                        <strong>â±ï¸ Sending Delay:</strong>
                                        <input type="number" id="wp-send-delay" value="3" min="1" max="60"
                                            style="width: 60px; margin: 0 5px;" /> seconds between messages
                                        <small style="display: block; color: #856404; margin-top: 5px;">
                                            <i class="fas fa-info-circle"></i> Delays help prevent WhatsApp from
                                            blocking your account
                                        </small>
                                    </div>
                                    <div id="wp-groups-preview-list"
                                        style="max-height: 400px; overflow-y: auto; border: 1px solid #ddd; border-radius: 4px; padding: 10px;">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button id="wp-preview-post-only" class="btn btn-primary" style="display:none;">Post to
                            WordPress</button>
                        <button id="wp-preview-post-and-send" class="btn btn-warning" style="display:none;">Post & Send
                            to Groups</button>
                        <button id="wp-preview-cancel" class="btn btn-secondary">Cancel</button>
                    </div>
                </div>
            </div>

            <!-- WhatsApp Messages View -->
            <div id="whatsapp-messages-view" class="content-view">
                <div class="page-header">
                    <h1><i class="fas fa-comment-dots"></i> WhatsApp Messages</h1>
                    <p>Quick review and send WhatsApp messages to groups</p>
                </div>

                <div class="card">
                    <div class="card-body">
                        <!-- Search Bar -->
                        <div style="margin-bottom: 15px;">
                            <input type="text" id="whatsapp-search-input" class="form-control"
                                placeholder="ğŸ” Ø¨Ø­Ø« Ø°ÙƒÙŠ - Ø§Ø¨Ø­Ø« Ø¨Ø§Ù„ÙƒÙ„Ù…Ø§ØªØŒ Ø§Ù„ÙØ¦Ø©ØŒ Ø§Ù„Ù…ÙˆÙ‚Ø¹ØŒ Ø§Ù„Ø³Ø¹Ø±ØŒ Ø§Ù„Ù‡Ø§ØªÙ... (Smart Search)"
                                style="padding: 10px 15px; font-size: 1rem;" />
                        </div>

                        <div class="filter-bar"
                            style="display: flex; gap: 10px; flex-wrap: wrap; align-items: center; margin-bottom: 15px;">
                            <button id="refresh-whatsapp-messages-btn" class="btn btn-primary">
                                <span><i class="fas fa-sync-alt"></i></span> Refresh
                            </button>

                            <div style="flex: 1; display: flex; gap: 10px; flex-wrap: wrap;">
                                <select id="whatsapp-sort-by" class="form-control" style="max-width: 250px;">
                                    <optgroup label="ğŸ“… ÙˆÙ‚Øª Ø§Ù„Ù‚Ø¨ÙˆÙ„ (Accepted Time)">
                                        <option value="accepted-desc">âœ… Ø£Ø­Ø¯Ø« Ù‚Ø¨ÙˆÙ„Ø§Ù‹ (Newest Accepted)</option>
                                        <option value="accepted-asc">âœ… Ø£Ù‚Ø¯Ù… Ù‚Ø¨ÙˆÙ„Ø§Ù‹ (Oldest Accepted)</option>
                                    </optgroup>
                                    <optgroup label="â° ÙˆÙ‚Øª Ø§Ù„Ø¬Ù…Ø¹ (Collected Time)">
                                        <option value="time-desc">ğŸ“¥ Ø£Ø­Ø¯Ø« Ø¬Ù…Ø¹Ø§Ù‹ (Newest Collected)</option>
                                        <option value="time-asc">ğŸ“¥ Ø£Ù‚Ø¯Ù… Ø¬Ù…Ø¹Ø§Ù‹ (Oldest Collected)</option>
                                    </optgroup>
                                    <optgroup label="ğŸ¤– AI Confidence">
                                        <option value="confidence-desc">ğŸ¤– Ø§Ù„Ø£Ø¹Ù„Ù‰ Ø«Ù‚Ø© (High Confidence)</option>
                                        <option value="confidence-asc">ğŸ¤– Ø§Ù„Ø£Ù‚Ù„ Ø«Ù‚Ø© (Low Confidence)</option>
                                    </optgroup>
                                </select>

                                <select id="whatsapp-filter-status" class="form-control" style="max-width: 180px;">
                                    <option value="all">ğŸ“‹ All Status</option>
                                    <option value="pending">â³ Pending Only</option>
                                    <option value="sent">âœ… Sent Only</option>
                                </select>

                                <select id="whatsapp-filter-website" class="form-control" style="max-width: 180px;">
                                    <option value="all">ğŸŒ All Websites</option>
                                    <option value="masaak">ğŸ  Ù…Ø³Ø¹Ø§Ùƒ Only</option>
                                    <option value="hasak">ğŸ“… Ø­Ø³Ø§Ùƒ Only</option>
                                </select>

                                <select id="whatsapp-filter-category" class="form-control" style="max-width: 180px;">
                                    <option value="all">ğŸ“ All Categories</option>
                                </select>

                                <select id="whatsapp-filter-group" class="form-control" style="max-width: 200px;">
                                    <option value="all">ğŸ‘¥ All Groups</option>
                                    <!-- Dynamic options populated by JS -->
                                </select>

                                <div
                                    style="display: flex; align-items: center; gap: 5px; padding: 0 10px; background: #f0f0f0; border-radius: 4px; font-size: 0.9rem; white-space: nowrap;">
                                    <i class="fas fa-filter"></i>
                                    <span id="whatsapp-messages-count">0 messages</span>
                                </div>
                            </div>
                        </div>
                        <div id="whatsapp-messages-info" class="info-message" style="display:none;"></div>
                        <div id="whatsapp-messages-list"
                            style="display: grid; grid-template-columns: repeat(auto-fill, minmax(350px, 1fr)); gap: 15px; margin-top: 20px;">
                        </div>
                    </div>
                </div>
            </div>

            <!-- Ads View -->
            <div id="ads-view" class="content-view">
                <div class="page-header">
                    <h1>Manage Ads</h1>
                    <p>Review and organize your fetched advertisements</p>
                </div>

                <div class="card">
                    <div class="card-body">
                        <!-- Search Bar -->
                        <div style="margin-bottom: 15px;">
                            <input type="text" id="ads-search-input" class="form-control"
                                placeholder="ğŸ” Ø¨Ø­Ø« Ø°ÙƒÙŠ - Ø§Ø¨Ø­Ø« Ø¨Ø§Ù„Ø¹Ù†ÙˆØ§Ù†ØŒ Ø§Ù„ÙØ¦Ø©ØŒ Ø§Ù„Ù…ÙˆÙ‚Ø¹ØŒ Ø§Ù„Ø³Ø¹Ø±ØŒ Ø§Ù„Ù‡Ø§ØªÙ... (Smart Search)"
                                style="padding: 10px 15px; font-size: 1rem;" />
                        </div>

                        <div id="ads-controls" class="filter-bar"
                            style="display: flex; gap: 10px; flex-wrap: wrap; align-items: center;">
                            <select id="ads-filter" class="form-control" style="max-width: 150px;">
                                <option value="all">ğŸ“‹ All Status</option>
                                <option value="new">ğŸ†• New</option>
                                <option value="accepted">âœ… Accepted</option>
                                <option value="rejected">âŒ Rejected</option>
                                <option value="posted">ğŸ“¤ Posted</option>
                            </select>
                            <select id="category-filter" class="form-control" style="max-width: 150px;">
                                <option value="all">ğŸ“ All Categories</option>
                                <option value="uncategorized">â“ Uncategorized</option>
                            </select>
                            <select id="ads-website-filter" class="form-control" style="max-width: 150px;">
                                <option value="all">ğŸŒ All Websites</option>
                                <option value="masaak">ğŸ  Ù…Ø³Ø¹Ø§Ùƒ (Masaak)</option>
                                <option value="hasak">ğŸ“… Ø­Ø³Ø§Ùƒ (Hasak)</option>
                            </select>
                            <select id="ads-group-filter" class="form-control" style="max-width: 200px;">
                                <option value="all">ğŸ‘¥ All Groups</option>
                                <!-- Dynamic options populated by JS -->
                            </select>
                            <button id="refresh-ads-btn" class="btn btn-primary">
                                <span><i class="fas fa-sync-alt"></i></span> Refresh
                            </button>
                        </div>
                        <div id="ads-bulk-controls"
                            style="margin-top: 12px; padding: 12px; border: 1px solid #d9e2f2; border-radius: 10px; background: linear-gradient(135deg, #f7f9ff 0%, #eef3ff 100%); display: flex; gap: 10px; flex-wrap: wrap; align-items: center;">
                            <label
                                style="display:flex;align-items:center;gap:6px;font-weight:600;color:#2d3748;cursor:pointer;">
                                <input type="checkbox" id="ads-select-all-checkbox">
                                Select all in page
                            </label>
                            <span id="ads-selected-count"
                                style="font-weight:700;color:#2b6cb0;background:#e6f0ff;padding:4px 10px;border-radius:999px;">0
                                selected</span>

                            <label style="display:flex;align-items:center;gap:6px;color:#4a5568;">
                                Delay (sec)
                                <input type="number" id="ads-bulk-delay" class="form-control" min="0" max="60" step="1"
                                    value="2" style="width: 80px; padding: 6px;">
                            </label>

                            <label style="display:flex;align-items:center;gap:6px;color:#4a5568;">
                                Retries
                                <input type="number" id="ads-bulk-retries" class="form-control" min="0" max="5" step="1"
                                    value="2" style="width: 80px; padding: 6px;">
                            </label>

                            <button id="ads-bulk-post-wp-btn" class="btn btn-primary" disabled>
                                <i class="fas fa-globe"></i> Post Selected to WordPress
                            </button>
                            <button id="ads-bulk-recycle-btn" class="btn btn-danger" disabled>
                                <i class="fas fa-trash"></i> Send Selected to Recycle Bin
                            </button>
                            <button id="ads-bulk-clear-btn" class="btn btn-secondary" disabled>
                                <i class="fas fa-eraser"></i> Clear Selection
                            </button>
                        </div>
                        <div id="ads-bulk-status" class="info-message" style="display:none;margin-top:10px;"></div>
                        <div id="ads-info" class="info-message" style="display:none;"></div>
                        <div id="ads-list"></div>
                    </div>
                </div>
            </div>

            <!-- Collections View (Admin Only) -->
            <!-- <div id="collections-view" class="content-view admin-only" style="display: none;">
                <div class="page-header">
                    <h1>Group Collections</h1>
                    <p>Manage your saved group collections</p>
                </div>
                <div class="card">
                    <div class="card-body">
                        <button id="manage-collections-btn-view" class="btn btn-primary" style="margin-bottom: 20px;">
                            <span><i class="fas fa-folder"></i></span> Create New Collection
                        </button>
                        <div id="collections-view-list"></div>
                    </div>
                </div>
            </div> -->

            <!-- Categories View -->
            <div id="categories-view" class="content-view">
                <div class="page-header">
                    <h1>Manage Categories</h1>
                    <p>Create and organize ad categories</p>
                </div>
                <div class="card">
                    <div class="card-body">
                        <div class="form-group">
                            <label>Add New Category:</label>
                            <div class="category-form">
                                <input type="text" id="new-category-name-view" placeholder="Category name..."
                                    class="form-control">
                                <div style="display: flex; gap: 10px;">
                                    <input type="color" id="new-category-color-view" value="#9b59b6"
                                        class="color-input">
                                    <button id="add-category-btn-view" class="btn btn-primary" style="flex: 1;">
                                        <span><i class="fas fa-plus"></i></span> Add Category
                                    </button>
                                </div>
                            </div>
                        </div>
                        <div id="categories-view-list"></div>
                        <div id="categories-view-message" class="info-message" style="display:none;"></div>
                    </div>
                </div>
            </div>

            <!-- Users View (Admin Only) -->
            <div id="users-view" class="content-view">
                <div class="page-header">
                    <h1>Manage Users</h1>
                    <p>Add and manage system users</p>
                </div>
                <div class="card">
                    <div class="card-body">
                        <div class="form-group">
                            <label>Add New User:</label>
                            <div class="user-form">
                                <input type="text" id="new-user-username" placeholder="Username..."
                                    class="form-control">
                                <input type="password" id="new-user-password" placeholder="Password..."
                                    class="form-control">
                                <select id="new-user-role" class="form-control">
                                    <option value="author">Author</option>
                                    <option value="admin">Admin</option>
                                </select>
                                <button id="add-user-btn" class="btn btn-primary btn-block">
                                    <span><i class="fas fa-plus"></i></span> Add User
                                </button>
                            </div>
                        </div>
                        <div id="users-list"></div>
                        <div id="users-message" class="info-message" style="display:none;"></div>
                    </div>
                </div>
            </div>

            <!-- Reminders View (Admin Only) -->
            <div id="reminders-view" class="content-view">
                <div class="page-header">
                    <h1><i class="fas fa-bell"></i> Reminder System</h1>
                    <p>Manage scheduled reminders and notifications</p>
                </div>

                <!-- Stats Cards -->
                <div class="reminder-stats-grid"
                    style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px; margin-bottom: 20px;">
                    <div class="reminder-stat-card"
                        style="background: #fff; border-radius: 10px; padding: 15px; box-shadow: 0 2px 8px rgba(0,0,0,0.08); border-left: 4px solid #3498db;">
                        <div style="font-size: 0.85rem; color: #666;">Total</div>
                        <div id="reminder-stat-total" style="font-size: 1.8rem; font-weight: 700; color: #3498db;">0
                        </div>
                    </div>
                    <div class="reminder-stat-card"
                        style="background: #fff; border-radius: 10px; padding: 15px; box-shadow: 0 2px 8px rgba(0,0,0,0.08); border-left: 4px solid #f39c12;">
                        <div style="font-size: 0.85rem; color: #666;">Pending</div>
                        <div id="reminder-stat-pending" style="font-size: 1.8rem; font-weight: 700; color: #f39c12;">0
                        </div>
                    </div>
                    <div class="reminder-stat-card"
                        style="background: #fff; border-radius: 10px; padding: 15px; box-shadow: 0 2px 8px rgba(0,0,0,0.08); border-left: 4px solid #27ae60;">
                        <div style="font-size: 0.85rem; color: #666;">Sent</div>
                        <div id="reminder-stat-sent" style="font-size: 1.8rem; font-weight: 700; color: #27ae60;">0
                        </div>
                    </div>
                    <div class="reminder-stat-card"
                        style="background: #fff; border-radius: 10px; padding: 15px; box-shadow: 0 2px 8px rgba(0,0,0,0.08); border-left: 4px solid #e74c3c;">
                        <div style="font-size: 0.85rem; color: #666;">Failed</div>
                        <div id="reminder-stat-failed" style="font-size: 1.8rem; font-weight: 700; color: #e74c3c;">0
                        </div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-body">
                        <!-- Actions Bar -->
                        <div
                            style="display: flex; gap: 10px; flex-wrap: wrap; align-items: center; margin-bottom: 15px;">
                            <button id="create-reminder-btn" class="btn btn-primary">
                                <i class="fas fa-plus"></i> Create Reminder
                            </button>
                            <button id="refresh-reminders-btn" class="btn btn-secondary">
                                <i class="fas fa-sync-alt"></i> Refresh
                            </button>
                            <select id="reminder-filter-status" class="form-control" style="max-width: 150px;">
                                <option value="all">All Status</option>
                                <option value="pending">â³ Pending</option>
                                <option value="sent">âœ… Sent</option>
                                <option value="failed">âŒ Failed</option>
                            </select>
                            <input type="text" id="reminder-search-input" class="form-control"
                                placeholder="ğŸ” Search reminders..." style="max-width: 250px;">
                        </div>

                        <div id="reminders-message" class="info-message" style="display:none;"></div>

                        <!-- Reminders List -->
                        <div id="reminders-list"
                            style="display: grid; grid-template-columns: repeat(auto-fill, minmax(320px, 1fr)); gap: 15px;">
                            <!-- Reminder cards will be rendered here -->
                        </div>

                        <!-- Pagination -->
                        <div id="reminders-pagination"
                            style="display: flex; justify-content: center; gap: 10px; margin-top: 20px;">
                        </div>
                    </div>
                </div>
            </div>

            <!-- Create/Edit Reminder Modal -->
            <div id="reminder-modal" class="modal" style="display:none;">
                <div class="modal-content" style="max-width: 500px;">
                    <div class="modal-header">
                        <h3 id="reminder-modal-title"><i class="fas fa-bell"></i> Create Reminder</h3>
                        <button id="close-reminder-modal" class="btn-close">&times;</button>
                    </div>
                    <div class="modal-body">
                        <div class="form-group">
                            <label><i class="fas fa-phone"></i> Target Phone Number *</label>
                            <input type="text" id="reminder-target-number" class="form-control"
                                placeholder="e.g., 966508007053" required>
                            <small style="color: #666;">Enter without + prefix</small>
                        </div>
                        <div class="form-group">
                            <label><i class="fas fa-user"></i> Name (Optional)</label>
                            <input type="text" id="reminder-target-name" class="form-control"
                                placeholder="e.g., Ø£Ø­Ù…Ø¯ Ù…Ø­Ù…Ø¯">
                            <small style="color: #666;">Optional: Name of the person for easy identification</small>
                        </div>
                        <div class="form-group">
                            <label><i class="fas fa-calendar"></i> Scheduled Date & Time (KSA) *</label>
                            <input type="datetime-local" id="reminder-scheduled-datetime" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label><i class="fas fa-comment"></i> Reminder Message *</label>
                            <textarea id="reminder-message-text" class="form-control" rows="4"
                                placeholder="Enter the reminder message..." required></textarea>
                        </div>
                        <div id="reminder-modal-error" class="info-message error" style="display:none;"></div>
                    </div>
                    <div class="modal-footer">
                        <button id="save-reminder-btn" class="btn btn-primary">
                            <i class="fas fa-save"></i> Save Reminder
                        </button>
                        <button id="cancel-reminder-btn" class="btn btn-secondary">Cancel</button>
                    </div>
                </div>
            </div>

            <!-- Private Clients View -->
            <div id="private-clients-view" class="content-view">
                <div class="page-header">
                    <h1><i class="fas fa-user-friends"></i> Private Clients</h1>
                    <p>Manage clients from private conversations</p>
                </div>

                <!-- Statistics Cards -->
                <div class="stats-grid" style="margin-bottom: 24px;">
                    <div class="stat-card">
                        <div class="stat-icon" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                            <i class="fas fa-users"></i>
                        </div>
                        <div class="stat-info">
                            <div class="stat-label">Total Clients</div>
                            <div class="stat-value" id="pc-stat-total">0</div>
                            <div class="stat-sublabel" id="pc-stat-active">0 active today</div>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);">
                            <i class="fas fa-search"></i>
                        </div>
                        <div class="stat-info">
                            <div class="stat-label">Ø¨Ø§Ø­Ø«</div>
                            <div class="stat-value" id="pc-stat-searcher">0</div>
                            <div class="stat-sublabel">Property Seekers</div>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);">
                            <i class="fas fa-home"></i>
                        </div>
                        <div class="stat-info">
                            <div class="stat-label">Ù…Ø§Ù„Ùƒ</div>
                            <div class="stat-value" id="pc-stat-owner">0</div>
                            <div class="stat-sublabel">Property Owners</div>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon" style="background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);">
                            <i class="fas fa-chart-line"></i>
                        </div>
                        <div class="stat-info">
                            <div class="stat-label">Ù…Ø³ØªØ«Ù…Ø± & ÙˆØ³ÙŠØ·</div>
                            <div class="stat-value" id="pc-stat-others">0</div>
                            <div class="stat-sublabel">Investors & Brokers</div>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-body">
                        <!-- Filters and Search -->
                        <div class="actions-bar"
                            style="display:flex;flex-direction:column;gap:12px;margin-bottom:20px;">
                            <div style="display:flex;gap:8px;flex-wrap:wrap;align-items:center;">
                                <div style="position:relative;flex:1;min-width:220px;">
                                    <i class="fas fa-search"
                                        style="position:absolute;left:12px;top:50%;transform:translateY(-50%);color:#888;"></i>
                                    <input id="pc-search-input" type="text" class="form-control"
                                        placeholder="Search by name or phone number..." style="padding-left:36px;">
                                </div>
                                <select id="pc-role-filter" class="form-control" style="min-width:180px;">
                                    <option value="all">All Roles</option>
                                    <option value="Ø¨Ø§Ø­Ø«">Ø¨Ø§Ø­Ø« (Seeker)</option>
                                    <option value="Ù…Ø§Ù„Ùƒ">Ù…Ø§Ù„Ùƒ (Owner)</option>
                                    <option value="Ù…Ø³ØªØ«Ù…Ø±">Ù…Ø³ØªØ«Ù…Ø± (Investor)</option>
                                    <option value="ÙˆØ³ÙŠØ·">ÙˆØ³ÙŠØ· (Broker)</option>
                                </select>
                                <select id="pc-sort-select" class="form-control" style="min-width:180px;">
                                    <option value="recent">Most Recent</option>
                                    <option value="oldest">Oldest First</option>
                                    <option value="name">By Name (A-Z)</option>
                                </select>
                                <button id="pc-refresh-btn" class="btn btn-primary" title="Refresh clients">
                                    <i class="fas fa-sync-alt"></i> Refresh
                                </button>
                            </div>
                        </div>

                        <!-- Interest Groups Section -->
                        <div class="card"
                            style="margin-bottom: 20px; background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);">
                            <div class="card-header" style="cursor: pointer;" onclick="toggleInterestGroupsSection()">
                                <h3 style="margin: 0; display: flex; align-items: center; gap: 10px;">
                                    <i class="fas fa-users-cog" style="color: #667eea;"></i>
                                    Ù…Ø¬Ù…ÙˆØ¹Ø§Øª Ø§Ù„Ù…Ù‡ØªÙ…ÙŠÙ†
                                    <span id="interest-groups-count"
                                        style="background: #667eea; color: white; padding: 2px 8px; border-radius: 12px; font-size: 12px;">0</span>
                                    <i class="fas fa-chevron-down" id="interest-groups-toggle-icon"
                                        style="margin-right: auto; transition: transform 0.3s;"></i>
                                </h3>
                            </div>
                            <div id="interest-groups-container" style="display: none; padding: 15px;">
                                <div id="interest-groups-list" class="interest-groups-grid">
                                    <div class="loading"
                                        style="text-align: center; padding: 20px; grid-column: 1 / -1;">
                                        <i class="fas fa-spinner fa-spin" style="font-size: 24px; color: #667eea;"></i>
                                        <p style="margin-top: 8px; color: #666;">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</p>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Clients List -->
                        <div id="private-clients-list">
                            <div class="loading" style="text-align: center; padding: 40px;">
                                <i class="fas fa-spinner fa-spin" style="font-size: 32px; color: #667eea;"></i>
                                <p style="margin-top: 12px; color: #666;">Loading clients...</p>
                            </div>
                        </div>

                        <div id="pc-message" class="info-message" style="display:none;"></div>
                    </div>
                </div>
            </div>

            <!-- Client Details Modal -->
            <div id="client-details-modal" class="modal" style="display: none;">
                <div class="modal-content" style="max-width: 800px; max-height: 90vh; overflow-y: auto;">
                    <div class="modal-header">
                        <h2><i class="fas fa-user-circle"></i> Client Details</h2>
                        <button id="close-client-modal" class="btn-close-modal">âœ•</button>
                    </div>
                    <div class="modal-body" id="client-details-content">
                        <!-- Content will be populated by JavaScript -->
                    </div>
                </div>
            </div>

            <!-- Recycle Bin View -->
            <div id="recycle-bin-view" class="content-view">
                <div class="page-header">
                    <h1><i class="fas fa-trash-restore"></i> Recycle Bin</h1>
                    <p>Messages rejected by AI - automatically deleted after <span id="recycle-days-display"></span>
                        days</p>
                </div>
                <div class="card">
                    <div class="card-body">
                        <div class="actions-bar"
                            style="display:flex;flex-direction:column;gap:12px;margin-bottom:12px;">
                            <div style="display:flex;gap:8px;flex-wrap:wrap;align-items:center;">
                                <div style="position:relative;flex:1;min-width:220px;">
                                    <i class="fas fa-search"
                                        style="position:absolute;left:12px;top:50%;transform:translateY(-50%);color:#888;"></i>
                                    <input id="recycle-search-input" type="text" class="form-control"
                                        placeholder="Search text, reason, or group" style="padding-left:36px;">
                                </div>
                                <select id="recycle-group-filter" class="form-control" style="min-width:180px;">
                                    <option value="all">All Groups</option>
                                </select>
                                <select id="recycle-conf-filter" class="form-control" style="min-width:180px;">
                                    <option value="all">All Confidence</option>
                                    <option value="high">High (&ge; 80%)</option>
                                    <option value="medium">Medium (50-79%)</option>
                                    <option value="low">Low (&lt; 50%)</option>
                                </select>
                                <select id="recycle-sort-select" class="form-control" style="min-width:180px;">
                                    <option value="recent">Newest first</option>
                                    <option value="oldest">Oldest first</option>
                                    <option value="confidence-desc">Confidence high â†’ low</option>
                                    <option value="confidence-asc">Confidence low â†’ high</option>
                                </select>
                                <button id="recycle-compact-toggle" class="btn btn-secondary"
                                    title="Toggle compact view">
                                    <i class="fas fa-compress"></i>
                                </button>
                                <div style="flex:1"></div>
                                <button id="refresh-recycle-btn" class="btn btn-primary">
                                    <i class="fas fa-sync-alt"></i> Refresh
                                </button>
                                <button id="empty-recycle-btn" class="btn btn-danger admin-only" style="display: none;">
                                    <i class="fas fa-trash"></i> Empty Recycle Bin
                                </button>
                            </div>
                            <div style="display:flex;gap:8px;flex-wrap:wrap;align-items:center;">
                                <label style="display:flex;align-items:center;gap:8px;margin:0;">
                                    <input id="recycle-select-all" type="checkbox"> Select all
                                </label>
                                <button id="recycle-bulk-restore" class="btn btn-success btn-sm" disabled>
                                    <i class="fas fa-undo"></i> Restore selected
                                </button>
                                <button id="recycle-bulk-delete" class="btn btn-danger btn-sm" disabled>
                                    <i class="fas fa-trash"></i> Delete selected
                                </button>
                                <span id="recycle-selected-count" style="color:#666;">0 selected</span>
                            </div>
                        </div>
                        <div id="recycle-bin-list"></div>
                        <div id="recycle-bin-message" class="info-message" style="display:none;"></div>
                    </div>
                </div>
            </div>

            <!-- Daily Summaries View -->
            <div id="daily-summaries-view" class="content-view">
                <div class="page-header">
                    <h1><i class="fas fa-chart-line"></i> Daily Summaries</h1>
                    <p>View automated daily ad summaries</p>
                </div>


                <!-- Statistics Card -->
                <div class="card">
                    <div class="card-body">
                        <h3><i class="fas fa-chart-bar"></i> Statistics</h3>
                        <div
                            style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px; margin-top: 15px;">
                            <div class="stat-box-mini">
                                <div class="stat-label">Total Summaries</div>
                                <div class="stat-value" id="summary-total">0</div>
                            </div>
                            <div class="stat-box-mini">
                                <div class="stat-label">Today's Summaries</div>
                                <div class="stat-value" id="summary-today">0</div>
                            </div>
                            <div class="stat-box-mini">
                                <div class="stat-label">Today's Ads</div>
                                <div class="stat-value" id="summary-today-ads">0</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Smart Summary Builder Card -->
                <div class="card">
                    <div class="card-body">
                        <div style="display: flex; justify-content: space-between; align-items: center; cursor: pointer;"
                            onclick="toggleSmartSummaryBuilder()">
                            <h3 style="margin: 0;"><i class="fas fa-brain"></i> Smart Summary Builder</h3>
                            <i class="fas fa-chevron-down" id="smart-builder-toggle-icon"
                                style="transition: transform 0.3s;"></i>
                        </div>

                        <div id="smart-summary-builder" style="margin-top: 20px;">
                            <!-- Date Selection -->
                            <div class="smart-filter-section"
                                style="margin-bottom: 20px; padding: 15px; background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%); border-radius: 8px;">
                                <label style="font-weight: bold; color: #333; margin-bottom: 10px; display: block;">
                                    <i class="fas fa-calendar-alt" style="color: #667eea;"></i> Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„ÙØªØ±Ø© Ø§Ù„Ø²Ù…Ù†ÙŠØ©
                                </label>
                                <div id="date-presets"
                                    style="display: flex; flex-wrap: wrap; gap: 8px; margin-bottom: 10px;">
                                    <button type="button" class="date-preset-btn active" data-preset="today"
                                        onclick="selectDatePreset('today')">
                                        Ø§Ù„ÙŠÙˆÙ…
                                    </button>
                                    <button type="button" class="date-preset-btn" data-preset="yesterday"
                                        onclick="selectDatePreset('yesterday')">
                                        Ø£Ù…Ø³
                                    </button>
                                    <button type="button" class="date-preset-btn" data-preset="last7days"
                                        onclick="selectDatePreset('last7days')">
                                        Ø¢Ø®Ø± 7 Ø£ÙŠØ§Ù…
                                    </button>
                                    <button type="button" class="date-preset-btn" data-preset="last30days"
                                        onclick="selectDatePreset('last30days')">
                                        Ø¢Ø®Ø± 30 ÙŠÙˆÙ…
                                    </button>
                                    <button type="button" class="date-preset-btn" data-preset="custom"
                                        onclick="selectDatePreset('custom')">
                                        Ù…Ø®ØµØµ
                                    </button>
                                </div>
                                <div id="custom-date-range" style="display: none; margin-top: 10px;">
                                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                                        <div>
                                            <label style="font-size: 12px; color: #666;">Ù…Ù†:</label>
                                            <input type="date" id="smart-start-date" class="form-control"
                                                style="font-size: 14px;">
                                        </div>
                                        <div>
                                            <label style="font-size: 12px; color: #666;">Ø¥Ù„Ù‰:</label>
                                            <input type="date" id="smart-end-date" class="form-control"
                                                style="font-size: 14px;">
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Website Selection -->
                            <div class="smart-filter-section"
                                style="margin-bottom: 20px; padding: 15px; background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%); border-radius: 8px;">
                                <label style="font-weight: bold; color: #333; margin-bottom: 10px; display: block;">
                                    <i class="fas fa-globe" style="color: #667eea;"></i> Ø§Ù„Ù…ÙˆÙ‚Ø¹
                                </label>
                                <div id="website-chips" style="display: flex; gap: 10px;">
                                    <button type="button" class="chip-btn" data-website="" onclick="selectWebsite('')">
                                        ğŸ“Š Ø§Ù„ÙƒÙ„
                                    </button>
                                    <button type="button" class="chip-btn active" data-website="masaak"
                                        onclick="selectWebsite('masaak')">
                                        ğŸ”° Ù…Ø³Ø¹Ø§Ùƒ
                                    </button>
                                    <button type="button" class="chip-btn" data-website="hasak"
                                        onclick="selectWebsite('hasak')">
                                        ğŸŒ´ Ø­Ø³Ø§Ùƒ
                                    </button>
                                </div>
                            </div>

                            <!-- Main Categories -->
                            <div class="smart-filter-section"
                                style="margin-bottom: 20px; padding: 15px; background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%); border-radius: 8px;">
                                <label style="font-weight: bold; color: #333; margin-bottom: 10px; display: block;">
                                    <i class="fas fa-folder" style="color: #667eea;"></i> Ø§Ù„Ù†ÙˆØ¹ (Ø§Ù„ØªØµÙ†ÙŠÙ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ)
                                    <span id="selected-categories-count"
                                        style="font-size: 12px; color: #888; margin-right: 10px;"></span>
                                </label>
                                <div id="main-category-chips"
                                    style="display: flex; flex-wrap: wrap; gap: 8px; max-height: 200px; overflow-y: auto;">
                                    <!-- Categories will be loaded dynamically -->
                                    <span style="color: #999; font-size: 14px;"><i class="fas fa-spinner fa-spin"></i>
                                        Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</span>
                                </div>
                                <div style="margin-top: 8px;">
                                    <button type="button" class="btn btn-sm btn-secondary"
                                        onclick="selectAllCategories()">
                                        <i class="fas fa-check-double"></i> Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„ÙƒÙ„
                                    </button>
                                    <button type="button" class="btn btn-sm btn-secondary"
                                        onclick="clearAllCategories()">
                                        <i class="fas fa-times"></i> Ø¥Ù„ØºØ§Ø¡ Ø§Ù„ÙƒÙ„
                                    </button>
                                </div>
                            </div>

                            <!-- Subcategories (Dynamic) -->
                            <div id="subcategories-section" class="smart-filter-section"
                                style="margin-bottom: 20px; padding: 15px; background: linear-gradient(135deg, #fff3cd 0%, #ffeeba 100%); border-radius: 8px; display: none;">
                                <label style="font-weight: bold; color: #333; margin-bottom: 10px; display: block;">
                                    <i class="fas fa-folder-open" style="color: #f0ad4e;"></i> Ø§Ù„Ù†ÙˆØ¹ Ø§Ù„ÙØ±Ø¹ÙŠ
                                </label>
                                <div id="subcategory-chips" style="display: flex; flex-wrap: wrap; gap: 8px;">
                                    <!-- Subcategories will be loaded dynamically -->
                                </div>
                            </div>

                            <!-- Source Groups -->
                            <div class="smart-filter-section"
                                style="margin-bottom: 20px; padding: 15px; background: linear-gradient(135deg, #e8f4fd 0%, #d1e8fa 100%); border-radius: 8px;">
                                <label style="font-weight: bold; color: #333; margin-bottom: 10px; display: block;">
                                    <i class="fas fa-users" style="color: #667eea;"></i> Ø­Ø³Ø¨ Ù‚Ø±ÙˆØ¨ Ù…Ø¹ÙŠÙ† (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)
                                    <span id="selected-groups-count"
                                        style="font-size: 12px; color: #888; margin-right: 10px;"></span>
                                </label>
                                <input type="text" id="source-groups-search" class="form-control"
                                    placeholder="ğŸ” Ø§Ø¨Ø­Ø« Ø¹Ù† Ù…Ø¬Ù…ÙˆØ¹Ø©..." style="margin-bottom: 10px; font-size: 14px;"
                                    oninput="filterSourceGroups()">
                                <div id="source-groups-list"
                                    style="max-height: 200px; overflow-y: auto; background: white; border: 1px solid #ddd; border-radius: 8px; padding: 10px;">
                                    <span style="color: #999; font-size: 14px;"><i class="fas fa-spinner fa-spin"></i>
                                        Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø§Øª...</span>
                                </div>
                                <div style="margin-top: 8px; display: flex; gap: 8px;">
                                    <button type="button" class="btn btn-sm btn-secondary"
                                        onclick="selectAllSourceGroups()">
                                        <i class="fas fa-check-double"></i> Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„ÙƒÙ„
                                    </button>
                                    <button type="button" class="btn btn-sm btn-secondary"
                                        onclick="clearAllSourceGroups()">
                                        <i class="fas fa-times"></i> Ø¥Ù„ØºØ§Ø¡ Ø§Ù„ÙƒÙ„
                                    </button>
                                </div>
                                <!-- Hidden select to maintain compatibility -->
                                <select id="source-groups-filter" class="form-control" multiple style="display: none;">
                                </select>
                            </div>

                            <!-- Commercial Ads Toggle -->
                            <div class="smart-filter-section"
                                style="margin-bottom: 20px; padding: 15px; background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%); border-radius: 8px;">
                                <label
                                    style="font-weight: bold; color: #333; display: flex; align-items: center; gap: 10px; cursor: pointer;">
                                    <input type="checkbox" id="include-commercial" checked
                                        style="width: 18px; height: 18px;">
                                    <span><i class="fas fa-ad" style="color: #667eea;"></i> ØªØ¶Ù…ÙŠÙ† Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª
                                        Ø§Ù„ØªØ¬Ø§Ø±ÙŠØ©</span>
                                </label>
                            </div>

                            <!-- Preview & Actions -->
                            <div
                                style="display: flex; gap: 10px; flex-wrap: wrap; align-items: center; margin-top: 20px; padding-top: 15px; border-top: 2px solid #e0e0e0;">
                                <button id="preview-smart-summary-btn" class="btn btn-secondary"
                                    onclick="previewSmartSummary()">
                                    <i class="fas fa-eye"></i> Ù…Ø¹Ø§ÙŠÙ†Ø©
                                    <span id="preview-count"
                                        style="background: #667eea; color: white; padding: 2px 8px; border-radius: 10px; margin-right: 5px; display: none;">0</span>
                                </button>
                                <button id="generate-smart-summary-btn" class="btn btn-primary"
                                    onclick="generateSmartSummary()">
                                    <i class="fas fa-magic"></i> Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù…Ù„Ø®Øµ Ø§Ù„Ø°ÙƒÙŠ
                                </button>
                                <button id="refresh-summaries-btn" class="btn btn-secondary">
                                    <i class="fas fa-sync-alt"></i> ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©
                                </button>
                            </div>
                            <div id="smart-summary-message" class="info-message"
                                style="display:none; margin-top: 10px;"></div>
                        </div>
                    </div>
                </div>

                <!-- Legacy Quick Generate (Hidden) -->
                <div id="legacy-generate" style="display: none;">
                    <button id="trigger-summary-btn" class="btn btn-primary">
                        <i class="fas fa-play-circle"></i> Generate Summary Now
                    </button>
                    <select id="filter-website" class="form-control" style="display: none;">
                        <option value="">All Websites</option>
                    </select>
                    <select id="filter-category" class="form-control" style="display: none;">
                        <option value="">All Categories</option>
                    </select>
                    <div id="trigger-message" class="info-message" style="display:none;"></div>
                </div>

                <!-- Summaries List Card -->
                <div class="card">
                    <div class="card-header">
                        <h2><i class="fas fa-list"></i> Recent Summaries</h2>
                    </div>
                    <div class="card-body">
                        <div id="summaries-list">
                            <div style="text-align: center; padding: 30px; color: #999;">
                                <i class="fas fa-spinner fa-spin" style="font-size: 2rem;"></i>
                                <p style="margin-top: 10px;">Loading summaries...</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Custom Messages View (Admin Only) -->
            <div id="custom-messages-view" class="content-view">
                <div class="page-header"
                    style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 15px;">
                    <div>
                        <h1><i class="fas fa-envelope"></i> Ø±Ø³Ø§Ø¦Ù„</h1>
                        <p>Ø¥Ù†Ø´Ø§Ø¡ ÙˆØ¬Ø¯ÙˆÙ„Ø© Ø±Ø³Ø§Ø¦Ù„ WhatsApp Ù…Ø®ØµØµØ© Ù…Ø¹ Ø¯Ø¹Ù… Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ©</p>
                    </div>
                    <button id="create-custom-message-btn" class="btn btn-primary" style="font-size: 1rem;">
                        <i class="fas fa-plus"></i> Ø¥Ù†Ø´Ø§Ø¡ Ø±Ø³Ø§Ù„Ø© Ø¬Ø¯ÙŠØ¯Ø©
                    </button>
                </div>

                <!-- Tabs -->
                <div class="card" style="margin-bottom: 20px;">
                    <div style="display: flex; border-bottom: 2px solid #eee;">
                        <button class="custom-msg-tab active" data-tab="messages"
                            style="flex: 1; padding: 15px; border: none; background: none; cursor: pointer; font-size: 1rem; font-weight: bold; color: #333; border-bottom: 3px solid #667eea;">
                            ğŸ“ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„
                        </button>
                        <button class="custom-msg-tab" data-tab="schedules"
                            style="flex: 1; padding: 15px; border: none; background: none; cursor: pointer; font-size: 1rem; color: #666;">
                            ğŸ“… Ø§Ù„Ø¬Ø¯Ø§ÙˆÙ„
                        </button>
                    </div>
                </div>

                <!-- Messages Tab Content -->
                <div id="custom-messages-tab" class="custom-msg-tab-content active">
                    <div class="card">
                        <div class="card-header">
                            <h2>ğŸ“ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ù…Ø®ØµØµØ©</h2>
                        </div>
                        <div class="card-body">
                            <div id="custom-messages-toolbar"
                                style="display: flex; flex-direction: column; gap: 12px; margin-bottom: 15px;">
                                <div style="display: flex; align-items: center; flex-wrap: wrap; gap: 10px;">
                                    <span style="font-weight: 600; color: #555;">ğŸ·ï¸ Ø§Ù„ÙˆØ³ÙˆÙ…:</span>
                                    <div id="custom-msg-tag-filters" style="display: flex; flex-wrap: wrap; gap: 8px;">
                                    </div>
                                </div>
                                <div
                                    style="display: flex; align-items: center; flex-wrap: wrap; gap: 10px; justify-content: space-between;">
                                    <div style="display: flex; align-items: center; gap: 8px;">
                                        <label for="custom-msg-sort-select" style="font-weight: 600; color: #555;">ğŸ”€
                                            Ø§Ù„ØªØ±ØªÙŠØ¨:</label>
                                        <select id="custom-msg-sort-select" class="form-control"
                                            style="max-width: 200px;">
                                            <option value="newest">Ø§Ù„Ø£Ø­Ø¯Ø«</option>
                                            <option value="oldest">Ø§Ù„Ø£Ù‚Ø¯Ù…</option>
                                            <option value="name">Ø§Ù„Ø§Ø³Ù… (Ø£-ÙŠ)</option>
                                            <option value="tag">Ø§Ù„ÙˆØ³Ù… (Ø£-ÙŠ)</option>
                                        </select>
                                    </div>
                                    <button id="custom-msg-clear-filters" class="btn btn-secondary btn-sm"
                                        style="display: none;">
                                        Ù…Ø³Ø­ Ø§Ù„ØªØµÙÙŠØ©
                                    </button>
                                </div>
                                <div id="custom-msg-filter-summary" style="font-size: 0.85rem; color: #666;"></div>
                            </div>
                            <div id="custom-messages-list" style="display: grid; gap: 15px;">
                                <div style="text-align: center; padding: 40px; color: #999;">
                                    <i class="fas fa-envelope-open" style="font-size: 3rem; margin-bottom: 15px;"></i>
                                    <p>Ù„Ø§ ØªÙˆØ¬Ø¯ Ø±Ø³Ø§Ø¦Ù„ Ù…Ø®ØµØµØ© Ø¨Ø¹Ø¯</p>
                                    <p style="font-size: 0.9rem;">Ø§Ø¶ØºØ· "Ø¥Ù†Ø´Ø§Ø¡ Ø±Ø³Ø§Ù„Ø© Ø¬Ø¯ÙŠØ¯Ø©" Ù„Ù„Ø¨Ø¯Ø¡</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Schedules Tab Content -->
                <div id="custom-schedules-tab" class="custom-msg-tab-content" style="display: none;">
                    <div class="card">
                        <div class="card-header"
                            style="display: flex; justify-content: space-between; align-items: center;">
                            <h2>ğŸ“… Ø§Ù„Ø¬Ø¯Ø§ÙˆÙ„ Ø§Ù„Ù…Ø®ØµØµØ©</h2>
                            <button id="create-schedule-btn" class="btn btn-success btn-sm">
                                <i class="fas fa-plus"></i> Ø¥Ù†Ø´Ø§Ø¡ Ø¬Ø¯ÙˆÙ„ Ø¬Ø¯ÙŠØ¯
                            </button>
                        </div>
                        <div class="card-body">
                            <div id="custom-schedules-list" style="display: grid; gap: 15px;">
                                <div style="text-align: center; padding: 40px; color: #999;">
                                    <i class="fas fa-calendar-times" style="font-size: 3rem; margin-bottom: 15px;"></i>
                                    <p>Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¬Ø¯Ø§ÙˆÙ„ Ø¨Ø¹Ø¯</p>
                                    <p style="font-size: 0.9rem;">Ø£Ù†Ø´Ø¦ Ø±Ø³Ø§Ù„Ø© Ø£ÙˆÙ„Ø§Ù‹ Ø«Ù… Ø£Ø¶Ù Ø¬Ø¯ÙˆÙ„ Ù„Ù‡Ø§</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Create/Edit Custom Message Modal -->
            <div id="custom-message-modal" class="modal" style="display: none;">
                <div class="modal-content" style="max-width: 800px;">
                    <div class="modal-header"
                        style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white;">
                        <h2 id="custom-message-modal-title"><i class="fas fa-envelope"></i> Ø¥Ù†Ø´Ø§Ø¡ Ø±Ø³Ø§Ù„Ø© Ù…Ø®ØµØµØ©</h2>
                        <span class="close" id="close-custom-message-modal" style="color: white;">&times;</span>
                    </div>
                    <div class="modal-body" style="max-height: 70vh; overflow-y: auto;">
                        <div style="display: flex; flex-direction: column; gap: 20px;">
                            <!-- Message Name -->
                            <div>
                                <label style="font-weight: bold; margin-bottom: 8px; display: block;">
                                    ğŸ“Œ Ø§Ø³Ù… Ø§Ù„Ø±Ø³Ø§Ù„Ø©:
                                </label>
                                <input type="text" id="custom-msg-name" class="form-control"
                                    placeholder="Ù…Ø«Ø§Ù„: Ø±Ø³Ø§Ù„Ø© ØªØ±Ø­ÙŠØ¨ ÙŠÙˆÙ…ÙŠØ©" style="font-size: 1rem;">
                            </div>

                            <!-- Tags Section -->
                            <div
                                style="background: #f8fafc; padding: 18px; border-radius: 10px; border: 2px dashed #cbd5f5;">
                                <label style="font-weight: bold; margin-bottom: 10px; display: block;">
                                    ğŸ·ï¸ Ø§Ù„ÙˆØ³ÙˆÙ… (Tags):
                                </label>
                                <div id="custom-msg-tags-list"
                                    style="display: flex; flex-wrap: wrap; gap: 8px; margin-bottom: 10px;">
                                    <span style="color: #94a3b8; font-size: 0.9rem;">Ù„Ø§ ØªÙˆØ¬Ø¯ ÙˆØ³ÙˆÙ… Ø¨Ø¹Ø¯</span>
                                </div>
                                <div style="display: flex; gap: 8px; flex-wrap: wrap;">
                                    <input type="text" id="custom-msg-tag-input" class="form-control"
                                        placeholder="Ù…Ø«Ø§Ù„: ØªØ±Ø­ÙŠØ¨ØŒ Ù…ØªØ§Ø¨Ø¹Ø©ØŒ VIP" style="flex: 1; min-width: 200px;">
                                    <button type="button" id="custom-msg-add-tag-btn" class="btn btn-success btn-sm">
                                        <i class="fas fa-plus"></i> Ø¥Ø¶Ø§ÙØ©
                                    </button>
                                </div>
                                <div id="custom-msg-tags-suggestions" style="margin-top: 10px; display: none;"></div>
                                <small style="color: #64748b; display: block; margin-top: 8px;">
                                    ğŸ’¡ Ø§Ø³ØªØ®Ø¯Ù… Enter Ø£Ùˆ Ø§Ù„ÙØ§ØµÙ„Ø© Ù„Ø¥Ø¶Ø§ÙØ© Ø£ÙƒØ«Ø± Ù…Ù† ÙˆØ³Ù…
                                </small>
                            </div>

                            <!-- Image Upload Section -->
                            <div
                                style="background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%); padding: 20px; border-radius: 10px; border: 2px solid #42a5f5;">
                                <label style="font-weight: bold; margin-bottom: 15px; display: block; color: #1565c0;">
                                    ğŸ–¼ï¸ ØµÙˆØ±Ø© Ù…Ø±ÙÙ‚Ø© (Ø§Ø®ØªÙŠØ§Ø±ÙŠ):
                                </label>
                                <div id="custom-msg-image-preview-container"
                                    style="display: none; margin-bottom: 15px; text-align: center;">
                                    <img id="custom-msg-image-preview" src="" alt="Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„ØµÙˆØ±Ø©"
                                        style="max-width: 100%; max-height: 200px; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.15);">
                                    <p id="custom-msg-image-filename"
                                        style="margin-top: 8px; color: #666; font-size: 0.85rem;"></p>
                                </div>
                                <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                                    <label for="custom-msg-image-input" class="btn btn-primary"
                                        style="cursor: pointer; margin: 0;">
                                        <i class="fas fa-upload"></i> Ø§Ø®ØªØ± ØµÙˆØ±Ø©
                                    </label>
                                    <input type="file" id="custom-msg-image-input" accept="image/*"
                                        style="display: none;" onchange="previewCustomMessageImage(this)">
                                    <button type="button" id="custom-msg-remove-image-btn" class="btn btn-danger"
                                        style="display: none;" onclick="removeCustomMessageImage()">
                                        <i class="fas fa-trash"></i> Ø¥Ø²Ø§Ù„Ø© Ø§Ù„ØµÙˆØ±Ø©
                                    </button>
                                </div>
                                <small style="color: #1976d2; display: block; margin-top: 10px;">
                                    ğŸ’¡ Ø§Ù„ØµÙˆØ±Ø© Ø³ØªÙØ±Ø³Ù„ Ù…Ø¹ Ù†Øµ Ø§Ù„Ø±Ø³Ø§Ù„Ø© ÙƒØªØ¹Ù„ÙŠÙ‚. Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰: 10 Ù…ÙŠØ¬Ø§Ø¨Ø§ÙŠØª
                                </small>
                            </div>

                            <!-- Message Content -->
                            <div>
                                <label style="font-weight: bold; margin-bottom: 8px; display: block;">
                                    ğŸ“ Ù†Øµ Ø§Ù„Ø±Ø³Ø§Ù„Ø©:
                                </label>
                                <textarea id="custom-msg-content" class="form-control" rows="8"
                                    style="font-family: monospace; font-size: 0.95rem; direction: rtl;"
                                    placeholder="Ø§ÙƒØªØ¨ Ø±Ø³Ø§Ù„ØªÙƒ Ù‡Ù†Ø§...&#10;&#10;Ø§Ø³ØªØ®Ø¯Ù… {{greeting}} Ù„Ù„ØªØ­ÙŠØ© Ø§Ù„Ø¹Ø´ÙˆØ§Ø¦ÙŠØ©&#10;Ø§Ø³ØªØ®Ø¯Ù… {{name}} Ù„Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªÙ„Ù…"></textarea>
                                <small style="color: #666; display: block; margin-top: 5px;">
                                    ğŸ’¡ Ø§Ø³ØªØ®Ø¯Ù… *Ù†Øµ Ø¹Ø±ÙŠØ¶* Ùˆ _Ù…Ø§Ø¦Ù„_ Ù„Ù„ØªÙ†Ø³ÙŠÙ‚
                                </small>
                            </div>

                            <!-- Dynamic Words Section -->
                            <div
                                style="background: linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 100%); padding: 20px; border-radius: 10px; border: 2px solid #66bb6a;">
                                <label style="font-weight: bold; margin-bottom: 15px; display: block; color: #2e7d32;">
                                    ğŸ² Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ©:
                                </label>
                                <small style="color: #388e3c; display: block; margin-bottom: 15px;">
                                    Ø£Ø¶Ù ÙƒÙ„Ù…Ø§Øª Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ© ÙˆØ³ÙŠØ®ØªØ§Ø± Ø§Ù„Ù†Ø¸Ø§Ù… ÙˆØ§Ø­Ø¯Ø© Ø¹Ø´ÙˆØ§Ø¦ÙŠØ§Ù‹ Ø¹Ù†Ø¯ ÙƒÙ„ Ø¥Ø±Ø³Ø§Ù„
                                </small>

                                <div id="dynamic-words-container">
                                    <!-- Default greeting -->
                                    <div class="dynamic-word-group"
                                        style="background: white; padding: 15px; border-radius: 8px; margin-bottom: 10px;">
                                        <div
                                            style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                                            <label style="font-weight: bold; color: #1565c0;">{{greeting}}</label>
                                        </div>
                                        <div class="dynamic-word-options"
                                            style="display: flex; flex-wrap: wrap; gap: 8px;">
                                            <span class="dynamic-word-tag"
                                                style="background: #e3f2fd; padding: 6px 12px; border-radius: 20px; font-size: 0.9rem;">
                                                Ø§Ù„Ø³Ù„Ø§Ù… Ø¹Ù„ÙŠÙƒÙ… <button type="button" class="remove-word-btn"
                                                    style="border: none; background: none; color: #e53935; cursor: pointer; margin-left: 5px;">Ã—</button>
                                            </span>
                                            <span class="dynamic-word-tag"
                                                style="background: #e3f2fd; padding: 6px 12px; border-radius: 20px; font-size: 0.9rem;">
                                                Ù…Ø±Ø­Ø¨Ø§Ù‹ <button type="button" class="remove-word-btn"
                                                    style="border: none; background: none; color: #e53935; cursor: pointer; margin-left: 5px;">Ã—</button>
                                            </span>
                                            <span class="dynamic-word-tag"
                                                style="background: #e3f2fd; padding: 6px 12px; border-radius: 20px; font-size: 0.9rem;">
                                                Ø­ÙŠØ§Ùƒ Ø§Ù„Ù„Ù‡ <button type="button" class="remove-word-btn"
                                                    style="border: none; background: none; color: #e53935; cursor: pointer; margin-left: 5px;">Ã—</button>
                                            </span>
                                            <span class="dynamic-word-tag"
                                                style="background: #e3f2fd; padding: 6px 12px; border-radius: 20px; font-size: 0.9rem;">
                                                Ø£Ù‡Ù„Ø§Ù‹ ÙˆØ³Ù‡Ù„Ø§Ù‹ <button type="button" class="remove-word-btn"
                                                    style="border: none; background: none; color: #e53935; cursor: pointer; margin-left: 5px;">Ã—</button>
                                            </span>
                                        </div>
                                        <div style="display: flex; gap: 8px; margin-top: 10px;">
                                            <input type="text" class="form-control add-word-input"
                                                placeholder="Ø£Ø¶Ù ÙƒÙ„Ù…Ø© Ø¬Ø¯ÙŠØ¯Ø©..." style="flex: 1;">
                                            <button type="button" class="btn btn-success btn-sm add-word-btn">
                                                <i class="fas fa-plus"></i>
                                            </button>
                                        </div>
                                    </div>
                                </div>

                                <button type="button" id="add-dynamic-var-btn" class="btn btn-primary btn-sm"
                                    style="margin-top: 10px;">
                                    <i class="fas fa-plus"></i> Ø¥Ø¶Ø§ÙØ© Ù…ØªØºÙŠØ± Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠ Ø¬Ø¯ÙŠØ¯
                                </button>
                            </div>

                            <!-- Available Variables -->
                            <div style="background: #f5f5f5; padding: 15px; border-radius: 8px;">
                                <label style="font-weight: bold; margin-bottom: 10px; display: block;">
                                    ğŸ“‹ Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ù…ØªØ§Ø­Ø©:
                                </label>
                                <div style="display: flex; flex-wrap: wrap; gap: 8px;" id="available-variables-list">
                                    <span class="var-tag"
                                        style="background: #e0e0e0; padding: 5px 10px; border-radius: 4px; cursor: pointer; font-family: monospace;"
                                        data-var="name">{{name}} - Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªÙ„Ù…</span>
                                    <span class="var-tag"
                                        style="background: #e0e0e0; padding: 5px 10px; border-radius: 4px; cursor: pointer; font-family: monospace;"
                                        data-var="phone">{{phone}} - Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ</span>
                                    <span class="var-tag"
                                        style="background: #e0e0e0; padding: 5px 10px; border-radius: 4px; cursor: pointer; font-family: monospace;"
                                        data-var="role">{{role}} - Ø§Ù„Ø¯ÙˆØ±</span>
                                    <span class="var-tag"
                                        style="background: #e0e0e0; padding: 5px 10px; border-radius: 4px; cursor: pointer; font-family: monospace;"
                                        data-var="date">{{date}} - Ø§Ù„ØªØ§Ø±ÙŠØ®</span>
                                    <span class="var-tag"
                                        style="background: #e0e0e0; padding: 5px 10px; border-radius: 4px; cursor: pointer; font-family: monospace;"
                                        data-var="time">{{time}} - Ø§Ù„ÙˆÙ‚Øª</span>
                                    <span class="var-tag"
                                        style="background: #e0e0e0; padding: 5px 10px; border-radius: 4px; cursor: pointer; font-family: monospace;"
                                        data-var="day">{{day}} - Ø§Ù„ÙŠÙˆÙ…</span>
                                </div>
                                <small style="color: #666; margin-top: 8px; display: block;">
                                    ğŸ’¡ Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø£ÙŠ Ù…ØªØºÙŠØ± Ù„Ø¥Ø¶Ø§ÙØªÙ‡ Ù„Ù„Ø±Ø³Ø§Ù„Ø©
                                </small>
                            </div>

                            <!-- Preview Section -->
                            <div
                                style="background: linear-gradient(135deg, #fff3e0 0%, #ffe0b2 100%); padding: 20px; border-radius: 10px; border: 2px solid #ffb74d;">
                                <label style="font-weight: bold; margin-bottom: 10px; display: block; color: #e65100;">
                                    ğŸ‘ï¸ Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„Ø±Ø³Ø§Ù„Ø©:
                                </label>
                                <div id="custom-msg-preview"
                                    style="background: white; padding: 15px; border-radius: 8px; white-space: pre-wrap; font-family: inherit; min-height: 100px; direction: rtl; border-left: 4px solid #4caf50;">
                                    <span style="color: #999;">Ø§Ù„Ù…Ø¹Ø§ÙŠÙ†Ø© Ø³ØªØ¸Ù‡Ø± Ù‡Ù†Ø§...</span>
                                </div>
                                <button type="button" id="refresh-preview-btn" class="btn btn-warning btn-sm"
                                    style="margin-top: 10px;">
                                    <i class="fas fa-sync-alt"></i> ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ø¹Ø§ÙŠÙ†Ø©
                                </button>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button id="cancel-custom-message-btn" class="btn btn-secondary">Ø¥Ù„ØºØ§Ø¡</button>
                        <button id="save-custom-message-btn" class="btn btn-primary">
                            <i class="fas fa-save"></i> Ø­ÙØ¸ Ø§Ù„Ø±Ø³Ø§Ù„Ø©
                        </button>
                    </div>
                </div>
            </div>

            <!-- Create/Edit Schedule Modal -->
            <div id="schedule-modal" class="modal" style="display: none;">
                <div class="modal-content" style="max-width: 800px;">
                    <div class="modal-header"
                        style="background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%); color: white;">
                        <h2 id="schedule-modal-title"><i class="fas fa-calendar-alt"></i> Ø¥Ù†Ø´Ø§Ø¡ Ø¬Ø¯ÙˆÙ„ Ø¬Ø¯ÙŠØ¯</h2>
                        <span class="close" id="close-schedule-modal" style="color: white;">&times;</span>
                    </div>
                    <div class="modal-body" style="max-height: 70vh; overflow-y: auto;">
                        <div style="display: flex; flex-direction: column; gap: 20px;">
                            <!-- Select Message -->
                            <div>
                                <label style="font-weight: bold; margin-bottom: 8px; display: block;">
                                    ğŸ“ Ø§Ø®ØªØ± Ø§Ù„Ø±Ø³Ø§Ù„Ø©:
                                </label>
                                <select id="schedule-message-select" class="form-control" style="font-size: 1rem;">
                                    <option value="">-- Ø§Ø®ØªØ± Ø±Ø³Ø§Ù„Ø© --</option>
                                </select>
                            </div>

                            <!-- Schedule Name -->
                            <div>
                                <label style="font-weight: bold; margin-bottom: 8px; display: block;">
                                    ğŸ“Œ Ø§Ø³Ù… Ø§Ù„Ø¬Ø¯ÙˆÙ„:
                                </label>
                                <input type="text" id="schedule-name" class="form-control"
                                    placeholder="Ù…Ø«Ø§Ù„: Ø¥Ø±Ø³Ø§Ù„ ÙŠÙˆÙ…ÙŠ Ù„Ù„Ø¹Ù…Ù„Ø§Ø¡">
                            </div>

                            <!-- Repeat Type Selection -->
                            <div
                                style="background: linear-gradient(135deg, #f3e5f5 0%, #e1bee7 100%); padding: 20px; border-radius: 10px; border: 2px solid #ab47bc;">
                                <label style="font-weight: bold; margin-bottom: 15px; display: block; color: #7b1fa2;">
                                    ğŸ”„ Ù†ÙˆØ¹ Ø§Ù„ØªÙƒØ±Ø§Ø±:
                                </label>
                                <div style="display: flex; flex-wrap: wrap; gap: 10px;">
                                    <label
                                        style="display: flex; align-items: center; gap: 8px; cursor: pointer; padding: 10px 18px; background: white; border-radius: 25px; border: 2px solid transparent; transition: all 0.2s;"
                                        class="repeat-type-option">
                                        <input type="radio" name="schedule-repeat-type" value="once"
                                            onchange="toggleRepeatTypeUI()">
                                        <span style="font-weight: 500;">ğŸ¯ Ù…Ø±Ø© ÙˆØ§Ø­Ø¯Ø©</span>
                                    </label>
                                    <label
                                        style="display: flex; align-items: center; gap: 8px; cursor: pointer; padding: 10px 18px; background: white; border-radius: 25px; border: 2px solid transparent; transition: all 0.2s;"
                                        class="repeat-type-option">
                                        <input type="radio" name="schedule-repeat-type" value="daily" checked
                                            onchange="toggleRepeatTypeUI()">
                                        <span style="font-weight: 500;">ğŸ“… ÙŠÙˆÙ…ÙŠ</span>
                                    </label>
                                    <label
                                        style="display: flex; align-items: center; gap: 8px; cursor: pointer; padding: 10px 18px; background: white; border-radius: 25px; border: 2px solid transparent; transition: all 0.2s;"
                                        class="repeat-type-option">
                                        <input type="radio" name="schedule-repeat-type" value="weekly"
                                            onchange="toggleRepeatTypeUI()">
                                        <span style="font-weight: 500;">ğŸ“† Ø£Ø³Ø¨ÙˆØ¹ÙŠ</span>
                                    </label>
                                    <label
                                        style="display: flex; align-items: center; gap: 8px; cursor: pointer; padding: 10px 18px; background: white; border-radius: 25px; border: 2px solid transparent; transition: all 0.2s;"
                                        class="repeat-type-option">
                                        <input type="radio" name="schedule-repeat-type" value="monthly"
                                            onchange="toggleRepeatTypeUI()">
                                        <span style="font-weight: 500;">ğŸ—“ï¸ Ø´Ù‡Ø±ÙŠ</span>
                                    </label>
                                    <label
                                        style="display: flex; align-items: center; gap: 8px; cursor: pointer; padding: 10px 18px; background: white; border-radius: 25px; border: 2px solid transparent; transition: all 0.2s;"
                                        class="repeat-type-option">
                                        <input type="radio" name="schedule-repeat-type" value="yearly"
                                            onchange="toggleRepeatTypeUI()">
                                        <span style="font-weight: 500;">ğŸ‚ Ø³Ù†ÙˆÙŠ</span>
                                    </label>
                                </div>
                                <small id="repeat-type-description"
                                    style="color: #7b1fa2; margin-top: 10px; display: block; background: white; padding: 10px; border-radius: 6px; border-right: 3px solid #ab47bc;">
                                    ğŸ’¡ <strong>ÙŠÙˆÙ…ÙŠ:</strong> ÙŠØ±Ø³Ù„ ÙƒÙ„ ÙŠÙˆÙ… ÙÙŠ Ø§Ù„Ø£ÙŠØ§Ù… Ø§Ù„Ù…Ø®ØªØ§Ø±Ø© ÙˆÙŠØªÙƒØ±Ø± Ù„Ù„Ø£Ø¨Ø¯
                                </small>
                            </div>

                            <!-- Days Selection (for daily/weekly) -->
                            <div id="schedule-days-section"
                                style="background: #e3f2fd; padding: 20px; border-radius: 10px;">
                                <label style="font-weight: bold; margin-bottom: 15px; display: block; color: #1565c0;">
                                    ğŸ“… Ø£ÙŠØ§Ù… Ø§Ù„Ø¥Ø±Ø³Ø§Ù„:
                                </label>
                                <div style="display: flex; flex-wrap: wrap; gap: 10px;">
                                    <label
                                        style="display: flex; align-items: center; gap: 8px; cursor: pointer; padding: 8px 15px; background: white; border-radius: 20px;">
                                        <input type="checkbox" class="schedule-day" value="sunday" checked> Ø§Ù„Ø£Ø­Ø¯
                                    </label>
                                    <label
                                        style="display: flex; align-items: center; gap: 8px; cursor: pointer; padding: 8px 15px; background: white; border-radius: 20px;">
                                        <input type="checkbox" class="schedule-day" value="monday" checked> Ø§Ù„Ø¥Ø«Ù†ÙŠÙ†
                                    </label>
                                    <label
                                        style="display: flex; align-items: center; gap: 8px; cursor: pointer; padding: 8px 15px; background: white; border-radius: 20px;">
                                        <input type="checkbox" class="schedule-day" value="tuesday" checked> Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡
                                    </label>
                                    <label
                                        style="display: flex; align-items: center; gap: 8px; cursor: pointer; padding: 8px 15px; background: white; border-radius: 20px;">
                                        <input type="checkbox" class="schedule-day" value="wednesday" checked> Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡
                                    </label>
                                    <label
                                        style="display: flex; align-items: center; gap: 8px; cursor: pointer; padding: 8px 15px; background: white; border-radius: 20px;">
                                        <input type="checkbox" class="schedule-day" value="thursday" checked> Ø§Ù„Ø®Ù…ÙŠØ³
                                    </label>
                                    <label
                                        style="display: flex; align-items: center; gap: 8px; cursor: pointer; padding: 8px 15px; background: white; border-radius: 20px;">
                                        <input type="checkbox" class="schedule-day" value="friday"> Ø§Ù„Ø¬Ù…Ø¹Ø©
                                    </label>
                                    <label
                                        style="display: flex; align-items: center; gap: 8px; cursor: pointer; padding: 8px 15px; background: white; border-radius: 20px;">
                                        <input type="checkbox" class="schedule-day" value="saturday"> Ø§Ù„Ø³Ø¨Øª
                                    </label>
                                </div>
                            </div>

                            <!-- Monthly Settings (hidden by default) -->
                            <div id="schedule-monthly-section"
                                style="display: none; background: linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 100%); padding: 20px; border-radius: 10px; border: 2px solid #66bb6a;">
                                <label style="font-weight: bold; margin-bottom: 15px; display: block; color: #2e7d32;">
                                    ğŸ“… ÙŠÙˆÙ… Ø§Ù„Ø´Ù‡Ø±:
                                </label>
                                <div style="display: flex; align-items: center; gap: 15px;">
                                    <select id="schedule-day-of-month" class="form-control"
                                        style="width: 120px; font-size: 1rem;">
                                        <option value="1">1</option>
                                        <option value="2">2</option>
                                        <option value="3">3</option>
                                        <option value="4">4</option>
                                        <option value="5">5</option>
                                        <option value="6">6</option>
                                        <option value="7">7</option>
                                        <option value="8">8</option>
                                        <option value="9">9</option>
                                        <option value="10">10</option>
                                        <option value="11">11</option>
                                        <option value="12">12</option>
                                        <option value="13">13</option>
                                        <option value="14">14</option>
                                        <option value="15" selected>15</option>
                                        <option value="16">16</option>
                                        <option value="17">17</option>
                                        <option value="18">18</option>
                                        <option value="19">19</option>
                                        <option value="20">20</option>
                                        <option value="21">21</option>
                                        <option value="22">22</option>
                                        <option value="23">23</option>
                                        <option value="24">24</option>
                                        <option value="25">25</option>
                                        <option value="26">26</option>
                                        <option value="27">27</option>
                                        <option value="28">28</option>
                                        <option value="29">29</option>
                                        <option value="30">30</option>
                                        <option value="31">31</option>
                                    </select>
                                    <span style="color: #2e7d32;">Ù…Ù† ÙƒÙ„ Ø´Ù‡Ø±</span>
                                </div>
                                <small style="color: #388e3c; margin-top: 10px; display: block;">
                                    ğŸ’¡ Ø¥Ø°Ø§ Ø§Ø®ØªØ±Øª ÙŠÙˆÙ… 31 ÙˆÙƒØ§Ù† Ø§Ù„Ø´Ù‡Ø± Ø£Ù‚Ù„ Ù…Ù† Ø°Ù„ÙƒØŒ Ø³ÙŠØªÙ… Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ ÙÙŠ Ø¢Ø®Ø± ÙŠÙˆÙ… Ù…Ù† Ø§Ù„Ø´Ù‡Ø±
                                </small>
                            </div>

                            <!-- Yearly Settings (hidden by default) -->
                            <div id="schedule-yearly-section"
                                style="display: none; background: linear-gradient(135deg, #fff8e1 0%, #ffecb3 100%); padding: 20px; border-radius: 10px; border: 2px solid #ffc107;">
                                <label style="font-weight: bold; margin-bottom: 15px; display: block; color: #f57c00;">
                                    ğŸ‚ Ø§Ù„ØªØ§Ø±ÙŠØ® Ø§Ù„Ø³Ù†ÙˆÙŠ:
                                </label>
                                <div style="display: flex; align-items: center; gap: 15px; flex-wrap: wrap;">
                                    <div>
                                        <label style="font-size: 0.9rem; color: #f57c00;">Ø§Ù„ÙŠÙˆÙ…:</label>
                                        <select id="schedule-yearly-day" class="form-control"
                                            style="width: 80px; font-size: 1rem;">
                                            <option value="1">1</option>
                                            <option value="2">2</option>
                                            <option value="3">3</option>
                                            <option value="4">4</option>
                                            <option value="5">5</option>
                                            <option value="6">6</option>
                                            <option value="7">7</option>
                                            <option value="8">8</option>
                                            <option value="9">9</option>
                                            <option value="10">10</option>
                                            <option value="11">11</option>
                                            <option value="12">12</option>
                                            <option value="13">13</option>
                                            <option value="14">14</option>
                                            <option value="15" selected>15</option>
                                            <option value="16">16</option>
                                            <option value="17">17</option>
                                            <option value="18">18</option>
                                            <option value="19">19</option>
                                            <option value="20">20</option>
                                            <option value="21">21</option>
                                            <option value="22">22</option>
                                            <option value="23">23</option>
                                            <option value="24">24</option>
                                            <option value="25">25</option>
                                            <option value="26">26</option>
                                            <option value="27">27</option>
                                            <option value="28">28</option>
                                            <option value="29">29</option>
                                            <option value="30">30</option>
                                            <option value="31">31</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label style="font-size: 0.9rem; color: #f57c00;">Ø§Ù„Ø´Ù‡Ø±:</label>
                                        <select id="schedule-yearly-month" class="form-control"
                                            style="width: 130px; font-size: 1rem;">
                                            <option value="1">ÙŠÙ†Ø§ÙŠØ±</option>
                                            <option value="2">ÙØ¨Ø±Ø§ÙŠØ±</option>
                                            <option value="3">Ù…Ø§Ø±Ø³</option>
                                            <option value="4">Ø£Ø¨Ø±ÙŠÙ„</option>
                                            <option value="5">Ù…Ø§ÙŠÙˆ</option>
                                            <option value="6">ÙŠÙˆÙ†ÙŠÙˆ</option>
                                            <option value="7">ÙŠÙˆÙ„ÙŠÙˆ</option>
                                            <option value="8">Ø£ØºØ³Ø·Ø³</option>
                                            <option value="9">Ø³Ø¨ØªÙ…Ø¨Ø±</option>
                                            <option value="10">Ø£ÙƒØªÙˆØ¨Ø±</option>
                                            <option value="11">Ù†ÙˆÙÙ…Ø¨Ø±</option>
                                            <option value="12" selected>Ø¯ÙŠØ³Ù…Ø¨Ø±</option>
                                        </select>
                                    </div>
                                </div>
                                <small style="color: #f57c00; margin-top: 10px; display: block;">
                                    ğŸ’¡ Ø³ÙŠØªÙ… Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ ÙÙŠ Ù†ÙØ³ Ø§Ù„ØªØ§Ø±ÙŠØ® ÙƒÙ„ Ø³Ù†Ø©
                                </small>
                            </div>

                            <!-- Time Range -->
                            <div style="background: #fff3e0; padding: 20px; border-radius: 10px;">
                                <label style="font-weight: bold; margin-bottom: 15px; display: block; color: #e65100;">
                                    â° ÙˆÙ‚Øª Ø§Ù„Ø¥Ø±Ø³Ø§Ù„:
                                </label>
                                <div style="display: flex; gap: 20px; flex-wrap: wrap; align-items: center;">
                                    <div>
                                        <label>Ù…Ù†:</label>
                                        <input type="time" id="schedule-start-time" class="form-control" value="09:00"
                                            style="width: 120px;">
                                    </div>
                                    <div>
                                        <label>Ø¥Ù„Ù‰:</label>
                                        <input type="time" id="schedule-end-time" class="form-control" value="17:00"
                                            style="width: 120px;">
                                    </div>
                                </div>
                                <small style="color: #bf360c; margin-top: 10px; display: block;">
                                    ğŸ’¡ Ø³ÙŠØªÙ… Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ ÙÙŠ ÙˆÙ‚Øª Ø¹Ø´ÙˆØ§Ø¦ÙŠ Ø¶Ù…Ù† Ù‡Ø°Ù‡ Ø§Ù„ÙØªØ±Ø© (ØªÙˆÙ‚ÙŠØª Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©)
                                </small>
                            </div>

                            <!-- Delay Settings -->
                            <div style="background: #fce4ec; padding: 20px; border-radius: 10px;">
                                <label style="font-weight: bold; margin-bottom: 10px; display: block; color: #c2185b;">
                                    â±ï¸ Ø§Ù„ØªØ£Ø®ÙŠØ± Ø¨ÙŠÙ† Ø§Ù„Ø±Ø³Ø§Ø¦Ù„:
                                </label>
                                <div style="display: flex; align-items: center; gap: 10px;">
                                    <input type="number" id="schedule-delay" class="form-control" value="60" min="20"
                                        max="300" style="width: 100px;">
                                    <span>Ø«Ø§Ù†ÙŠØ©</span>
                                </div>
                                <small style="color: #880e4f; margin-top: 8px; display: block;">
                                    âš ï¸ Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ø¯Ù†Ù‰ 20 Ø«Ø§Ù†ÙŠØ© Ù„ØªØ¬Ù†Ø¨ Ø§Ù„Ø­Ø¸Ø± Ù…Ù† WhatsApp
                                </small>
                            </div>

                            <!-- Recipients Selection -->
                            <div
                                style="background: linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 100%); padding: 20px; border-radius: 10px; border: 2px solid #66bb6a;">
                                <label style="font-weight: bold; margin-bottom: 15px; display: block; color: #2e7d32;">
                                    ğŸ‘¥ Ø§Ù„Ù…Ø³ØªÙ„Ù…ÙŠÙ†:
                                </label>

                                <!-- Collections & Groups Selection -->
                                <div style="margin-bottom: 15px;">
                                    <div
                                        style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                                        <label style="font-weight: 600;">ğŸ“‚ Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø§Øª ÙˆØ§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø§Øª Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø©:</label>
                                        <button type="button" id="schedule-refresh-groups-btn"
                                            class="btn btn-primary btn-sm" style="font-size: 0.8rem;">
                                            <i class="fas fa-sync-alt"></i> ØªØ­Ø¯ÙŠØ«
                                        </button>
                                    </div>
                                    <div
                                        style="margin-bottom: 8px; padding: 8px; background: #e3f2fd; border-radius: 4px; border-left: 4px solid #2196F3;">
                                        <small style="color: #1565c0;">
                                            <i class="fas fa-info-circle"></i> Ø§Ø®ØªØ± Ù…Ø¬Ù…ÙˆØ¹Ø© Ù…Ø­ÙÙˆØ¸Ø© Ù„ØªØ­Ø¯ÙŠØ¯ ÙƒÙ„ Ù…Ø¬Ù…ÙˆØ¹Ø§ØªÙ‡Ø§
                                            Ù…Ø±Ø© ÙˆØ§Ø­Ø¯Ø©
                                        </small>
                                    </div>
                                    <div id="schedule-groups-list"
                                        style="max-height: 250px; overflow-y: auto; background: white; padding: 10px; border-radius: 8px; border: 1px solid #ddd;">
                                        <p style="color: #999; text-align: center;">Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø§Øª...</p>
                                    </div>
                                </div>

                                <!-- Custom Phone Numbers Section -->
                                <div
                                    style="margin-bottom: 15px; padding: 15px; background: #f0f8ff; border-radius: 8px; border: 2px solid #4CAF50;">
                                    <label
                                        style="font-weight: bold; font-size: 1em; color: #2c3e50; margin-bottom: 10px; display: block;">
                                        <i class="fas fa-phone" style="color: #4CAF50;"></i> Ø£Ø±Ù‚Ø§Ù… Ù‡ÙˆØ§ØªÙ Ø¥Ø¶Ø§ÙÙŠØ©:
                                    </label>
                                    <div style="display:flex;gap:10px;align-items:stretch;margin-bottom:12px;">
                                        <div style="flex:1;">
                                            <input type="text" id="schedule-custom-number-name" placeholder="Ø§Ù„Ø§Ø³Ù…"
                                                class="form-control" style="height: 40px;">
                                        </div>
                                        <div style="flex:1;">
                                            <input type="text" id="schedule-custom-number-phone"
                                                placeholder="Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ (966...)" class="form-control"
                                                style="height: 40px;">
                                        </div>
                                        <button type="button" id="schedule-add-custom-number-btn"
                                            class="btn btn-success" style="height: 40px; min-width: 80px;">
                                            <i class="fas fa-plus"></i> Ø¥Ø¶Ø§ÙØ©
                                        </button>
                                    </div>
                                    <div id="schedule-custom-numbers-list"
                                        style="padding: 10px; background: white; border-radius: 6px; min-height: 50px; border: 1px solid #ddd;">
                                        <p style="color: #999; text-align: center; margin: 0; font-size: 0.9rem;">
                                            <i class="fas fa-phone-slash"></i> Ù„Ù… ØªØªÙ… Ø¥Ø¶Ø§ÙØ© Ø£Ø±Ù‚Ø§Ù… Ø¨Ø¹Ø¯
                                        </p>
                                    </div>
                                </div>

                                <!-- Private Clients Section -->
                                <div
                                    style="margin-bottom: 15px; padding: 15px; background: linear-gradient(135deg, #fff3e0 0%, #ffe0b2 100%); border-radius: 8px; border: 2px solid #ff9800;">
                                    <div style="display: flex; justify-content: space-between; align-items: center; cursor: pointer;"
                                        onclick="toggleSchedulePrivateClientsSection()">
                                        <label
                                            style="font-weight: bold; font-size: 1em; color: #e65100; margin-bottom: 0; cursor: pointer;">
                                            <i class="fas fa-user-friends" style="color: #ff9800;"></i> ğŸ“± Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡
                                            Ø§Ù„Ø®Ø§ØµÙŠÙ†
                                            <span id="schedule-private-clients-count"
                                                style="background: #ff9800; color: white; padding: 2px 8px; border-radius: 12px; font-size: 12px; margin-left: 8px;">0</span>
                                        </label>
                                        <i class="fas fa-chevron-down" id="schedule-private-clients-toggle-icon"
                                            style="color: #ff9800; transition: transform 0.3s;"></i>
                                    </div>
                                    <div id="schedule-private-clients-container"
                                        style="display: none; margin-top: 12px;">
                                        <!-- Role Filter -->
                                        <div style="margin-bottom: 10px;">
                                            <label
                                                style="font-size: 0.9rem; color: #e65100; margin-bottom: 5px; display: block;">
                                                <i class="fas fa-filter"></i> ØªØµÙÙŠØ© Ø­Ø³Ø¨ Ø§Ù„Ø¯ÙˆØ±:
                                            </label>
                                            <div style="display: flex; flex-wrap: wrap; gap: 8px;">
                                                <label
                                                    style="display: flex; align-items: center; gap: 5px; background: white; padding: 6px 12px; border-radius: 4px; cursor: pointer;">
                                                    <input type="checkbox" class="schedule-client-role" value="all"
                                                        checked> Ø§Ù„ÙƒÙ„
                                                </label>
                                                <label
                                                    style="display: flex; align-items: center; gap: 5px; background: white; padding: 6px 12px; border-radius: 4px; cursor: pointer;">
                                                    <input type="checkbox" class="schedule-client-role" value="ÙˆØ³ÙŠØ·">
                                                    ÙˆØ³ÙŠØ·
                                                </label>
                                                <label
                                                    style="display: flex; align-items: center; gap: 5px; background: white; padding: 6px 12px; border-radius: 4px; cursor: pointer;">
                                                    <input type="checkbox" class="schedule-client-role" value="Ø¹Ù…ÙŠÙ„">
                                                    Ø¹Ù…ÙŠÙ„
                                                </label>
                                                <label
                                                    style="display: flex; align-items: center; gap: 5px; background: white; padding: 6px 12px; border-radius: 4px; cursor: pointer;">
                                                    <input type="checkbox" class="schedule-client-role" value="Ù…Ø§Ù„Ùƒ">
                                                    Ù…Ø§Ù„Ùƒ
                                                </label>
                                            </div>
                                        </div>
                                        <div id="schedule-private-clients-list"
                                            style="max-height: 200px; overflow-y: auto; background: white; border-radius: 6px; padding: 10px; border: 1px solid #ddd;">
                                            <p style="text-align: center; color: #666; padding: 10px;">â³ Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„
                                                Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡...</p>
                                        </div>
                                    </div>
                                </div>

                                <!-- Interest Groups Section -->
                                <div
                                    style="padding: 15px; background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%); border-radius: 8px; border: 2px solid #42a5f5;">
                                    <div style="display: flex; justify-content: space-between; align-items: center; cursor: pointer;"
                                        onclick="toggleScheduleInterestGroupsSection()">
                                        <label
                                            style="font-weight: bold; font-size: 1em; color: #1565c0; margin-bottom: 0; cursor: pointer;">
                                            <i class="fas fa-users-cog" style="color: #1e88e5;"></i> ğŸ‘¥ Ù…Ø¬Ù…ÙˆØ¹Ø§Øª Ø§Ù„Ù…Ù‡ØªÙ…ÙŠÙ†
                                            <span id="schedule-interest-groups-count"
                                                style="background: #1e88e5; color: white; padding: 2px 8px; border-radius: 12px; font-size: 12px; margin-left: 8px;">0</span>
                                        </label>
                                        <i class="fas fa-chevron-down" id="schedule-interest-groups-toggle-icon"
                                            style="color: #1e88e5; transition: transform 0.3s;"></i>
                                    </div>
                                    <small style="color: #1976d2; display: block; margin-top: 6px;">
                                        <i class="fas fa-info-circle"></i> Ø§Ø®ØªÙŠØ§Ø± Ù…Ø¬Ù…ÙˆØ¹Ø© ÙŠØ¹Ù†ÙŠ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ Ù„ÙƒÙ„ Ø£Ø¹Ø¶Ø§Ø¦Ù‡Ø§
                                    </small>
                                    <div id="schedule-interest-groups-container"
                                        style="display: none; margin-top: 12px;">
                                        <div id="schedule-interest-groups"
                                            style="max-height: 200px; overflow-y: auto; background: white; border-radius: 6px; padding: 10px; border: 1px solid #90caf9;">
                                            <p style="text-align: center; color: #666; padding: 10px;">â³ Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...
                                            </p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button id="cancel-schedule-btn" class="btn btn-secondary">Ø¥Ù„ØºØ§Ø¡</button>
                        <button id="save-schedule-btn" class="btn btn-success">
                            <i class="fas fa-save"></i> Ø­ÙØ¸ Ø§Ù„Ø¬Ø¯ÙˆÙ„
                        </button>
                    </div>
                </div>
            </div>

            <!-- Settings View -->
            <div id="settings-view" class="content-view">
                <div class="page-header">
                    <h1><i class="fas fa-cog"></i> Settings</h1>
                    <p>Configure system preferences</p>
                </div>

                <!-- Footer Message Groups (Admin & Author) -->
                <div class="card" style="margin-top: 1rem;">
                    <div class="card-body">
                        <h3><i class="fas fa-layer-group"></i> WhatsApp Footer Messages</h3>
                        <p style="color: #666; font-size: 0.9rem; margin-bottom: 1rem;">
                            Create groups of footer messages that will be automatically rotated in your WhatsApp
                            messages.
                            The system ensures all groups and all messages within each group are used before repeating,
                            providing variety in your communications. Supports *bold*, emojis, and multi-line text.
                        </p>

                        <!-- Website Tabs -->
                        <div class="footer-groups-tabs"
                            style="display: flex; gap: 0; margin-bottom: 1rem; border-bottom: 2px solid #e9ecef;">
                            <button class="footer-groups-tab active" data-website="masaak" style="
                                padding: 10px 20px;
                                border: none;
                                background: none;
                                cursor: pointer;
                                font-weight: 600;
                                color: #6c757d;
                                border-bottom: 3px solid transparent;
                                margin-bottom: -2px;
                                transition: all 0.2s;">
                                <span
                                    style="background: linear-gradient(135deg, #667eea, #764ba2); color: white; padding: 2px 8px; border-radius: 4px; font-size: 0.8rem; margin-right: 8px;">ğŸ”°</span>
                                Masaak
                            </button>
                            <button class="footer-groups-tab" data-website="hasak" style="
                                padding: 10px 20px;
                                border: none;
                                background: none;
                                cursor: pointer;
                                font-weight: 600;
                                color: #6c757d;
                                border-bottom: 3px solid transparent;
                                margin-bottom: -2px;
                                transition: all 0.2s;">
                                <span
                                    style="background: linear-gradient(135deg, #28a745, #20c997); color: white; padding: 2px 8px; border-radius: 4px; font-size: 0.8rem; margin-right: 8px;">ğŸŒ´</span>
                                Hasak
                            </button>
                        </div>

                        <!-- Rotation Stats -->
                        <div id="footer-rotation-stats" style="
                            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
                            padding: 12px 16px;
                            border-radius: 8px;
                            margin-bottom: 1rem;
                            display: flex;
                            justify-content: space-between;
                            align-items: center;
                            flex-wrap: wrap;
                            gap: 10px;">
                            <div style="display: flex; gap: 20px; flex-wrap: wrap;">
                                <span><i class="fas fa-folder" style="color: #667eea;"></i> Groups: <strong
                                        id="stats-groups-count">0/0</strong></span>
                                <span><i class="fas fa-paper-plane" style="color: #28a745;"></i> Messages Sent: <strong
                                        id="stats-messages-sent">0</strong></span>
                            </div>
                            <button id="reset-rotation-btn" class="btn btn-sm btn-outline-secondary"
                                title="Reset rotation cycle">
                                <i class="fas fa-redo"></i> Reset Rotation
                            </button>
                        </div>

                        <!-- Groups List -->
                        <div id="footer-groups-list" style="margin-bottom: 1rem;">
                            <!-- Groups will be rendered here -->
                            <div class="footer-groups-empty" style="
                                text-align: center;
                                padding: 40px 20px;
                                background: #f8f9fa;
                                border-radius: 8px;
                                color: #6c757d;">
                                <i class="fas fa-inbox"
                                    style="font-size: 2rem; margin-bottom: 10px; display: block;"></i>
                                <p>No footer groups yet. Create your first group to start rotating messages.</p>
                            </div>
                        </div>

                        <!-- Add Group Button -->
                        <button id="add-footer-group-btn" class="btn btn-success">
                            <i class="fas fa-plus"></i> Create New Group
                        </button>

                        <!-- Preview Footer Button -->
                        <button id="preview-footer-btn" class="btn btn-outline-primary" style="margin-left: 8px;">
                            <i class="fas fa-eye"></i> Preview Next Footer
                        </button>

                        <!-- Create/Edit Group Form -->
                        <div id="footer-group-form"
                            style="display: none; background: #f5f5f5; padding: 1rem; border-radius: 8px; margin-top: 1rem;">
                            <h4 id="footer-group-form-title"><i class="fas fa-folder-plus"></i> Create New Group</h4>
                            <input type="hidden" id="editing-footer-group-id" value="">

                            <div class="form-group" style="margin-bottom: 1rem;">
                                <label for="footer-group-name">Group Name:</label>
                                <input type="text" id="footer-group-name" class="form-control"
                                    placeholder="e.g., Ù…Ø¬Ù…ÙˆØ¹Ø© Ø§Ù„ØªØ±Ø­ÙŠØ¨" style="direction: rtl;">
                            </div>

                            <div class="form-group" style="margin-bottom: 1rem;">
                                <label style="display: flex; align-items: center; gap: 8px;">
                                    <input type="checkbox" id="footer-group-enabled" checked>
                                    <span>Enabled (included in rotation)</span>
                                </label>
                            </div>

                            <div class="form-group" style="margin-bottom: 1rem;">
                                <label>Messages in this group:</label>
                                <div id="footer-group-messages-list" style="margin-top: 8px;">
                                    <!-- Messages will be rendered here -->
                                </div>
                                <button type="button" id="add-footer-message-btn" class="btn btn-sm btn-outline-primary"
                                    style="margin-top: 8px;">
                                    <i class="fas fa-plus"></i> Add Message
                                </button>
                            </div>

                            <div style="display: flex; gap: 0.5rem; margin-top: 1rem;">
                                <button id="save-footer-group-btn" class="btn btn-primary">
                                    <i class="fas fa-save"></i> Save Group
                                </button>
                                <button id="cancel-footer-group-btn" class="btn btn-secondary">
                                    <i class="fas fa-times"></i> Cancel
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Group Collections Management (Admin Only) -->
                <div class="card admin-only" style="display: none; margin-top: 1rem;">
                    <div class="card-body">
                        <h3><i class="fas fa-folder"></i> Group Collections</h3>
                        <p style="color: #666; font-size: 0.9rem; margin-bottom: 1rem;">
                            Create collections/folders to organize your WhatsApp groups for easier bulk messaging.
                        </p>

                        <div id="collections-list" style="margin-bottom: 1rem;">
                            <!-- Collections will be rendered here -->
                        </div>

                        <button id="add-collection-btn" class="btn btn-success">
                            <i class="fas fa-plus"></i> Create New Collection
                        </button>

                        <div id="collection-form"
                            style="display: none; background: #f5f5f5; padding: 1rem; border-radius: 8px; margin-top: 1rem;">
                            <h4 id="collection-form-title">Create New Collection</h4>
                            <div class="form-group">
                                <label for="collection-name-input">Collection Name:</label>
                                <input type="text" id="collection-name-input" class="form-control"
                                    placeholder="e.g., Real Estate Groups">
                            </div>
                            <div class="form-group">
                                <label>Select Groups:</label>
                                <div id="collection-groups-list"
                                    style="max-height: 300px; overflow-y: auto; border: 1px solid #ddd; padding: 10px; border-radius: 4px; background: white;">
                                    <!-- Groups checkboxes will be rendered here -->
                                </div>
                            </div>
                            <div style="display: flex; gap: 0.5rem; margin-top: 1rem;">
                                <button id="settings-save-collection-btn" class="btn btn-primary">
                                    <i class="fas fa-save"></i> Save Collection
                                </button>
                                <button id="cancel-collection-btn" class="btn btn-secondary">
                                    <i class="fas fa-times"></i> Cancel
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- API Keys Settings -->
                <div class="card" style="margin-top: 1rem;">
                    <div class="card-body">
                        <h3><i class="fas fa-key"></i> AI API Keys Management</h3>
                        <p style="color: #666; font-size: 0.9rem; margin-bottom: 1rem;">
                            Add multiple API keys for Gemini or GPT. If one reaches its limit, the system will
                            automatically switch to the
                            next one. Drag to reorder priority.
                        </p>
                        <button id="add-api-key-btn" class="btn btn-success" style="margin-bottom: 1rem;">
                            <i class="fas fa-plus"></i> Add New API Key
                        </button>

                        <div id="api-key-form"
                            style="display: none; background: #f5f5f5; padding: 1rem; border-radius: 8px; margin-bottom: 1rem;">
                            <h4>Add New API Key</h4>
                            <div class="form-group">
                                <label for="api-key-provider">AI Provider:</label>
                                <select id="api-key-provider" class="form-control">
                                    <option value="gemini">Google Gemini</option>
                                    <option value="gpt">OpenAI GPT (ChatGPT)</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="api-key-name">Key Name:</label>
                                <input type="text" id="api-key-name" class="form-control"
                                    placeholder="e.g., Gemini Primary or GPT Mini">
                            </div>
                            <div class="form-group">
                                <label for="api-key-value">API Key:</label>
                                <input type="text" id="api-key-value" class="form-control"
                                    placeholder="AIzaSy... or sk-...">
                            </div>
                            <div style="display: flex; gap: 0.5rem;">
                                <button id="save-api-key-btn" class="btn btn-primary">
                                    <i class="fas fa-save"></i> Save Key
                                </button>
                                <button id="cancel-api-key-btn" class="btn btn-secondary">
                                    <i class="fas fa-times"></i> Cancel
                                </button>
                            </div>
                        </div>
                        <div id="api-keys-list" style="margin-bottom: 1rem;"></div>


                    </div>
                </div>

                <!-- Recycle Bin Settings -->
                <div class="card">
                    <div class="card-body">
                        <h3><i class="fas fa-trash-restore"></i> Recycle Bin Settings</h3>
                        <div class="form-group">
                            <label for="recycle-bin-days-input">Auto-Delete After (Days):</label>
                            <p style="color: #666; font-size: 0.9rem; margin-bottom: 0.5rem;">
                                Messages in recycle bin will be automatically deleted after this many days
                            </p>
                            <div style="display: flex; gap: 1rem; align-items: center;">
                                <input type="number" id="recycle-bin-days-input" class="form-control" min="1" max="365"
                                    style="max-width: 150px;" placeholder="7">
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Excluded Groups Settings -->
                <div class="card admin-only" style="display: none; margin-top: 1rem;">
                    <div class="card-body">
                        <h3><i class="fas fa-eye-slash"></i> Excluded Groups</h3>
                        <p style="color: #666; font-size: 0.9rem; margin-bottom: 1rem;">
                            Select groups to exclude from message processing. The bot will not scan or process messages
                            from these groups.
                        </p>

                        <button id="load-excluded-groups-btn" class="btn btn-primary" style="margin-bottom: 1rem;">
                            <i class="fas fa-sync-alt"></i> Load Groups
                        </button>

                        <div id="excluded-groups-container" style="display: none;">
                            <div style="margin-bottom: 1rem;">
                                <input type="text" id="excluded-groups-search" class="form-control"
                                    placeholder="ğŸ” Search groups..." style="margin-bottom: 0.5rem;">
                                <div style="display: flex; gap: 0.5rem; margin-bottom: 0.5rem;">
                                    <button id="select-all-groups-btn" class="btn btn-sm btn-secondary">
                                        <i class="fas fa-check-square"></i> Select All
                                    </button>
                                    <button id="deselect-all-groups-btn" class="btn btn-sm btn-secondary">
                                        <i class="fas fa-square"></i> Deselect All
                                    </button>
                                </div>
                            </div>

                            <div id="excluded-groups-list"
                                style="max-height: 400px; overflow-y: auto; border: 1px solid #ddd; padding: 10px; border-radius: 4px; background: white;">
                                <!-- Groups checkboxes will be rendered here -->
                            </div>

                            <div id="excluded-groups-count" style="margin-top: 0.5rem; color: #666; font-size: 0.9rem;">
                                <!-- Count will be shown here -->
                            </div>
                        </div>
                    </div>
                </div>



                <!-- Categories Management -->
                <div class="card" style="margin-top: 1rem;">
                    <div class="card-body">
                        <h3><i class="fas fa-tags"></i> Manage Categories</h3>
                        <p style="color: #666; font-size: 0.9rem; margin-bottom: 1rem;">
                            Customize categories for organizing ads. These categories are used for filtering and
                            sorting.
                        </p>

                        <div id="categories-list" style="margin-bottom: 1rem;">
                            <!-- Categories will be rendered here -->
                        </div>

                        <button id="add-category-btn" class="btn btn-success">
                            <i class="fas fa-plus"></i> Add Category
                        </button>

                        <div id="category-form"
                            style="display: none; background: #f5f5f5; padding: 1rem; border-radius: 8px; margin-top: 1rem;">
                            <h4 id="category-form-title">Add New Category</h4>
                            <div class="form-group">
                                <label for="category-name-input">Category Name:</label>
                                <input type="text" id="category-name-input" class="form-control"
                                    placeholder="e.g., Ø¹Ù‚Ø§Ø±Ø§Øª">
                            </div>
                            <div class="form-group">
                                <label for="category-color-input">Category Color:</label>
                                <input type="color" id="category-color-input" class="form-control" value="#3498db"
                                    style="max-width: 100px; height: 50px;">
                            </div>
                            <div style="display: flex; gap: 0.5rem; margin-top: 1rem;">
                                <button id="save-category-btn" class="btn btn-primary">
                                    <i class="fas fa-save"></i> Save Category
                                </button>
                                <button id="cancel-category-btn" class="btn btn-secondary">
                                    <i class="fas fa-times"></i> Cancel
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- WordPress Settings -->
                <div class="card admin-only" style="display: none; margin-top: 1rem;">
                    <div class="card-body">
                        <h3><i class="fab fa-wordpress"></i> WordPress Integration</h3>
                        <p style="color: #666; font-size: 0.9rem; margin-bottom: 1rem;">
                            Configure WordPress credentials to automatically post ads to your website.
                        </p>

                        <!-- Auto-Approve Toggle -->
                        <div class="form-group"
                            style="background: #f8f9fa; padding: 1rem; border-radius: 8px; margin-bottom: 1rem; border: 2px solid #667eea;">
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <div>
                                    <label style="margin: 0; font-weight: bold; color: #333;">
                                        <i class="fas fa-magic"></i> Auto-Approve & Post to WordPress
                                    </label>
                                    <small style="color: #666; display: block; margin-top: 0.5rem;">
                                        When enabled, approved ads will automatically post to WordPress. When disabled,
                                        you'll need to manually post each ad.
                                    </small>
                                </div>
                                <label class="switch" style="margin: 0;">
                                    <input type="checkbox" id="auto-approve-wp-toggle">
                                    <span class="slider round"></span>
                                </label>
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="wp-url">WordPress Site URL:</label>
                            <input type="text" id="wp-url" class="form-control" placeholder="https://masaak.com"
                                value="">
                        </div>

                        <div class="form-group">
                            <label for="wp-username">WordPress Username:</label>
                            <input type="text" id="wp-username" class="form-control" placeholder="admin" value="">
                        </div>

                        <div class="form-group">
                            <label for="wp-password">WordPress Application Password:</label>
                            <input type="password" id="wp-password" class="form-control"
                                placeholder="xxxx xxxx xxxx xxxx xxxx xxxx" value="">
                            <small style="color: #666; display: block; margin-top: 0.5rem;">
                                Generate an application password in WordPress: Users â†’ Profile â†’ Application Passwords
                            </small>
                        </div>

                        <button id="test-wp-connection-btn" class="btn btn-secondary">
                            <i class="fas fa-vial"></i> Test Connection
                        </button>
                    </div>
                </div>



                <!-- Category Limits Settings -->
                <div class="card admin-only" style="display: none; margin-top: 1rem;">
                    <div class="card-body">
                        <h3><i class="fas fa-ban"></i> Category Limits (Per Day)</h3>
                        <p style="color: #666; font-size: 0.9rem; margin-bottom: 1rem;">
                            Set maximum number of ads allowed per category <strong>per day</strong>. When a category
                            reaches its daily limit, new ads
                            will be automatically blocked until the next day (resets at 00:00).
                        </p>

                        <div id="category-limits-list" style="margin-bottom: 1rem;">
                            <!-- Category limits will be loaded here -->
                        </div>

                        <button id="add-category-limit-btn" class="btn btn-secondary">
                            <i class="fas fa-plus"></i> Add Category Limit
                        </button>
                    </div>
                </div>



                <div style="display: flex; justify-content: flex-end; margin-top: 1rem;">
                    <button id="save-all-settings-btn" class="btn btn-primary admin-only" style="display: none;">
                        <i class="fas fa-save"></i> Save All Settings
                    </button>
                </div>

                <div id="settings-message" class="info-message" style="display:none;"></div>
            </div>
        </div>
    </div>

    <!-- Resend Modal -->
    <div id="resend-modal" class="modal" style="display:none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-share-square"></i> Resend Ad to Groups</h3>
                <button id="close-modal" class="btn-close">&times;</button>
            </div>
            <div class="modal-body">
                <!-- Group Collections -->
                <div class="form-group">
                    <label><i class="fas fa-folder"></i> Saved Collections:</label>
                    <div style="display:flex;gap:8px;flex-wrap:wrap;margin-bottom:12px;">
                        <select id="collection-select" class="form-group" style="flex:1;min-width:200px;">
                            <option value="">-- Select Collection --</option>
                        </select>
                        <button id="load-collection-btn" class="btn btn-small">Load</button>
                        <button id="manage-collections-btn" class="btn btn-small">Manage</button>
                    </div>
                </div>

                <!-- Available Groups -->
                <div class="form-group">
                    <label><i class="fas fa-mobile-alt"></i> Select Groups:</label>
                    <div id="groups-list" class="groups-list">
                        <div class="loading">Loading groups...</div>
                    </div>
                </div>

                <!-- Custom Phone Numbers -->
                <div class="form-group" style="border-top:1px solid #ddd;padding-top:12px;margin-top:12px;">
                    <label><i class="fas fa-phone"></i> Custom Phone Numbers:</label>
                    <div id="custom-numbers-list" class="groups-list" style="margin-bottom:12px;">
                        <!-- Custom numbers will be rendered here -->
                    </div>
                    <div style="display:flex;gap:8px;align-items:center;margin-bottom:8px;">
                        <input type="text" id="custom-number-name" placeholder="Name (e.g., Ahmed)" style="flex:1;">
                        <input type="text" id="custom-number-phone" placeholder="Phone (e.g., 966501234567)"
                            style="flex:1;">
                        <button id="add-custom-number-btn" class="btn btn-small btn-success">
                            <i class="fas fa-plus"></i> Add
                        </button>
                    </div>
                    <div style="display:flex;gap:8px;">
                        <select id="saved-numbers-select" class="form-control" style="flex:1;">
                            <option value="">-- Select Saved Number --</option>
                        </select>
                        <button id="manage-custom-numbers-btn" class="btn btn-small btn-secondary">
                            <i class="fas fa-cog"></i> Manage
                        </button>
                    </div>
                </div>

                <!-- Save Collection -->
                <div class="form-group" style="border-top:1px solid #ddd;padding-top:12px;margin-top:12px;">
                    <label><i class="fas fa-save"></i> Save Selection as Collection:</label>
                    <div style="display:flex;gap:8px;">
                        <input type="text" id="collection-name" placeholder="Enter collection name..." style="flex:1;">
                        <button id="save-collection-btn" class="btn btn-small">Save</button>
                    </div>
                </div>

                <div id="modal-message" class="info-message" style="display:none;margin-top:12px;"></div>
            </div>
            <div class="modal-footer">
                <button id="cancel-resend-btn" class="btn btn-secondary">Cancel</button>
                <button id="confirm-resend-btn" class="btn btn-primary">Resend to Selected Groups</button>
            </div>
        </div>
    </div>

    <!-- Manage Collections Modal -->
    <div id="collections-modal" class="modal" style="display:none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-folder"></i> Manage Group Collections</h3>
                <button id="close-collections-modal" class="btn-close">&times;</button>
            </div>
            <div class="modal-body">
                <div id="collections-modal-list"></div>
            </div>
            <div class="modal-footer">
                <button id="close-collections-btn" class="btn btn-secondary">Close</button>
            </div>
        </div>
    </div>

    <!-- Manage Categories Modal -->
    <div id="categories-modal" class="modal" style="display:none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-tags"></i> Manage Categories</h3>
                <button id="close-categories-modal" class="btn-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group" style="margin-bottom:20px;">
                    <label>Add New Category:</label>
                    <div style="display:flex;gap:8px;align-items:center;">
                        <input type="text" id="new-category-name" placeholder="Category name..." style="flex:1;">
                        <input type="color" id="new-category-color" value="#9b59b6"
                            style="width:50px;height:38px;border:1px solid #ddd;border-radius:5px;">
                        <button id="add-category-btn" class="btn btn-small">Add</button>
                    </div>
                </div>
                <div id="categories-list"></div>
                <div id="categories-message" class="info-message" style="display:none;margin-top:12px;"></div>
            </div>
            <div class="modal-footer">
                <button id="close-categories-btn" class="btn btn-secondary">Close</button>
            </div>
        </div>
    </div>

    <!-- Manage Custom Numbers Modal -->
    <div id="custom-numbers-modal" class="modal" style="display:none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-phone"></i> Manage Custom Phone Numbers</h3>
                <button id="close-custom-numbers-modal" class="btn-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group" style="margin-bottom:20px;">
                    <label>Add New Custom Number:</label>
                    <div style="display:flex;gap:8px;align-items:center;">
                        <input type="text" id="manage-custom-number-name" placeholder="Name (e.g., Ahmed)"
                            style="flex:1;">
                        <input type="text" id="manage-custom-number-phone" placeholder="Phone (966501234567)"
                            style="flex:1;">
                        <button id="save-custom-number-btn" class="btn btn-small btn-success">
                            <i class="fas fa-save"></i> Save
                        </button>
                    </div>
                </div>
                <div id="saved-custom-numbers-list"></div>
                <div id="custom-numbers-message" class="info-message" style="display:none;margin-top:12px;"></div>
            </div>
            <div class="modal-footer">
                <button id="close-manage-custom-numbers-btn" class="btn btn-secondary">Close</button>
            </div>
        </div>
    </div>

    <!-- Edit Ad Modal -->
    <!-- Edit Ad Modal -->
    <div id="edit-ad-modal" class="modal" style="display:none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-edit"></i> Edit Ad Text</h3>
                <button id="close-edit-ad-modal" class="btn-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="edit-ad-textarea">Ad Content:</label>
                    <textarea id="edit-ad-textarea" class="form-control" rows="12" placeholder="Enter ad text..."
                        style="white-space: pre-wrap; font-family: inherit; line-height: 1.6;"></textarea>
                    <small style="color:#666;margin-top:6px;display:block;">Edit the ad content as needed. Line breaks
                        will be preserved.</small>
                </div>
                <div id="edit-ad-message" class="info-message" style="display:none;margin-top:12px;"></div>
            </div>
            <div class="modal-footer">
                <button id="cancel-edit-ad-btn" class="btn btn-secondary">Cancel</button>
                <button id="save-edit-ad-btn" class="btn btn-primary">Save Changes</button>
            </div>
        </div>
    </div>

    <!-- Rejection Reason Modal -->
    <div id="reject-reason-modal" class="modal" style="display:none;">
        <div class="modal-content" style="max-width: 500px;">
            <div class="modal-header"
                style="background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%); color: white;">
                <h3><i class="fas fa-times-circle"></i> Reject Ad - Enter Reason</h3>
                <button id="close-reject-modal" class="btn-close" style="color: white;">&times;</button>
            </div>
            <div class="modal-body">
                <p style="margin-bottom:15px;color:#666;">Please provide a reason for rejecting this ad:</p>

                <!-- Quick Reason Buttons -->
                <div style="display: flex; flex-wrap: wrap; gap: 8px; margin-bottom: 15px;">
                    <button type="button" class="btn btn-sm btn-outline-secondary quick-reject-reason"
                        data-reason="Ù„ÙŠØ³ Ø¥Ø¹Ù„Ø§Ù† Ø¹Ù‚Ø§Ø±ÙŠ">Ù„ÙŠØ³ Ø¥Ø¹Ù„Ø§Ù† Ø¹Ù‚Ø§Ø±ÙŠ</button>
                    <button type="button" class="btn btn-sm btn-outline-secondary quick-reject-reason"
                        data-reason="Ø¥Ø¹Ù„Ø§Ù† Ù…ÙƒØ±Ø±">Ø¥Ø¹Ù„Ø§Ù† Ù…ÙƒØ±Ø±</button>
                    <button type="button" class="btn btn-sm btn-outline-secondary quick-reject-reason"
                        data-reason="Ù…Ø¹Ù„ÙˆÙ…Ø§Øª ØºÙŠØ± ÙƒØ§ÙÙŠØ©">Ù…Ø¹Ù„ÙˆÙ…Ø§Øª ØºÙŠØ± ÙƒØ§ÙÙŠØ©</button>
                    <button type="button" class="btn btn-sm btn-outline-secondary quick-reject-reason"
                        data-reason="Ø¥Ø¹Ù„Ø§Ù† Ø³Ø¨Ø§Ù…">Ø¥Ø¹Ù„Ø§Ù† Ø³Ø¨Ø§Ù…</button>
                    <button type="button" class="btn btn-sm btn-outline-secondary quick-reject-reason"
                        data-reason="Ù…Ø­ØªÙˆÙ‰ ØºÙŠØ± Ù…Ù†Ø§Ø³Ø¨">Ù…Ø­ØªÙˆÙ‰ ØºÙŠØ± Ù…Ù†Ø§Ø³Ø¨</button>
                    <button type="button" class="btn btn-sm btn-outline-secondary quick-reject-reason"
                        data-reason="Ø®Ø§Ø±Ø¬ Ù†Ø·Ø§Ù‚ Ø§Ù„Ø®Ø¯Ù…Ø©">Ø®Ø§Ø±Ø¬ Ù†Ø·Ø§Ù‚ Ø§Ù„Ø®Ø¯Ù…Ø©</button>
                </div>

                <div class="form-group">
                    <label for="reject-reason-textarea">Rejection Reason / Ø³Ø¨Ø¨ Ø§Ù„Ø±ÙØ¶:</label>
                    <textarea id="reject-reason-textarea" class="form-control" rows="4"
                        placeholder="Ø£Ø¯Ø®Ù„ Ø³Ø¨Ø¨ Ø±ÙØ¶ Ù‡Ø°Ø§ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†..." style="font-size: 1rem; direction: rtl;"></textarea>
                </div>
                <div id="reject-reason-message" class="info-message" style="display:none;margin-top:12px;"></div>
            </div>
            <div class="modal-footer">
                <button id="cancel-reject-btn" class="btn btn-secondary">Ø¥Ù„ØºØ§Ø¡ / Cancel</button>
                <button id="confirm-reject-btn" class="btn btn-danger">
                    <i class="fas fa-trash"></i> Ø±ÙØ¶ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù† / Reject
                </button>
            </div>
        </div>
    </div>

    <!-- Accept Options Modal -->
    <div id="accept-options-modal" class="modal" style="display:none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-check-circle"></i> Accept Ad - Choose Destination</h3>
                <button id="close-accept-modal" class="btn-close">&times;</button>
            </div>
            <div class="modal-body">
                <p style="margin-bottom:20px;color:#666;">Where would you like to send this ad?</p>
                <div class="accept-options">
                    <button id="accept-groups-only" class="accept-option-btn">
                        <i class="fas fa-users"></i>
                        <span>WhatsApp Groups Only</span>
                        <small>Send to selected WhatsApp groups</small>
                    </button>
                    <button id="accept-wp-only" class="accept-option-btn">
                        <i class="fab fa-wordpress"></i>
                        <span>WordPress Only</span>
                        <small>Post directly to WordPress</small>
                    </button>
                    <button id="accept-both" class="accept-option-btn">
                        <i class="fas fa-share-alt"></i>
                        <span>Both Platforms</span>
                        <small>Send to groups and post to WordPress</small>
                    </button>
                </div>
                <div id="accept-options-message" class="info-message" style="display:none;margin-top:12px;"></div>
            </div>
            <div class="modal-footer">
                <button id="cancel-accept-btn" class="btn btn-secondary">Cancel</button>
            </div>
        </div>
    </div>

    <script>
        // WordPress Category Subcategory Mapping (matches backend)
        const wpSubcategoryMap = {
            "Ø£Ø±Ø¶": ["Ø³ÙƒÙ†ÙŠØ©", "ØªØ¬Ø§Ø±ÙŠØ©", "Ø²Ø±Ø§Ø¹ÙŠØ©"],
            "Ø¨ÙŠØª": ["Ø¯ÙˆØ±", "Ø¯ÙˆØ± ÙˆØ´Ù‚Ù‚", "Ø¯ÙˆØ± ÙˆÙ…Ù„Ø­Ù‚", "Ø¯ÙˆØ±ÙŠÙ†", "Ø¹Ø±Ø¨ÙŠ"],
            "Ø¯Ø¨Ù„ÙƒØ³": ["Ø¨Ø·Ù†", "Ø²Ø§ÙˆÙŠØ©"],
            "Ø´Ù‚Ø© Ø¯Ø¨Ù„ÙƒØ³ÙŠØ©": ["Ø¯ÙˆØ± Ø£Ø±Ø¶ÙŠ", "Ø¯ÙˆØ± Ø£ÙˆÙ„", "Ø¯ÙˆØ± Ø«Ø§Ù†ÙŠ", "Ø¯ÙˆØ± Ø«Ø§Ù„Ø«"],
            "Ø´Ù‚Ø©": ["Ø¯ÙˆØ± Ø£Ø±Ø¶ÙŠ", "Ø¯ÙˆØ± Ø£ÙˆÙ„", "Ø¯ÙˆØ± Ø«Ø§Ù†ÙŠ", "Ø¯ÙˆØ± Ø«Ø§Ù„Ø«"],
            "Ø¹Ù…Ø§Ø±Ø©": ["Ø³ÙƒÙ†ÙŠØ©", "ØªØ¬Ø§Ø±ÙŠØ©", "Ø³ÙƒÙ†ÙŠØ© ØªØ¬Ø§Ø±ÙŠØ©"],
            "ÙÙŠÙ„Ø§": ["Ø¯ÙˆØ±", "Ø¯ÙˆØ± ÙˆØ´Ù‚Ù‚", "Ø¯ÙˆØ±ÙŠÙ†"],
            "Ù…Ø­Ø·Ø© Ø¨Ù†Ø²ÙŠÙ†": ["Ø¨Ø¯ÙˆÙ† Ù…Ø­Ù„Ø§Øª", "Ù…Ø¹ Ù…Ø­Ù„Ø§Øª"],
            "Ù…Ø­Ù„ ØªØ¬Ø§Ø±ÙŠ": [
                "Ø­Ù„Ø§Ù‚", "Ù…ØºØ³Ù„Ø© Ø³ÙŠØ§Ø±Ø§Øª", "Ù…ØºØ³Ù„Ø© Ù…Ù„Ø§Ø¨Ø³", "Ø¨Ù‚Ø§Ù„Ø©", "Ø³ÙˆØ¨Ø± Ù…Ø§Ø±ÙƒØª",
                "Ù…Ø­Ù„ Ø³Ø¨Ø§ÙƒØ©", "Ù…Ø­Ù„ Ø²ÙŠÙ†Ø©", "Ù…Ø·Ø¹Ù…", "Ø¨ÙˆÙÙŠØ©", "ÙƒÙˆÙÙŠ", "Ù…Ø´ØºÙ„ Ù†Ø³Ø§Ø¦ÙŠ",
                "Ø­Ù„ÙˆÙŠØ§Øª", "Ù…Ø­Ù„ ÙƒÙ‡Ø±Ø¨Ø§Ø¡", "Ø£Ø¯ÙˆØ§Øª ØµØ­ÙŠØ©", "ØµÙŠØ¯Ù„ÙŠØ©", "Ù…Ø­Ù„ Ù…Ù„Ø§Ø¨Ø³",
                "Ù‚Ø·Ø¹ Ø³ÙŠØ§Ø±Ø§Øª", "Ù…Ø­Ù„ Ø£Ø«Ø§Ø«", "Ù…Ø­Ù„ ÙƒÙ…Ø§Ù„ÙŠØ§Øª", "Ù…Ø­Ù„ Ø¹ØµØ§ÙŠØ±", "Ù…Ø­Ù„ ÙÙˆØ§ÙƒÙ‡",
                "Ø¬ÙˆØ§Ù„Ø§Øª", "ÙÙˆØ¯ ØªØ±Ùƒ", "Ù…Ø­Ù„ ØªØ¬Ø§Ø±ÙŠ"
            ],
            "Ù…Ø²Ø±Ø¹Ø©": ["ØµÙƒ", "Ø¹Ø±Ù‚", "Ù…Ø´Ø§Ø¹", "ÙˆÙ‚Ù"],
            "Ø§Ø³ØªØ±Ø§Ø­Ø©": ["ØµÙƒ", "Ø¹Ø±Ù‚", "Ù…Ø´Ø§Ø¹", "ÙˆÙ‚Ù"],
            "Ø´Ø§Ù„ÙŠØ©": ["ØµÙƒ", "Ø¹Ø±Ù‚", "Ù…Ø´Ø§Ø¹", "ÙˆÙ‚Ù"],
            "Ù…Ø³ØªÙˆØ¯Ø¹": ["ÙƒØ¨ÙŠØ±", "ØµØºÙŠØ±"],
            " Ù„Ù„Ø¥ÙŠØ¬Ø§Ø±": ["Ø´Ù‚Ø©", "Ø¯Ø¨Ù„ÙƒØ³", "ÙÙŠÙ„Ø§", "Ø¨ÙŠØª", "Ø´Ù‚Ø© Ø¯Ø¨Ù„ÙƒØ³ÙŠØ©", "Ø¹Ù…Ø§Ø±Ø©", "Ø§Ø³ØªØ±Ø§Ø­Ø©", "Ø´Ø§Ù„ÙŠØ©", "Ù…Ø­Ù„ ØªØ¬Ø§Ø±ÙŠ", "Ù…Ø²Ø±Ø¹Ø©", "Ù…Ø³ØªÙˆØ¯Ø¹"]
        };

        // Hasak Categories Mapping (category name -> WordPress ID)
        const HASAK_CATEGORIES_MAP = {
            "Ø£Ø³Ø± Ù…Ù†ØªØ¬Ø©": 10,
            "Ø¥Ø¹Ù„Ø§Ù† ØªØ¬Ø§Ø±ÙŠ Ø±Ø¨Ø­ÙŠ Ù…Ù…ÙŠØ²": 24,
            "Ø§Ù„ÙØ¹Ø§Ù„ÙŠØ§Øª ÙˆØ§Ù„Ø§Ù†Ø´Ø·Ø©": 19,
            "Ø¨Ø±Ø§Ù…Ø¬ ÙˆÙˆØ¸Ø§Ø¦Ù": 30,
            "ØªÙˆØµÙŠÙ„ Ø³ÙŠØ§Ø±Ø§Øª": 25,
            "Ø­Ø±Ø§Ø¬ Ø§Ù„Ø­Ø³Ø§": 18,
            "ÙØ¹Ø§Ù„ÙŠØ© Ù…Ø¬Ø§Ù†ÙŠØ© Ù…Ù…ÙŠØ²Ø©": 17,
            "ÙƒÙˆÙÙŠÙ‡Ø§Øª Ø£Ùˆ Ù…Ø·Ø§Ø¹Ù…": 21,
            "Ù…Ø­Ù„Ø§Øª ØªØ¬Ø§Ø±ÙŠØ©": 23,
            "Ù…Ø±ÙƒØ² ØªØ±ÙÙŠÙ‡ÙŠ": 20,
            "Ù…Ù†ØªØ¬Ø¹Ø§Øª ÙˆØ¥Ø³ØªØ±Ø§Ø­Ø§Øª": 22
        };

        // Toggle category container visibility based on target website
        function toggleCategoryContainersByWebsite(targetWebsite) {
            const hasakContainer = document.getElementById('hasak-category-container');
            const masaakContainer = document.getElementById('masaak-category-container');
            const categorySelectorsContainer = document.getElementById('category-selectors-container');

            if (targetWebsite === 'hasak') {
                // Show Hasak dropdown, hide Masaak inputs
                if (hasakContainer) hasakContainer.style.display = 'block';
                if (masaakContainer) masaakContainer.style.display = 'none';
                // Also hide the parent_catt/sub_catt dropdowns for Hasak
                if (categorySelectorsContainer) categorySelectorsContainer.style.display = 'none';
                console.log('ğŸ”„ Switched to Hasak category mode');
            } else {
                // Show Masaak inputs, hide Hasak dropdown
                if (hasakContainer) hasakContainer.style.display = 'none';
                if (masaakContainer) masaakContainer.style.display = 'grid';
                // Show parent_catt/sub_catt dropdowns for Masaak
                if (categorySelectorsContainer) categorySelectorsContainer.style.display = 'grid';
                console.log('ğŸ”„ Switched to Masaak category mode');
            }
        }

        // Update arc_category and arc_subcategory when Hasak dropdown changes
        function updateHasakArcFields() {
            const hasakCategorySelect = document.getElementById('wp-preview-hasak-category');
            const hasakSubcategoryInput = document.getElementById('wp-preview-hasak-subcategory');
            const arcCategoryInput = document.getElementById('wp-preview-arc-category');
            const arcSubcategoryInput = document.getElementById('wp-preview-arc-subcategory');

            if (hasakCategorySelect) {
                const selectedValue = hasakCategorySelect.value;
                const selectedOption = hasakCategorySelect.options[hasakCategorySelect.selectedIndex];
                const categoryId = selectedOption ? selectedOption.dataset.id : null;

                // Update hidden arc_category field
                if (arcCategoryInput) {
                    arcCategoryInput.value = selectedValue;
                }

                // Log for debugging
                console.log('ğŸ·ï¸ Hasak category selected:', selectedValue, '(ID:', categoryId, ')');
            }

            // Also sync subcategory
            if (hasakSubcategoryInput && arcSubcategoryInput) {
                arcSubcategoryInput.value = hasakSubcategoryInput.value;
            }
        }

        // Initialize Hasak category dropdown from existing arc_category value
        function initializeHasakCategoryFromArc() {
            const hasakCategorySelect = document.getElementById('wp-preview-hasak-category');
            const hasakSubcategoryInput = document.getElementById('wp-preview-hasak-subcategory');
            const arcCategoryInput = document.getElementById('wp-preview-arc-category');
            const arcSubcategoryInput = document.getElementById('wp-preview-arc-subcategory');

            if (hasakCategorySelect && arcCategoryInput) {
                const arcValue = arcCategoryInput.value;
                // Try to find matching option
                const options = hasakCategorySelect.options;
                for (let i = 0; i < options.length; i++) {
                    if (options[i].value === arcValue) {
                        hasakCategorySelect.selectedIndex = i;
                        break;
                    }
                }
            }

            // Also sync subcategory
            if (hasakSubcategoryInput && arcSubcategoryInput) {
                hasakSubcategoryInput.value = arcSubcategoryInput.value || '';
            }
        }

        // Function to update subcategories based on parent selection
        function updateWpSubcategories() {
            const parentSelect = document.getElementById('wp-preview-parent-catt');
            const subSelect = document.getElementById('wp-preview-sub-catt');
            const arcCategoryInput = document.getElementById('wp-preview-arc-category');
            const arcSubcategoryInput = document.getElementById('wp-preview-arc-subcategory');

            const parentValue = parentSelect.value;

            // Update arc_category to match parent_catt
            if (arcCategoryInput) {
                arcCategoryInput.value = parentValue;
            }

            // Clear subcategory
            subSelect.innerHTML = '<option value="">Ø§Ø®ØªØ± Ø§Ù„Ù†ÙˆØ¹ Ø§Ù„ÙØ±Ø¹ÙŠ</option>';
            if (arcSubcategoryInput) {
                arcSubcategoryInput.value = '';
            }

            // Populate subcategories if parent is selected
            if (parentValue && wpSubcategoryMap[parentValue]) {
                wpSubcategoryMap[parentValue].forEach(function (sub) {
                    const option = document.createElement('option');
                    option.value = sub;
                    option.textContent = sub;
                    subSelect.appendChild(option);
                });
                subSelect.disabled = false;
            } else {
                subSelect.disabled = true;
            }
        }

        // Commercial Ad Category Constants
        // Hasak: Ø¥Ø¹Ù„Ø§Ù† ØªØ¬Ø§Ø±ÙŠ Ø±Ø¨Ø­ÙŠ Ù…Ù…ÙŠØ² = ID 24
        // Masaak: Ø§Ø¹Ù„Ø§Ù†Ø§Øª Ù…Ø³Ø¹Ø§Ùƒ Ø§Ù„Ù…Ù…ÙŠØ²Ø© = ID 89
        const COMMERCIAL_CATEGORIES = {
            hasak: { name: 'Ø¥Ø¹Ù„Ø§Ù† ØªØ¬Ø§Ø±ÙŠ Ø±Ø¨Ø­ÙŠ Ù…Ù…ÙŠØ²', id: 24 },
            masaak: { name: 'Ø§Ø¹Ù„Ø§Ù†Ø§Øª Ù…Ø³Ø¹Ø§Ùƒ Ø§Ù„Ù…Ù…ÙŠØ²Ø©', id: 89 }
        };

        // Store original category values when commercial mode is enabled
        let originalCategoryValues = null;

        // Toggle commercial ad category
        function toggleCommercialAdCategory() {
            const isCommercial = document.getElementById('wp-preview-is-commercial')?.checked;
            const parentSelect = document.getElementById('wp-preview-parent-catt');
            const subSelect = document.getElementById('wp-preview-sub-catt');
            const arcCategoryInput = document.getElementById('wp-preview-arc-category');
            const arcSubcategoryInput = document.getElementById('wp-preview-arc-subcategory');
            const categoryContainer = document.getElementById('category-selectors-container');
            const targetWebsite = document.getElementById('wp-preview-target-website')?.value || 'masaak';

            if (isCommercial) {
                // Store original values
                originalCategoryValues = {
                    parentCatt: parentSelect?.value || '',
                    subCatt: subSelect?.value || '',
                    arcCategory: arcCategoryInput?.value || '',
                    arcSubcategory: arcSubcategoryInput?.value || ''
                };

                // Get commercial category for target website
                const commercialCat = COMMERCIAL_CATEGORIES[targetWebsite] || COMMERCIAL_CATEGORIES.masaak;

                // Override all category fields with commercial category
                if (parentSelect) {
                    parentSelect.value = commercialCat.name;
                    parentSelect.disabled = true;
                }
                if (subSelect) {
                    subSelect.innerHTML = '<option value="">Ù„Ø§ ÙŠÙˆØ¬Ø¯</option>';
                    subSelect.value = '';
                    subSelect.disabled = true;
                }
                if (arcCategoryInput) {
                    arcCategoryInput.value = commercialCat.name;
                    arcCategoryInput.readOnly = true;
                }
                if (arcSubcategoryInput) {
                    arcSubcategoryInput.value = '';
                    arcSubcategoryInput.readOnly = true;
                }

                // Visual feedback - dim the category selectors
                if (categoryContainer) {
                    categoryContainer.style.opacity = '0.6';
                    categoryContainer.style.pointerEvents = 'none';
                }

                console.log(`âœ… Commercial ad mode enabled: ${commercialCat.name} (ID: ${commercialCat.id})`);
            } else {
                // Restore original values
                if (originalCategoryValues) {
                    if (parentSelect) {
                        parentSelect.value = originalCategoryValues.parentCatt;
                        parentSelect.disabled = false;
                    }
                    if (arcCategoryInput) {
                        arcCategoryInput.value = originalCategoryValues.arcCategory;
                        arcCategoryInput.readOnly = false;
                    }
                    if (arcSubcategoryInput) {
                        arcSubcategoryInput.value = originalCategoryValues.arcSubcategory;
                        arcSubcategoryInput.readOnly = false;
                    }
                    // Restore subcategories
                    updateWpSubcategories();
                    if (subSelect) {
                        subSelect.value = originalCategoryValues.subCatt;
                        subSelect.disabled = false;
                    }
                } else {
                    // Just re-enable if no original values
                    if (parentSelect) parentSelect.disabled = false;
                    if (subSelect) subSelect.disabled = false;
                    if (arcCategoryInput) arcCategoryInput.readOnly = false;
                    if (arcSubcategoryInput) arcSubcategoryInput.readOnly = false;
                }

                // Restore visual state
                if (categoryContainer) {
                    categoryContainer.style.opacity = '1';
                    categoryContainer.style.pointerEvents = 'auto';
                }

                console.log('âœ… Commercial ad mode disabled, original categories restored');
            }
        }

        // Listen for website changes to update commercial category and toggle category containers
        document.addEventListener('DOMContentLoaded', function () {
            const websiteSelect = document.getElementById('wp-preview-target-website');
            if (websiteSelect) {
                websiteSelect.addEventListener('change', function () {
                    const targetWebsite = this.value;

                    // Toggle category containers based on website
                    toggleCategoryContainersByWebsite(targetWebsite);

                    // Initialize Hasak dropdown if switching to Hasak
                    if (targetWebsite === 'hasak') {
                        initializeHasakCategoryFromArc();
                    }

                    // Handle commercial category toggle
                    const isCommercial = document.getElementById('wp-preview-is-commercial')?.checked;
                    if (isCommercial) {
                        // Re-apply commercial category for new website
                        toggleCommercialAdCategory();
                    }
                });
            }

            // Also set up the Hasak subcategory input to sync with arc_subcategory
            const hasakSubcategoryInput = document.getElementById('wp-preview-hasak-subcategory');
            const arcSubcategoryInput = document.getElementById('wp-preview-arc-subcategory');
            if (hasakSubcategoryInput && arcSubcategoryInput) {
                hasakSubcategoryInput.addEventListener('input', function () {
                    arcSubcategoryInput.value = this.value;
                });
            }
        });

        // Sync sub_catt with arc_subcategory when changed
        document.addEventListener('DOMContentLoaded', function () {
            const subSelect = document.getElementById('wp-preview-sub-catt');
            const arcSubcategoryInput = document.getElementById('wp-preview-arc-subcategory');

            if (subSelect && arcSubcategoryInput) {
                subSelect.addEventListener('change', function () {
                    arcSubcategoryInput.value = this.value;
                });
            }
        });
    </script>

    <script src="/js/app.js"></script>
    <script src="/js/ad-details-flow.js"></script>
</body>

</html>
